BF_ShareEmail=function(){this.ERR_MESS=local.t("Please enter two email addresses.");this.current_button=null;this.from_email="";this.vertical="";this.init=function(){shareEmail.assign_handlers();shareEmail.draw_catcha()};this.assign_handlers=function(){universal_dom.assign_handler({bucket:"share-email-submit",handler:shareEmail.submit,event:"click"});universal_dom.assign_handler({bucket:"share-email-cancel",handler:shareEmail.hide_email_form,event:"click"});universal_dom.assign_handler({bucket:"newsletter_checkbox",handler:shareEmail.newsletter_checkbox,event:"click"});universal_dom.assign_handler({bucket:"email-signup",handler:shareEmail.email_signup,event:"click"});Element.observe(window,"resize",shareEmail.move_to_visible_area)};this.move_to_visible_area=function(){if($("share_email")&&$("share_email").visible()){var parent=$("share_email").up(".share-box");if(typeof(parent)=="undefined"){parent=$("share_email").up(".share_tools_list")}if(typeof(parent)!="undefined"){var email_button=parent.select(".sub-buzz-email-share");if(!email_button.length){email_button=parent.select(".mail .share-icon")}if(email_button.length){if($("share_email").up(".buzz_superlist_item_update")){$("share_email").addClassName("top-arrow");var left_offset=(email_button[0].offsetLeft+email_button[0].getWidth()/2)-($("share_email").getWidth()/2);$("share_email").setStyle({left:left_offset+"px"});$("share_email").setStyle({top:50+"px"})}else{var top_offset=(email_button[0].offsetTop+email_button[0].getHeight()/2)-($("share_email").getHeight()/2);$("share_email").setStyle({left:45+"px"});$("share_email").setStyle({top:top_offset+"px"})}}}else{var share_email_offset=$("share_email").viewportOffset();if(share_email_offset.left<=0){if(!$("share_email").getAttribute("data:originOffset")){$("share_email_form").addClassName("hide-arrow");$("share_email").setAttribute("data:originOffset",$("share_email").offsetLeft)}$("share_email").setStyle({left:($("share_email").offsetLeft-share_email_offset.left)+"px"})}else{if($("share_email").getAttribute("data:originOffset")){if(($("share_email").offsetLeft-share_email_offset.left)>=$("share_email").getAttribute("data:originOffset")){$("share_email").setStyle({left:($("share_email").offsetLeft-share_email_offset.left)+"px"})}else{$("share_email_form").removeClassName("hide-arrow");$("share_email").setStyle({left:$("share_email").getAttribute("data:originOffset")+"px"});$("share_email").removeAttribute("data:originOffset")}}}}}};this.hide_email_form=function(){shareEmail.current_button=null;$("share_email").hide();if(typeof bf_rdio!="undefined"){bf_rdio.enable()}if(typeof bpage!="undefined"){bpage.hide_all_popups()}};this.locate_form_and_share_email=function(target,buzz_id,no_scroll){$("share_email").removeAttribute("data:originOffset");$("share_email_form").removeClassName("hide-arrow");$("newsletter_signup_form").hide();$("share_email_error").hide();$("share_email_confirm").hide();$("share_email_form").show();var emailBoxPos={top:0,left:0};if(shareEmail.current_button==target){shareEmail.hide_email_form();return false}else{shareEmail.current_button=target}var is_inline_share=target.ancestors().indexOf($("inline_shares_box"))>=0;var btn={left:Number($(target).offsetLeft),top:Number($(target).offsetTop),height:Number($(target).getHeight()),width:Number($(target).getWidth())};var arrows=$$("#share_email #top_arrow .arrow");buzz_id=buzz_id.split("_");$("bid").value=buzz_id[0];$("share_email").show();if(typeof bf_rdio!="undefined"){bf_rdio.disable()}$("share_email_form").addClassName("share-email-form");$("share_email_form").reset();$("share_email").setOpacity(1);$("share_email_message").hide();$(target).insert({after:$("share_email")});arrow={height:is_inline_share?20:10,width:is_inline_share?20:10};var box={width:$("share_email").getWidth(),height:$("share_email").getHeight()};if(is_inline_share){emailBoxPos.top=btn.top-parseInt(box.height/2)+parseInt(btn.height/2);emailBoxPos.left=btn.left+btn.width+parseInt(arrow.width)}else{emailBoxPos.top=btn.top+btn.height+parseInt(arrow.height/2);emailBoxPos.left=btn.left-parseInt(box.width/2)+parseInt(btn.width/2)}$("share_email").setStyle({left:emailBoxPos.left+"px",top:emailBoxPos.top+"px"});arrows.each(function(a,i){var arrowPos={top:0,left:0};if(is_inline_share){arrowPos.left=(i-arrow.width);if(i==1){arrowPos.left+=2}arrowPos.top=parseInt(box.height/2)-parseInt(arrow.height/2)}else{arrowPos.left=parseInt(box.width/2)-arrow.width+i;arrowPos.top=i-arrow.height+1}$(a).setStyle({left:arrowPos.left+"px",top:arrowPos.top+"px"})});shareEmail.move_to_visible_area();if(!no_scroll){BF_Effect.ScrollIntoView("share_email")}};this.newsletter_checkbox=function(obj){if(obj.id){$(obj.id).toggleClassName("checkOff");$(obj.id).toggleClassName("checkOn")}};this.email_signup=function(){var categories=[];if(shareEmail.from_email==""){return false}var email=shareEmail.from_email;$$("#newsletter_signup_form .checkBox.checkOn").each(function(el){var cat=$(el).getAttribute("id").replace("_signup","");categories.push(cat)});if(!categories.length){if($("email_sent_success_message")){$("email_sent_success_message").hide()}if($("empty_sign_up_message")){$("empty_sign_up_message").removeClassName("hidden")}return}else{if($("empty_sign_up_message")){$("empty_sign_up_message").addClassName("hidden")}}new Ajax.Request("/buzzfeed/_email/",{method:"get",parameters:{email:email,category:categories},onSuccess:function(transport){if($("email_sent_success_message")){$("email_sent_success_message").removeClassName("hidden")}if(transport.responseText.match(/Email added/)){shareEmail.confirm_message("Great! You'll get your first email soon.")}else{shareEmail.fail_message("Sorry! We weren't able to sign you up.")}},onFailure:function(transport){if(BF_STATIC.bf_env=="dev"&&transport.responseText){shareEmail.fail_message(transport.responseText)}else{shareEmail.fail_message("Sorry! We weren't able to sign you up.")}}})};this.submit=function(obj){$("share_email_submit").disabled=true;if(obj.vertical){shareEmail.vertical=obj.vertical}if(shareEmail.validate()){var params={};params.bf=$F("bf").strip();params.b2=$F("b2").strip();params.note=$F("note").strip();params.bid=$F("bid");params.sub_buzz_id=$F("sub_buzz_id");if(BF_STATIC.tt_page=="Video"&&videopage.is_videopage){params.video_page=1}if($("hash_tag")){params.hash_tag=$F("hash_tag")}if(typeof pound!="undefined"){params.tracking_url=pound.urls.unescaped.hashAndQueryString(["fb_ref"])}if("buzzDetails" in window&&"postTags" in buzzDetails){params.testing=buzzDetails.postTags.split(",").indexOf("--enable-email-catcha")>-1?"on":"off"}(new BF_Request()).request("/buzzfeed/share_email",{method:"post",parameters:params,onSuccess:function(resp){shareEmail.share_submit_success(resp)},onFailure:function(resp){shareEmail.fail(resp)},onCatcha:function(resp){$("share_email_submit").disabled=false;if(bf_catcha.catcha_answer){$("share_email_message").className="message error";$("share_email_message").innerHTML="Please enter the correct Cat-cha answer.";$("share_email_message").show()}}});(new BF_Targetting_Pixel()).add("email");gtrack.trackShares(22,"numSharesEmail");var gtrack_cat_label=gtrack.findCatLabel($("share_email_submit"));gtrack.track_events((gtrack_cat_label?gtrack_cat_label:""),"share/email/send","")}};this.share_submit_success=function(resp){$("share_email_submit").disabled=false;var obj=eval("("+resp.responseText+")");obj.sent=obj.sent==true||obj.sent=="true";if(obj&&obj.sent&&obj.sent==true){if(tracker){tracker.add({type:tracker.types.SHARE_EMAIL});tracker.run()}if($("bf")){$("bf").value=""}if($("b2")){$("b2").value=""}if($("note")){$("note").value=""}if($("sub_buzz_id")){$("sub_buzz_id").value=""}if(obj.from_email){if($("newsletter_signup_form")){$("newsletter_signup_form").addClassName("share-email-form")}if($("from_address")){$("from_address").innerHTML=obj.from_email}shareEmail.from_email=obj.from_email;if($("newsletter_signup_form")){$("newsletter_signup_form").show()}if($("empty_sign_up_message")){$("empty_sign_up_message").addClassName("hidden")}if($("email_sent_success_message")){$("email_sent_success_message").show()}if($("share_email_form")){$("share_email_form").hide()}}else{BF_Effect.FadeOut("share_email",50)}shareEmail.move_to_visible_area()}else{shareEmail.fail(resp)}};this.fail=function(resp){try{var obj=eval("("+resp.responseText+")");if(obj&&obj.error&&obj.message&&(obj.error=="blacklist"||obj.error=="spam")){shareEmail.fail_message(obj.message)}}catch(e){console.log(e)}};this.fail_message=function(message){$("share_email_error_text").update(message);console.log("share email failure: "+message);$("share_email_submit").disabled=false;$("share_email_form").hide();$("newsletter_signup_form").hide();$("share_email_error").show();shareEmail.move_to_visible_area()};this.confirm_message=function(message){$("share_email_confirm_text").update(message);console.log("share email confirm: "+message);$("share_email_submit").disabled=false;$("share_email_form").hide();$("newsletter_signup_form").hide();$("share_email_error").hide();$("share_email_confirm").show();shareEmail.move_to_visible_area()};this.validate=function(){var status=true;if($F("bf").strip()==""||$F("b2").strip()==""){$("share_email_message").className="message error";$("share_email_message").innerHTML=shareEmail.ERR_MESS;$("share_email_message").show();var status=false;$("share_email_submit").disabled=false}return status};this.draw_catcha=function(){if(buzzDetails.postTags.split(",").indexOf("--enable-email-catcha")==-1){return}if(BFW_Util.getCookie("catcha-email_a_friend")){universal_dom.get_bucket_elements("catcha-email_a_friend").each(function(el){el.show();bf_catcha.set_image_and_question({service:"email_a_friend",image_element:el.getElementsByTagName("IMG")[0],question_element:el.getElementsByTagName("SPAN")[0]})})}}};shareEmail=new BF_ShareEmail();BuzzLoader.register(function(){shareEmail.init()},1);var BF_HashTrack=function(){this.TYPE_FN={turn:function(b){hashtrack.ping(b)},google:function(b){hashtrack.google(b)}};this.google_regex=new RegExp("/([^/]*)/([^/]*)(?:#|\\?.*fb_ref=)(H[^0-9]+)([0-9]+)??$","i");this.redir_regex=new RegExp("/ht/([^/]*)/([^/]*)/(H[^0-9]+)([0-9]+)??$","i");this.primary_regex=new RegExp("/([^/]*)/([^/]*)(?:#|\\?.*fb_ref=)(H[^0-9]+)1??$","i");this.hashtrack2_regex=new RegExp("/h2/([a-z0-9]+)/([^/]+)/([^/]+)","i");this.tracked_params=false;this.init=function(){this.oldschool_hashtrack=window.location.href.match(hashtrack.hashtrack2_regex)?false:true;var b=hashtrack.hash_tag(window.location.href);if(b){b=b.toUpperCase();var d=BFW_Util.getCookie("HT_PRIMARY");var c=2;if(d&&d.split(",").length>3){c=hashtrack._process_cookie(d,b)}else{if(hashtrack.redir_regex.test(document.referrer)||hashtrack.primary_regex.test(window.location.href)){c=1;hashtrack._process_without_cookie()}}if(c==0){return}if(b&&!("hash_track" in window)){var g=window.location.href.match(hashtrack.google_regex);if(g&&g.length==5){hashtrack.setup_google({user:g[1],uri:g[2],code:g[3].toUpperCase(),number:c})}}if(b&&!("hash_track" in window)){var f=window.location.href.match(hashtrack.hashtrack2_regex);if(f&&f.length==4){hashtrack.setup_google({user:f[2],uri:f[3],code:f[1].toUpperCase(),number:c})}}if(this.oldschool_hashtrack){b=b.replace(/\d$/,c)}else{b+=c}(new BF_Targetting_Pixel()).hashtrack_pixel(window.location.toString(),c)}if(b&&typeof hash_track!="undefined"&&typeof hash_track[b]!="undefined"){var e=hashtrack.TYPE_FN[hash_track[b].type||"turn"];if(typeof e!="undefined"){var h=hash_track[b].conversion;e(h.id);if(!b.toUpperCase().match(/^H/)){b="H"+b}hashtrack.track(b);hashtrack.tracked_hash_tag=b;if(this.oldschool_hashtrack){BuzzLoader.register(function(){try{hashtrack.do_rewrites(b.replace(/1$/,2))}catch(j){console.error(j)}},1)}}}else{if(this.oldschool_hashtrack){BuzzLoader.register(this.fixup_share_buttons,1)}}};this._process_without_cookie=function(){var c=hashtrack.google_regex.exec(document.location.href);var b={user:c[1],uri:c[2],code:c[3].toUpperCase()};if(b.code.match(/^H.*/)){window.IS_HASH_WIDGET_CLICK=true}};this._process_cookie=function(g,j){var b=g.split(",");var h=b.shift();var m=b.shift();var c=b.shift();var d=new RegExp(".*/"+m+"/"+c+".*");var l=b.shift();var k=b.join(",");var f=2;var e=this.oldschool_hashtrack?"2":"";if(l&&d.exec(document.location.href)&&(l+e)==j){if(h=="UNCOUNTED"){f=1}window.IS_HASH_WIDGET_CLICK=true;if(k){window.HASH_REFER=k}BFW_Util.setCookie({name:"HT_PRIMARY",value:["COUNTED",m,c,l,k].join(","),seconds:600})}return f};this.setup_google=function(d){var b=d.code+d.number;var c=["_ga","hashtrack",d.user,d.uri,d.code,d.number];hash_track={};hash_track[b]={type:"google",conversion:{id:"/"+c.join("/")}}};this.hash_tag=function(b){return hashtrack.parse_hash_tag(b)};this.parse_hash_tag=function(c){var b=undefined;if(c.indexOf("/h2/")){var d=c.match("/h2/([^/]+)");if(d&&d.length>0){b=d[1]}}if(!b&&c.indexOf("#")+1>0){var d=c.substring(c.indexOf("#")+1);if(d.length>0){b=d}}if(!b&&c.indexOf("?")>-1){var e=c.toQueryParams();if(e.fb_ref){b=e.fb_ref}}if(!!b&&b.indexOf("?")>-1){b=b.substr(0,b.indexOf("?"))}return b};this.regex=new RegExp("(/[^/]+/[^/]+$)");this.do_rewrites=function(b,f){var c=window.location.href,g=!!f?f.getElementsByTagName("fb:like"):document.getElementsByTagName("fb:like");if(g.length==0){g=!!f?f.getElementsByTagName("like"):document.getElementsByTagName("like")}for(var d=0;d<g.length;d++){g[d].setAttribute("ref",b);hashtrack._swap_node(g[d])}var e=!!f?f.getElementsByTagName("A"):document.getElementsByTagName("A");for(var d=0;d<e.length;d++){if(e[d].className.match(/twitter-share-button/)){var c=e[d].getAttribute("data-url");if(!c||c==""){c=window.location.href}e[d].setAttribute("data-url",c+"#"+b);e[d].setAttribute("data-counturl",c);hashtrack._swap_node(e[d])}}var j=!!f?f.getElementsByTagName("IFRAME"):document.body.getElementsByTagName("IFRAME");for(var d=0;d<j.length;d++){if(!!j[d].getAttribute("bf_src")){var c=hashtrack._get_hashtrack_share_url(j[d],b);hashtrack._swap_node(j[d],"src",c)}}var c=window.location.href,g=!!f?f.getElementsByTagName("g:plusone"):document.getElementsByTagName("g:plusone");if(g.length==0){g=!!f?f.getElementsByTagName("plusone"):document.getElementsByTagName("plusone")}for(var d=0;d<g.length;d++){g[d].setAttribute("href",hashtrack._add_hashtrack_to_url(g[d].getAttribute("href"),b));hashtrack._swap_node(g[d])}if($("share_email_form")){var h=new Element("input",{type:"hidden",value:b,name:"hash_tag",id:"hash_tag"});$("share_email_form").appendChild(h)}};this._swap_node=function(d,e,c){var b=d.cloneNode(true);if(c){b.setAttribute(e,c)}d.parentNode.replaceChild(b,d)};this._get_hashtrack_share_url=function(e,b){var d=e.getAttribute("bf_src");var c=d.indexOf("?")+1;var g=d.substring(c);var f=g.toQueryParams();if(typeof f.url!="undefined"){f.url=hashtrack._add_hashtrack_to_url(f.url,b);d=d.replace(g,$H(f).toQueryString())}return d};this._add_hashtrack_to_url=function(e,c){var d=new RegExp("(/[^/]+/[^/]+$)");var b=e.match(d);e=e.replace(d,"/ht"+b[0]+"/"+c);return e};this.fixup_share_buttons=function(e){var f=!!e?e.getElementsByTagName("fb:like"):document.getElementsByTagName("fb:like");for(var d=0;d<f.length;d++){var k=document.createElement("fb:like");var b=f[d].attributes;for(var c=0;c<b.length;c++){k.setAttribute(b[c].name,b[c].value)}f[d].parentNode.replaceChild(k,f[d])}var g=!!e?e.getElementsByTagName("IFRAME"):document.getElementsByTagName("IFRAME");for(var d=0;d<g.length;d++){if(!!g[d].getAttribute("bf_src")){var h=g[d].cloneNode(true);h.setAttribute("src",g[d].getAttribute("bf_src"));g[d].parentNode.replaceChild(h,g[d])}}};this.ping=function(c){var b="&";if(c.indexOf("?")==-1){b="?"}b+="rnd="+(new Date()).getTime();(new Image()).src=c+b};this.track=function(h){var c=document.createElement("img");var b=$$("head meta[property=bf:buzzid]");var g=$$("head meta[property=bf:userid]");if(b&&g){try{var f={buzzid:b.first().getAttribute("content"),userid:g.first().getAttribute("content"),hp:h,referrer:(typeof window.HASH_REFER!="undefined")?window.HASH_REFER:document.referrer,z:(new Date).getTime()};hashtrack.tracked_params=f;(new Image()).src="http://"+(Cloud.servers[Math.floor(Math.random()*Cloud.servers.length)])+"/hp.gif?"+Object.toQueryString(f);if(Cloud.staging.sample>0&&(Math.random()<=Cloud.staging.sample)){(new Image()).src="http://"+Cloud.staging.server+"/hp.gif?"+Object.toQueryString(f)}}catch(d){console.error(d)}}};this.google=function(d,b){return}};var hashtrack=new BF_HashTrack();bf_vote_manager=function(){this.ERR="Sorry, we're unable to process your request at this time. Please try again later.";this.VOTE_UPDATED="Your vote has been counted.";this.ALREADY_VOTED="You've Already Voted!";this.init=function(){var b=$$("a.vote-button");b.each(function(c){var d=c.getAttribute("contributionid");if(d){c.observe("click",function(f){f.stop();vote_manager.handle_click(f);return false})}})};this.handle_click=function(d){var c=d.element();var b=new BF_User();if(b.isLoggedIn()){this.vote(c)}else{this.login(c)}};this.login=function(d){this.vote_btn_id=d.getAttribute("contributionid")+"_vote";bf_login.args={action:"vote"};if(!$(this.vote_btn_id)){var b=$("registration-div").remove();var e=new Element("div",{"class":"signin-or-signup-to-vote"});e.id=this.vote_btn_id;e.appendChild(b);d.parentNode.parentNode.parentNode.appendChild(e)}if($("login-action")){$("login-action").update("vote")}if($("registration-action")){$("registration-action").update("vote")}if($("login-submit")){$("login-submit").value="Sign In and Vote"}if($("register-submit")){$("register-submit").value="Register"}$("preview-again-from-login").hide();$("preview-again-from-registration").hide();$("login-form").show();$("regsitration-form").hide();$("registration-div").show();this.contribution_id=d.getAttribute("contributionid");$("switch_to_register").observe("click",function(g){g.stop();$("login-form").hide();$("regsitration-form").show();if(BF_DID_REGISTER){var f=new BF_Register();$("registration-message").innerHTML=f.ERR_ALREADY_REGISTERED;$("registration-message").addClassName("error");$("registration-message").show();$("registration-fieldset").hide();return}});var c=new BF_Register();c.register_handler()};this.vote=function(b){var c=b.getAttribute("contributionid");this._vote(b,c)};this._vote=function(c,h){try{if(c==null){c=$("vote-button-"+h)}var f={contributionid:h,username:$F("contribute-username"),uri:$F("contribute-uri")};var b=function(e){this.vote_success(c,e)}.bind(this);var g=function(e){this.error(c,e)}.bind(this);new Ajax.Request("/buzzfeed/_vote",{method:"get",parameters:f,onSuccess:b,onFailure:g});this.contribution_id=null}catch(d){this.contribution_id=null;console.error(d)}};this.vote_success=function(f,g){var c=g.responseText.evalJSON();if(!c.updated){this.duplicate_vote(f,c)}else{f.className="voted";f.innerHTML="Voted!";var h=f.getAttribute("contributionid");var e=$("vote_tally_"+h).getAttribute("tally");var b=parseInt(e)+1;var d=b==1?"":"s";$("vote_tally_"+h).update(b+" Vote"+d)}};this.duplicate_vote=function(c,b){c.className="voted";c.innerHTML=this.ALREADY_VOTED};this.error=function(b){}};vote_manager=new bf_vote_manager();BuzzLoader.register(vote_manager.init,1);(function(){function z(b){console.log("$f.fireEvent",[].slice.call(b))}function t(b){if(!b||typeof b!="object"){return b}var d=new b.constructor();for(var c in b){if(b.hasOwnProperty(c)){d[c]=t(b[c])}}return d}function p(b,e){if(!b){return}var g,f=0,d=b.length;if(d===undefined){for(g in b){if(e.call(b[g],g,b[g])===false){break}}}else{for(var c=b[0];f<d&&e.call(c,f,c)!==false;c=b[++f]){}}return b}function D(b){return document.getElementById(b)}function w(b,c,d){if(typeof c!="object"){return b}if(b&&c){p(c,function(f,e){if(!d||typeof e!="function"){b[f]=e}})}return b}function o(b){var d=b.indexOf(".");if(d!=-1){var e=b.slice(0,d)||"*";var f=b.slice(d+1,b.length);var c=[];p(document.getElementsByTagName(e),function(){if(this.className&&this.className.indexOf(f)!=-1){c.push(this)}});return c}}function A(b){b=b||window.event;if(b.preventDefault){b.stopPropagation();b.preventDefault()}else{b.returnValue=false;b.cancelBubble=true}return false}function u(b,d,c){b[d]=b[d]||[];b[d].push(c)}function B(){return"_"+(""+Math.random()).slice(2,10)}var y=function(c,e,d){var f=this,g={},b={};f.index=e;if(typeof c=="string"){c={url:c}}w(this,c,true);p(("Begin*,Start,Pause*,Resume*,Seek*,Stop*,Finish*,LastSecond,Update,BufferFull,BufferEmpty,BufferStop").split(","),function(){var k="on"+this;if(k.indexOf("*")!=-1){k=k.slice(0,k.length-1);var j="onBefore"+k.slice(2);f[j]=function(l){u(b,j,l);return f}}f[k]=function(l){u(b,k,l);return f};if(e==-1){if(f[j]){d[j]=f[j]}if(f[k]){d[k]=f[k]}}});w(this,{onCuepoint:function(j,k){if(arguments.length==1){g.embedded=[null,j];return f}if(typeof j=="number"){j=[j]}var l=B();g[l]=[j,k];if(d.isLoaded()){d._api().fp_addCuepoints(j,e,l)}return f},update:function(k){w(f,k);if(d.isLoaded()){d._api().fp_updateClip(k,e)}var l=d.getConfig();var j=(e==-1)?l.clip:l.playlist[e];w(j,k,true)},_fireEvent:function(m,G,l,k){if(m=="onLoad"){p(g,function(I,H){if(H[0]){d._api().fp_addCuepoints(H[0],e,I)}});return false}k=k||f;if(m=="onCuepoint"){var n=g[G];if(n){return n[1].call(d,k,l)}}if(G&&"onBeforeBegin,onMetaData,onStart,onUpdate,onResume".indexOf(m)!=-1){w(k,G);if(G.metaData){if(!k.duration){k.duration=G.metaData.duration}else{k.fullDuration=G.metaData.duration}}}var j=true;p(b[m],function(){j=this.call(d,k,G,l)});return j}});if(c.onCuepoint){var h=c.onCuepoint;f.onCuepoint.apply(f,typeof h=="function"?[h]:h);delete c.onCuepoint}p(c,function(k,j){if(typeof j=="function"){u(b,k,j);delete c[k]}});if(e==-1){d.onCuepoint=this.onCuepoint}};var s=function(g,e,f,c){var h=this,d={},b=false;if(c){w(d,c)}p(e,function(k,j){if(typeof j=="function"){d[k]=j;delete e[k]}});w(this,{animate:function(n,m,j){if(!n){return h}if(typeof m=="function"){j=m;m=500}if(typeof n=="string"){var k=n;n={};n[k]=m;m=500}if(j){var l=B();d[l]=j}if(m===undefined){m=500}e=f._api().fp_animate(g,n,m,l);return h},css:function(k,j){if(j!==undefined){var l={};l[k]=j;k=l}e=f._api().fp_css(g,k);w(h,e);return h},show:function(){this.display="block";f._api().fp_showPlugin(g);return h},hide:function(){this.display="none";f._api().fp_hidePlugin(g);return h},toggle:function(){this.display=f._api().fp_togglePlugin(g);return h},fadeTo:function(m,j,k){if(typeof j=="function"){k=j;j=500}if(k){var l=B();d[l]=k}this.display=f._api().fp_fadeTo(g,m,j,l);this.opacity=m;return h},fadeIn:function(j,k){return h.fadeTo(1,j,k)},fadeOut:function(j,k){return h.fadeTo(0,j,k)},getName:function(){return g},getPlayer:function(){return f},_fireEvent:function(l,m,k){if(l=="onUpdate"){var n=f._api().fp_getPlugin(g);if(!n){return}w(h,n);delete h.methods;if(!b){p(n.methods,function(){var H=""+this;h[H]=function(){var J=[].slice.call(arguments);var I=f._api().fp_invoke(g,H,J);return I==="undefined"||I===undefined?h:I}});b=true}}var j=d[l];if(j){var G=j.apply(h,m);if(l.slice(0,1)=="_"){delete d[l]}return G}return h}})};function E(K,f,l){var e=this,g=null,n=false,j,m,h=[],c={},d={},k,I,M,H,N,L;w(e,{id:function(){return k},isLoaded:function(){return(g!==null&&g.fp_play!==undefined&&!n)},getParent:function(){return K},hide:function(G){if(G){K.style.height="0px"}if(e.isLoaded()){g.style.height="0px"}return e},show:function(){K.style.height=L+"px";if(e.isLoaded()){g.style.height=N+"px"}return e},isHidden:function(){return e.isLoaded()&&parseInt(g.style.height,10)===0},load:function(G){if(!e.isLoaded()&&e._fireEvent("onBeforeLoad")!==false){var P=function(){if(j&&!flashembed.isSupported(f.version)){K.innerHTML=""}if(G){G.cached=true;u(d,"onLoad",G)}flashembed(K,f,{config:l})};var O=0;p(F,function(){this.unload(function(Q){if(++O==F.length){P()}})})}return e},unload:function(G){if(j.replace(/\s/g,"")!==""){if(e._fireEvent("onBeforeUnload")===false){if(G){G(false)}return e}n=true;try{if(g){g.fp_close();e._fireEvent("onUnload")}}catch(P){}var O=function(){g=null;K.innerHTML=j;n=false;if(G){G(true)}};if(/WebKit/i.test(navigator.userAgent)&&!/Chrome/i.test(navigator.userAgent)){setTimeout(O,0)}else{O()}}else{if(G){G(false)}}return e},getClip:function(G){if(G===undefined){G=H}return h[G]},getCommonClip:function(){return m},getPlaylist:function(){return h},getPlugin:function(P){var G=c[P];if(!G&&e.isLoaded()){var O=e._api().fp_getPlugin(P);if(O){G=new s(P,O,e);c[P]=G}}return G},getScreen:function(){return e.getPlugin("screen")},getControls:function(){return e.getPlugin("controls")._fireEvent("onUpdate")},getLogo:function(){try{return e.getPlugin("logo")._fireEvent("onUpdate")}catch(G){}},getPlay:function(){return e.getPlugin("play")._fireEvent("onUpdate")},getConfig:function(G){return G?t(l):l},getFlashParams:function(){return f},loadPlugin:function(O,P,T,G){if(typeof T=="function"){G=T;T={}}var Q=G?B():"_";e._api().fp_loadPlugin(O,P,T,Q);var R={};R[Q]=G;var S=new s(O,null,e,R);c[O]=S;return S},getState:function(){return e.isLoaded()?g.fp_getState():-1},play:function(O,P){var G=function(){if(O!==undefined){e._api().fp_play(O,P)}else{e._api().fp_play()}};if(e.isLoaded()){G()}else{if(n){setTimeout(function(){e.play(O,P)},50)}else{e.load(function(){G()})}}return e},getVersion:function(){var G="flowplayer.js 3.2.8";if(e.isLoaded()){var O=g.fp_getVersion();O.push(G);return O}return G},_api:function(){if(!e.isLoaded()){throw"Flowplayer "+e.id()+" not loaded when calling an API method"}return g},setClip:function(G){p(G,function(P,O){if(typeof O=="function"){u(d,P,O);delete G[P]}else{if(P=="onCuepoint"){$f(K).getCommonClip().onCuepoint(G[P][0],G[P][1])}}});e.setPlaylist([G]);return e},getIndex:function(){return M},bufferAnimate:function(G){g.fp_bufferAnimate(G===undefined||G);return e},_swfHeight:function(){return g.clientHeight}});p(("Click*,Load*,Unload*,Keypress*,Volume*,Mute*,Unmute*,PlaylistReplace,ClipAdd,Fullscreen*,FullscreenExit,Error,MouseOver,MouseOut").split(","),function(){var O="on"+this;if(O.indexOf("*")!=-1){O=O.slice(0,O.length-1);var G="onBefore"+O.slice(2);e[G]=function(P){u(d,G,P);return e}}e[O]=function(P){u(d,O,P);return e}});p(("pause,resume,mute,unmute,stop,toggle,seek,getStatus,getVolume,setVolume,getTime,isPaused,isPlaying,startBuffering,stopBuffering,isFullscreen,toggleFullscreen,reset,close,setPlaylist,addClip,playFeed,setKeyboardShortcutsEnabled,isKeyboardShortcutsEnabled").split(","),function(){var G=this;e[G]=function(P,Q){if(!e.isLoaded()){return e}var O=null;if(P!==undefined&&Q!==undefined){O=g["fp_"+G](P,Q)}else{O=(P===undefined)?g["fp_"+G]():g["fp_"+G](P)}return O==="undefined"||O===undefined?e:O}});e._fireEvent=function(S){if(typeof S=="string"){S=[S]}var G=S[0],U=S[1],W=S[2],X=S[3],Y=0;if(l.debug){z(S)}if(!e.isLoaded()&&G=="onLoad"&&U=="player"){g=g||D(I);N=e._swfHeight();p(h,function(){this._fireEvent("onLoad")});p(c,function(P,O){O._fireEvent("onUpdate")});m._fireEvent("onLoad")}if(G=="onLoad"&&U!="player"){return}if(G=="onError"){if(typeof U=="string"||(typeof U=="number"&&typeof W=="number")){U=W;W=X}}if(G=="onContextMenu"){p(l.contextMenu[U],function(P,O){O.call(e)});return}if(G=="onPluginEvent"||G=="onBeforePluginEvent"){var ab=U.name||U;var aa=c[ab];if(aa){aa._fireEvent("onUpdate",U);return aa._fireEvent(W,S.slice(3))}return}if(G=="onPlaylistReplace"){h=[];var V=0;p(U,function(){h.push(new y(this,V++,e))})}if(G=="onClipAdd"){if(U.isInStream){return}U=new y(U,W,e);h.splice(W,0,U);for(Y=W+1;Y<h.length;Y++){h[Y].index++}}var T=true;if(typeof U=="number"&&U<h.length){H=U;var Z=h[U];if(Z){T=Z._fireEvent(G,W,X)}if(!Z||T!==false){T=m._fireEvent(G,W,X,Z)}}p(d[G],function(){T=this.call(e,U,W);if(this.cached){d[G].splice(Y,1)}if(T===false){return false}Y++});return T};function J(){if($f(K)){$f(K).getParent().innerHTML="";M=$f(K).getIndex();F[M]=e}else{F.push(e);M=F.length-1}L=parseInt(K.style.height,10)||K.clientHeight;k=K.id||"fp"+B();I=f.id||k+"_api";f.id=I;j=K.innerHTML;if(typeof l=="string"){l={clip:{url:l}}}l.playerId=k;l.clip=l.clip||{};if(K.getAttribute("href",2)&&!l.clip.url){l.clip.url=K.getAttribute("href",2)}m=new y(l.clip,-1,e);l.playlist=l.playlist||[l.clip];var P=0;p(l.playlist,function(){var R=this;if(typeof R=="object"&&R.length){R={url:""+R}}p(l.clip,function(T,S){if(S!==undefined&&R[T]===undefined&&typeof S!="function"){R[T]=S}});l.playlist[P]=R;R=new y(R,P,e);h.push(R);P++});p(l,function(R,S){if(typeof S=="function"){if(m[R]){m[R](S)}else{u(d,R,S)}delete l[R]}});p(l.plugins,function(R,S){if(S){c[R]=new s(R,S,e)}});if(!l.plugins||l.plugins.controls===undefined){c.controls=new s("controls",null,e)}c.canvas=new s("canvas",null,e);j=K.innerHTML;function G(R){if(/iPad|iPhone|iPod/i.test(navigator.userAgent)&&!/.flv$/i.test(h[0].url)&&!O()){return true}if(!e.isLoaded()&&e._fireEvent("onBeforeClick")!==false){e.load()}return A(R)}function O(){return e.hasiPadSupport&&e.hasiPadSupport()}function Q(){if(j.replace(/\s/g,"")!==""){if(K.addEventListener){K.addEventListener("click",G,false)}else{if(K.attachEvent){K.attachEvent("onclick",G)}}}else{if(K.addEventListener&&!O()){K.addEventListener("click",A,false)}e.load()}}setTimeout(Q,0)}if(typeof K=="string"){var b=D(K);if(!b){throw"Flowplayer cannot access element: "+K}K=b;J()}else{J()}}var F=[];function C(c){this.length=c.length;this.each=function(d){p(c,d)};this.size=function(){return c.length};var b=this;for(name in E.prototype){b[name]=function(){var d=arguments;b.each(function(){this[name].apply(this,d)})}}}window.flowplayer=window.$f=function(){var f=null;var g=arguments[0];if(!arguments.length){p(F,function(){if(this.isLoaded()){f=this;return false}});return f||F[0]}if(arguments.length==1){if(typeof g=="number"){return F[g]}else{if(g=="*"){return new C(F)}p(F,function(){if(this.id()==g.id||this.id()==g||this.getParent()==g){f=this;return false}});return f}}if(arguments.length>1){var b=arguments[1],e=(arguments.length==3)?arguments[2]:{};if(typeof b=="string"){b={src:b}}b=w({bgcolor:"#000000",version:[9,0],expressInstall:"http://static.flowplayer.org/swf/expressinstall.swf",cachebusting:false},b);if(typeof g=="string"){if(g.indexOf(".")!=-1){var c=[];p(o(g),function(){c.push(new E(this,t(b),t(e)))});return new C(c)}else{var d=D(g);return new E(d!==null?d:t(g),t(b),t(e))}}else{if(g){return new E(g,t(b),t(e))}}}return null};w(window.$f,{fireEvent:function(){var c=[].slice.call(arguments);var b=$f(c[0]);return b?b._fireEvent(c.slice(1)):null},addPlugin:function(c,b){E.prototype[c]=b;return $f},each:p,extend:w});if(typeof jQuery=="function"){jQuery.fn.flowplayer=function(b,c){if(!arguments.length||typeof arguments[0]=="number"){var d=[];this.each(function(){var e=$f(this);if(e){d.push(e)}});return arguments.length?d[arguments[0]]:new C(d)}return this.each(function(){$f(this,t(b),c?t(c):{})})}}})();(function(){var n=document.all,l="http://www.adobe.com/go/getflashplayer",t=typeof jQuery=="function",p=/(\d+)[^\d]+(\d+)[^\d]*(\d*)/,u={width:"100%",height:"100%",id:"_"+(""+Math.random()).slice(9),allowfullscreen:true,allowscriptaccess:"always",quality:"high",version:[3,0],onFail:null,expressInstall:null,w3c:false,cachebusting:false};if(window.attachEvent){window.attachEvent("onbeforeunload",function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){}})}function m(b,c){if(c){for(var d in c){if(c.hasOwnProperty(d)){b[d]=c[d]}}}return b}function w(d,e){var b=[];for(var c in d){if(d.hasOwnProperty(c)){b[c]=e(d[c])}}return b}window.flashembed=function(d,b,c){if(typeof d=="string"){d=document.getElementById(d.replace("#",""))}if(!d){return}if(typeof b=="string"){b={src:b}}return new s(d,m(m({},u),b),c)};var o=m(window.flashembed,{conf:u,getVersion:function(){var b,d;try{d=navigator.plugins["Shockwave Flash"].description.slice(16)}catch(e){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");d=b&&b.GetVariable("$version")}catch(g){try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");d=b&&b.GetVariable("$version")}catch(c){}}}d=p.exec(d);return d?[d[1],d[3]]:[0,0]},asString:function(c){if(c===null||c===undefined){return null}var d=typeof c;if(d=="object"&&c.push){d="array"}switch(d){case"string":c=c.replace(new RegExp('(["\\\\])',"g"),"\\$1");c=c.replace(/^\s?(\d+\.?\d*)%/,"$1pct");c=c.replace(/(%)/g,"%25").replace(/'/g,"\\u0027").replace(/"/g,"\\u0022").replace(/&/g,"%26");return'"'+c+'"';case"array":return"["+w(c,function(g){return o.asString(g)}).join(",")+"]";case"function":return'"function()"';case"object":var b=[];for(var e in c){if(c.hasOwnProperty(e)){b.push('"'+e+'":'+o.asString(c[e]))}}return"{"+b.join(",")+"}"}return String(c).replace(/\s/g," ").replace(/\'/g,'"')},getHTML:function(h,c){h=m({},h);var j='<object width="'+h.width+'" height="'+h.height+'" id="'+h.id+'" name="'+h.id+'"';if(h.cachebusting){h.src+=((h.src.indexOf("?")!=-1?"&":"?")+Math.random())}if(h.w3c||!n){j+=' data="'+h.src+'" type="application/x-shockwave-flash"'}else{j+=' classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'}j+=">";if(h.w3c||n){j+='<param name="movie" value="'+h.src+'" />'}h.width=h.height=h.id=h.w3c=h.src=null;h.onFail=h.version=h.expressInstall=null;for(var b in h){if(h[b]){j+='<param name="'+b+'" value="'+h[b]+'" />'}}var g="";if(c){for(var e in c){if(c[e]){var d=c[e];g+=e+"="+(/function|object/.test(typeof d)?o.asString(d):d)+"&"}}g=g.slice(0,-1);j+='<param name="flashvars" value=\''+g+"' />"}j+="</object>";return j},isSupported:function(b){return f[0]>b[0]||f[0]==b[0]&&f[1]>=b[1]}});var f=o.getVersion();function s(d,e,b){if(o.isSupported(e.version)){d.innerHTML=o.getHTML(e,b)}else{if(e.expressInstall&&o.isSupported([6,65])){d.innerHTML=o.getHTML(m(e,{src:e.expressInstall}),{MMredirectURL:encodeURIComponent(location.href),MMplayerType:"PlugIn",MMdoctitle:document.title})}else{if(!d.innerHTML.replace(/\s/g,"")){d.innerHTML="<h2>Flash version "+e.version+" or greater is required</h2><h3>"+(f[0]>0?"Your version is "+f:"You have no flash plugin installed")+"</h3>"+(d.tagName=="A"?"<p>Click here to download latest version</p>":"<p>Download latest version from <a href='"+l+"'>here</a></p>");if(d.tagName=="A"){d.onclick=function(){location.href=l}}}if(e.onFail){var c=e.onFail.call(this);if(typeof c=="string"){d.innerHTML=c}}}}if(n){window[e.id]=document.getElementById(e.id)}m(this,{getRoot:function(){return d},getOptions:function(){return e},getConf:function(){return b},getApi:function(){return d.firstChild}})}if(t){jQuery.tools=jQuery.tools||{version:"3.2.8"};jQuery.tools.flashembed={conf:u};jQuery.fn.flashembed=function(b,c){return this.each(function(){$(this).data("flashembed",flashembed(this,b,c))})}}})();var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion(){var b;var c;var d;try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");b=c.GetVariable("$version")}catch(d){}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");b="WIN 6,0,21,0";c.AllowScriptAccess="always";b=c.GetVariable("$version")}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");b=c.GetVariable("$version")}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");b="WIN 3,0,18,0"}catch(d){}}if(!b){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");b="WIN 2,0,0,11"}catch(d){b=-1}}return b}function GetSwfVer(){var h=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var g=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var b=navigator.plugins["Shockwave Flash"+g].description;var f=b.split(" ");var d=f[2].split(".");var j=d[0];var c=d[1];var e=f[3];if(e==""){e=f[4]}if(e[0]=="d"){e=e.substring(1)}else{if(e[0]=="r"){e=e.substring(1);if(e.indexOf("d")>0){e=e.substring(0,e.indexOf("d"))}}}var h=j+"."+c+"."+e}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){h=4}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){h=3}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){h=2}else{if(isIE&&isWin&&!isOpera){h=ControlVersion()}}}}}return h}function DetectFlashVer(g,e,d){versionStr=GetSwfVer();if(versionStr==-1){return false}else{if(versionStr!=0){if(isIE&&isWin&&!isOpera){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",")}else{versionArray=versionStr.split(".")}var f=versionArray[0];var b=versionArray[1];var c=versionArray[2];if(f>parseFloat(g)){return true}else{if(f==parseFloat(g)){if(b>parseFloat(e)){return true}else{if(b==parseFloat(e)){if(c>=parseFloat(d)){return true}}}}}return false}}}function AC_AddExtension(c,b){if(c.indexOf("?")!=-1){return c.replace(/\?/,b+"?")}else{return c+b}}function AC_Generateobj(f,e,b){var d="";if(isIE&&isWin&&!isOpera){d+="<object ";for(var c in f){d+=c+'="'+f[c]+'" '}for(var c in e){d+='><param name="'+c+'" value="'+e[c]+'" /> '}d+="></object>"}else{d+="<embed ";for(var c in b){d+=c+'="'+b[c]+'" '}d+="> </embed>"}document.write(d)}function AC_FL_RunContent(){var b=AC_GetArgs(arguments,".swf","movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");AC_Generateobj(b.objAttrs,b.params,b.embedAttrs)}function AC_GetArgs(c,f,h,e,j){var b=new Object();b.embedAttrs=new Object();b.params=new Object();b.objAttrs=new Object();for(var d=0;d<c.length;d=d+2){var g=c[d].toLowerCase();switch(g){case"classid":break;case"pluginspage":b.embedAttrs[c[d]]=c[d+1];break;case"src":case"movie":c[d+1]=AC_AddExtension(c[d+1],f);b.embedAttrs.src=c[d+1];b.params[h]=c[d+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":b.objAttrs[c[d]]=c[d+1];break;case"id":case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":b.embedAttrs[c[d]]=b.objAttrs[c[d]]=c[d+1];break;default:b.embedAttrs[c[d]]=b.params[c[d]]=c[d+1]}}b.objAttrs.classid=e;if(j){b.embedAttrs.type=j}return b}var BF_ANNOUNCEMENT={announcement:false,cookie_name:"bf_announce",set:function(d,c,b){if(typeof(b)=="undefined"){b={}}if(!b.close){b.close=false}BF_ANNOUNCEMENT.announcement={id:d,text:c,close:(close?true:false)};if(BF_ANNOUNCEMENT._get_cookie(BF_ANNOUNCEMENT.cookie_name)!=BF_ANNOUNCEMENT.announcement.id){document.write('<div id="bar_announcement"><div id="bar_announcement_area" class="c">'+(b.close?'<a id="announcement_close" class="close" href="javascript:;">'+b.close.text+"</a>":"")+"<p>"+c+"</p></div></div>");if(b.close){$("announcement_close").observe("click",function(f){if(b.close.handler){try{b.close.handler(f)}catch(f){}}else{}return false})}if($$(".react")){$$(".react").each(function(f,e){f.observe("click",function(h){var g=h.target.getAttribute("rel:reaction");if(typeof g!="undefined"){BF_ANNOUNCEMENT.react(g)}})})}if($("feedback_email")){$("feedback_email").observe("click",function(f){gtrack.track_events(BF_ANNOUNCEMENT.announcement.id+":announcement_bar","feedback/email","")})}}},react:function(b){gtrack.track_events(BF_ANNOUNCEMENT.announcement.id+":announcement_bar","feedback/"+b,"");$("announcement_bar_react").hide();$("announcement_bar_thanks").show()},close:function(b){var c=BF_ANNOUNCEMENT.announcement.expires;if(!c){c=2592000000}BF_ANNOUNCEMENT._set_cookie(BF_ANNOUNCEMENT.cookie_name,BF_ANNOUNCEMENT.announcement.id);$("bar_announcement").hide()},_get_cookie:function(c){if(BF_ANNOUNCEMENT._has_cookie(c)){var b=document.cookie.match("(^|;) ?"+c+"=([^;]*)(;|$)");return unescape(b[2])}else{return false}},_has_cookie:function(d,b){var c=document.cookie.match("(^|;) ?"+d+"=([^;]*)(;|$)");if(b&&typeof(b)=="string"){b=RegExp(RegExp.escape(b))}return(c?(b&&b!=""?unescape(c[2]).match(b):(c[2]!=this.cookies_cancel)):false)},_set_cookie:function(m,c,j,g){var f=31536000000,b="",l="";if(j||j==0){f=parseInt(j)}if(f!=0){var k=new Date();k.setTime(k.getTime()+f);b="; expires="+k.toGMTString()}l=escape(m)+"="+escape(c)+b+"; path=/; domain=."+(g?escape(g):"buzzfeed.com");document.cookie=l}};var BF_KeyControls=function(){this.scroll=null;this.commands=[];this.debug=false;this.matches=function(c,b){if(!!!b.keys.include(c.which)){return false}if((!b.alt&&!!c.altKey)||(!!b.alt&&!c.altKey)){return false}if((!b.ctrl&&!!c.ctrlKey)||(!!b.ctrl&&!c.ctrlKey)){return false}if((!b.shift&&!!c.shiftKey)||(!!b.shift&&!c.shiftKey)){return false}if((!b.cmd&&!!c.metaKey)||(!!b.cmd&&!c.metaKey)){return false}return true};this.init=function(){if(!!this.debug){document.observe("keydown",function(b){console.log("Key: "+(Prototype.Browser.IE?b.keyCode:b.which));console.log(b);return true})}if(this.scroll){this.scroll.slides=$$(this.scroll.items);if(this.scroll.reject_items&&this.scroll.reject_items.length>0){this.scroll.slides=this.scroll.slides.reject(function(d){var b=false,e=d.className.split(" ");e.each(function(c){if(this.scroll.reject_items.include(c)){b=true}}.bind(this));if(d.id&&!!this.scroll.reject_items.include(d.id)){b=true}return b}.bind(this))}if(this.scroll.slides.length>0){if(!this.scroll.keys_up){this.scroll.keys_up=[75,37]}if(!this.scroll.keys_down){this.scroll.keys_down=[74,39]}this.scroll.start_height=this.scroll.slides[0].cumulativeOffset().top;document.observe("keydown",this._scroll.bind(this))}}this.commands.each(function(c,b){if(!c.keys){return}document.observe("keydown",function(g){var d=(Prototype.Browser.IE?g.srcElement:g.target);if(d!=document.body&&d!=$$("html").first()){return true}if(Prototype.Browser.IE){g.which=g.keyCode}if(!!(new BF_KeyControls()).matches(g,this)){if(this._track&&this._track!=""&&!this._track_use){var h=(this.name&&!this.name==""?this.name:this.keys.join(","));gtrack.track_events(this._track,"click:keycontrol",h,true);this._track_use=true}if(this.target){var f=$(this.target);if(f){f.scrollTo()}}if(typeof(this.run)=="function"){this.run()}}return true}.bind(c))})};this._scroll=function(f){if(this.scroll.slides.length<1){return true}var c=(Prototype.Browser.IE?f.srcElement:f.target);if(c!=document.body&&c!=$$("html").first()){return true}if(Prototype.Browser.IE){f.which=f.keyCode}var b=(!!(new BF_KeyControls()).matches(f,{keys:this.scroll.keys_up})),g=(!!(new BF_KeyControls()).matches(f,{keys:this.scroll.keys_down}));if(b||g){if(this.scroll._track&&this.scroll._track!=""&&!this.scroll._track_use){gtrack.track_events(this.scroll._track,"click:keycontrol","scroll",true);this.scroll._track_use=true}this.scroll.position=this.scroll.slides.length-1;if($$("body").first().cumulativeScrollOffset().top>=this.scroll.start_height){this.scroll.slides.each(function(h,e){if(b&&h.viewportOffset().top>=0){this.scroll.position=e-1;throw $break}else{if(g&&h.viewportOffset().top>0){this.scroll.position=e;throw $break}}}.bind(this))}else{this.scroll.position=0}if(this.scroll.position>=-1&&this.scroll.position<this.scroll.slides.length){if(typeof(this.scroll.onbefore)=="function"){this.scroll.onbefore(f)}if(typeof(this.scroll.onafter)=="function"){this.scroll.onafter(f)}var d=$(this.scroll.slides[this.scroll.position]);if(d){$(d).scrollTo()}return false}}}};BF_sub_links=function(){this.sub_id;this.page_url;var b;this.init=function(){if(BF_STATIC.referer=="pinterest.com"||document.referrer.match("https?://(?:www.)?pinterest.com/")){b=true}universal_dom.assign_handler({bucket:"fb-share",handler:sub_links.sub_share,event:"click"});universal_dom.assign_handler({bucket:"tw-share",handler:sub_links.sub_share,event:"click"});universal_dom.assign_handler({bucket:"link-share",handler:sub_links.sub_share,event:"click"});universal_dom.assign_handler({bucket:"pin-share",handler:sub_links.sub_share,event:"click"});universal_dom.assign_handler({bucket:"response-share",handler:sub_links.response_share,event:"click"});universal_dom.assign_handler({bucket:"email-share",handler:sub_links.sub_share,event:"click"});if(document.URL.include("?sub")){var c=document.URL.toQueryParams();sub_links.sub_id=c.sub}if(sessionStorage[sub_links.sub_id]){sessionStorage[sub_links.sub_id]=false}document.observe("scroll",sub_links.hide_link);document.observe("click",sub_links.click_hide);sub_links.process_URL();sub_links.set_share_box();if(!b&&$$(".share-box")&&$$(".share-box").length>0){Event.observe(window,"scroll",function(d){sub_links.share_buddy()})}sub_links.share_box_hover_fix()};this.share_box_hover_fix=function(){if(isMSIE()){$$(".buzz_superlist_item").each(function(c){c.observe("mouseover",function(){c.addClassName("hover")}).observe("mouseout",function(){c.removeClassName("hover")})})}};this.process_URL=function(){if(document.URL.include("?sub")){var f=document.URL.toQueryParams();sub_links.sub_id=f.sub;if(sub_links.sub_id!="undefined"){var c=$("superlist_"+sub_links.sub_id);var e=c.getHeight();sub_links.sub_scroll(c);sessionStorage[sub_links.sub_id]=true;$(c).addClassName("current_buzz");var d=function(){c.addClassName("current_buzz_reset")};d.delay(2)}}};this.get_sub_id=function(d){var c="";if(d.include("_")){c=d.split("_")[1]}return c};this.get_url=function(d){var c=document.URL;if(c.include("?")){c=c.split("?")[0]}if(c.include("#")){c=c.split("#")[0]}sub_links.page_url=c;if(d){c=c+"?sub="+d}if(typeof pound!="undefined"){c=pound.urls.unescaped.hashAndQueryString(["fb_ref"],[["sub",d]]);sub_links.page_url=c;console.log("URL",c)}return c};this.get_buzz_title=function(){var c="";if($$('meta[name="title"]').length>0&&$$('meta[name="title"]')[0].attributes.content.value){c=$$('meta[name="title"]')[0].attributes.content.value}else{if($$('meta[property="og:title"]').length>0&&$$('meta[property="og:title"]')[0].attributes.content.value){c=$$('meta[property="og:title"]')[0].attributes.content.value}else{if($("post-title")){c=$("post-title").innerHTML.replaceAll("&nbsp;"," ")}}}return c?c.unescapeHTML().stripTags().trim():""};this.sub_share=function(p){sub_links.sub_id=p.id;var h=sub_links.get_url(p.not_a_sub?null:p.id);var w=$("superlist_"+p.id);var e;var A;if($$('meta[property="og:description"]').length>0){A=$$('meta[property="og:description"]')[0].attributes.content.value}else{A=""}if(p.element.getAttribute("rel:sub_title")!=null){var E=p.element.getAttribute("rel:sub_title")}if($$('meta[property="og:title"]').length>0&&$$('meta[property="og:title"]')[0].attributes.content.value!=""){var n=$$('meta[property="og:title"]')[0].attributes.content.value}var l=p.element.getAttribute("rel:adtl_tweet_text")?p.element.getAttribute("rel:adtl_tweet_text"):"";var u=p.element.getAttribute("rel:hashtags")?p.element.getAttribute("rel:hashtags"):"";var z=p.element.getAttribute("rel:via")?p.element.getAttribute("rel:via"):"";var e=new Array();var D=BF_STATIC.big_image_root+$$('meta[property="og:image"]')[0].attributes.content.value;if($(w).hasClassName("buzz_superlist_item_image")||($(w).hasClassName("buzz_superlist_item_video")&&$(w).hasClassName("video_instagram"))){$("superlist_"+p.id).select(".sub_buzz_content img").each(function(t){e.push(t)})}else{if($(w).hasClassName("buzz_superlist_item_video")&&!$(w).hasClassName("video_instagram")){$("superlist_"+p.id).select(".sub_buzz_content embed").each(function(t){e.push(t)})}else{if($(w).hasClassName("buzz_superlist_item_grid_row")){$("superlist_"+p.id).select(".grid_cell img").each(function(t){e.push(t)})}else{if($(w).hasClassName("buzz_superlist_item_update")){var m=$("update_item_"+p.id);$(m).select(".sub_buzz_content img").each(function(t){e.push(t)});$(m).select(".sub_buzz_content embed").each(function(t){e.push(t)});$(m).select(".buzz_superlist_item_grid_row .grid_cell img").each(function(t){e.push(t)})}}}}if($(w).hasClassName("buzz_superlist_item_update")){var m=$("update_item_"+p.id),g,E="";if(m.select(".buzz_superlist_item:not(.buzz_superlist_item_update)").length>0){g=m.select(".buzz_superlist_item:not(.buzz_superlist_item_update)").first();if(g.select("h2").length>0){E=g.select("h2").first().innerHTML.unescapeHTML().stripTags().trim()}}if(!E){E=n}}if(p.element.hasClassName("sub-buzz-facebook-share")){h=encodeURIComponent(h);E=encodeURIComponent(E);A=encodeURIComponent(A);u=encodeURIComponent(u);l=encodeURIComponent(l);z=encodeURIComponent(z);var k="";e.each(function(F,t){k+="&p[images]["+t+"]="+encodeURIComponent(F.readAttribute("rel:bf_image_src"))});if(!k){k="&p[images]["+0+"]="+encodeURIComponent(D)}window.open("http://facebook.com/sharer/sharer.php?s=100&p[url]="+h+"&p[title]="+E+k+"&p[summary]="+A,"_blank","width=600, height=260");sub_links.hide_link(p.id,false);fbSharePixel()}else{if(p.element.hasClassName("sub-buzz-twitter-share")){E=encodeURIComponent(E);l=encodeURIComponent(l);u=encodeURIComponent(u);z=encodeURIComponent(z);h=encodeURIComponent(h);window.open("https://twitter.com/intent/tweet?text="+E+l+"&hashtags="+u+(z?"&via="+z:"")+"&url="+h,"_blank","width=600,height=400");sub_links.hide_link(p.id,false)}else{if(p.element.hasClassName("sub-buzz-link-share")){$(w).select(".copy-link").each(function(t){$(t).remove()});$(w).select(".share-box").each(function(F){if($(w).hasClassName("buzz_superlist_item_video")&&!$(w).hasClassName("video_instagram")){$(F).insert('<div style="width:360px; height:28px; background:#eeeeee; border:1px solid #CECECE; border-radius:5px; position:absolute; top:90px; padding:5px;font-size:14px;" class="copy-link"><input class="copy-link-input" type="text" value="'+h+'" style="width:350px; border:1px solid #ddd; font-size:13px; padding:3px 4px;"/></div>')}else{if($(w).hasClassName("buzz_superlist_item_update")){$(F).insert('<div style="width:360px; height:28px; background:#eeeeee; border:1px solid #CECECE; border-radius:5px; position:absolute; top:45px; padding:5px;font-size:14px;z-index:99" class="copy-link"><input class="copy-link-input" type="text" value="'+h+'" style="width:350px; border:1px solid #ddd; font-size:13px; padding:3px 4px;"/></div>')}else{$(F).insert('<div style="width:360px; height:28px; background:#eeeeee; border:1px solid #CECECE; border-radius:5px; position:absolute; top:120px; padding:5px;font-size:14px;" class="copy-link"><input class="copy-link-input" type="text" value="'+h+'" style="width:350px; border:1px solid #ddd; font-size:13px; padding:3px 4px;"/></div>')}}sub_links.hide_link(p.id,true);var t=Selector.findChildElements(F,[".copy-link-input"])[0];t.select()})}else{if(p.element.hasClassName("sub-buzz-pinterest-share")){var C=encodeURIComponent(h);var c="";if(e.length<=1){var d;if(e.length==0){d=D}else{d=e[0].readAttribute("rel:bf_image_src")}d=encodeURIComponent(d);var o=Prototype.Browser.IE?636:336;if(p.element.up(".buzz_superlist_item").select("h2").length){var B=Element.clone(p.element.up(".buzz_superlist_item").select("h2")[0],true);if(B.select("span.buzz_superlist_number_inline").length){B.select("span.buzz_superlist_number_inline")[0].remove()}c=B.innerHTML.unescapeHTML().stripTags().trim()}if(n){c=c?c+" | "+n:n}c=encodeURIComponent(c);window.open("http://pinterest.com/pin/create/button/?media="+d+"&url="+C+"&description="+c,"_blank","width=600,height="+o);sub_links.hide_link(p.id,false)}else{var j=$(document.viewport).getScrollOffsets().top;window.scrollTo(0,0);var f=BF_UTIL.browser.dimensions.height();$("pin_bg").setStyle({height:f+"px"});$("pin_bd").setStyle({height:f+"px"});if($("pin_img_container").innerHTML){$("pin_img_container").innerHTML=""}document.body.appendChild($("pin_bg").show()).appendChild($("pin_bd").show());var s=$$("#superlist_"+sub_links.sub_id+" img");if($(w).hasClassName("buzz_superlist_item_update")){s=e}if(s.length){s.each(function(I){c="";var t=document.createElement("SPAN");t.addClassName("pin_image");var H=sub_links.get_natural_img_size(I).width,M=sub_links.get_natural_img_size(I).height,F=200,L=200,J="";if(H>M){F=I.width/(I.height/200);J="margin-left: "+(0-(F-200)/2)+"px"}else{L=I.height/(I.width/200);J="margin-top: "+(0-(L-200)/2)+"px"}var G=I.readAttribute("rel:bf_image_src");if(I.up(".buzz_superlist_item").select("h2").length){var K=Element.clone(I.up(".buzz_superlist_item").select("h2")[0],true);if(K.select("span.buzz_superlist_number_inline").length){K.select("span.buzz_superlist_number_inline")[0].remove()}c=K.innerHTML.unescapeHTML().stripTags().trim()}if(n){c=c?c+" | "+n:n}c=encodeURIComponent(c);t.innerHTML='<span class="pin_img"><img style="'+J+'" src="'+G+'" width="'+F+'px" height="'+L+'px"></span><cite><span class="pin_mask"></span><span>'+H+"x"+M+"</span></cite><a onclick=\"var sTop = window.screen.height/2-(168); var sLeft = window.screen.width/2-(313); window.open(this.href, 'sharer','toolbar=0,status=0,width=626,height=336,top='+sTop+',left='+sLeft); window.scrollTo(0,"+j+'); return false;" href="http://pinterest.com/pin/create/bookmarklet/?url='+C+"&media="+G+"&description="+c+'" target="_blank"></a>';t.select("a")[0].observe("click",function(){if($("pin_bg")){$("pin_bg").hide()}if($("pin_bd")){$("pin_bd").hide()}});$("pin_img_container").appendChild(t)})}}}else{if(p.element.hasClassName("sub-buzz-email-share")){$("share_email_error").hide();var h=sub_links.get_url(p.id);var y=$(p.element.id);shareEmail.locate_form_and_share_email($(y),p.id);$("sub_buzz_id").value=sub_links.get_sub_id(p.id)}}}}}};this.response_share=function(d){BF_Effect.ScrollIntoView("contribute-box");var c=d.target.getAttribute("rel:count");Form.Element.setValue("text-text","#"+c)};this.hide_link=function(d,c){if($("buzz_sub_buzz")){if(!c){$("buzz_sub_buzz").select(".copy-link").each(function(e){$(e).hide()})}else{$("buzz_sub_buzz").select(".copy-link").each(function(e){$(e).oncopy=function(){BF_Effect.FadeOut(e,0,1)}})}}};this.click_hide=function(d){try{if(typeof(d.target)=="undefined"||!isHTMLElement(d.target)){console.log("Not html element. SVG fix.");return}var c=(d.target.hasClassName("sub-buzz-link-share")||d.target.hasClassName("copy-link")||d.target.parentNode.hasClassName("copy-link"));if(!c){sub_links.hide_link()}}catch(d){console.error(d)}};this.set_share_box=function(){var c=0;var d=new Array();$$(".buzz_superlist_item").each(function(f){if(b){f.addClassName("pin-ref");if(f.hasClassName("buzz_superlist_item_grid_row")){var e=f.select(".share-box")[0];if(f.select(".grid_row")[0]){f.select(".grid_row")[0].insert(e);e.addClassName("pin_grid_share")}}}$(f).select(".share-box").each(function(h){if(f.getHeight()<=250){$(h).setStyle({top:"0px"})}});if(f.hasClassName("buzz_superlist_item_video")&&!f.hasClassName("video_instagram")){$(f).select(".share-box").each(function(h){$(h).select(".copy-link").each(function(j){$(j).setStyle({top:"100px"})})})}else{c++;var g=$(f).select(".response-button");g.each(function(h){$(h).removeClassName("hidden");$(h).setAttribute("rel:count",c)})}})};this.arrow_fade=function(){var c=$("here-arrow");if(typeof c!=null){BF_Effect.FadeOut("here-arrow",0)}};this.sub_scroll=function(c){if(document.loaded){$(c).scrollTo()}};this.get_natural_img_size=function(d){if(isIE7()||isIE8()){var c=new Image();c.src=d.src;return{width:c.width,height:c.height}}else{return{width:d.naturalWidth,height:d.naturalHeight}}};this.share_buddy=function(){try{$$(".buzz_superlist_item_image").each(function(d){var g=d.select("img")[0].height;if(g>=550){var f=Element.viewportOffset(d.select("img")[0]).top;if(f<=0&&(f*-1)<=(g-200)){var e=d.select(".share-box")[0];if(typeof(e)!="undefined"){f=(f*-1)+10;e.setStyle({top:f+"px"})}}}})}catch(c){console.error(c)}}};var sub_links=new BF_sub_links();BuzzLoader.register(sub_links.init,4);var player_1;var player_2;function onYouTubePlayerAPIReady(b){player_1=new YT.Player("nhl_1",{events:{onReady:e,onStateChange:c}});player_2=new YT.Player("nhl_2",{events:{onReady:d,onStateChange:c}});function e(f){f.target.cuePlaylist({list:"PLCDBC58F5089E5045",index:0,startSeconds:0,suggestedQuality:"large"});gtrack.track_events("Buzz","[nc]playlist:load","stanley-cup-countdown",null,false)}function d(f){f.target.cuePlaylist({list:"PL1F9AA0374C05807A",index:0,startSeconds:0,suggestedQuality:"large"});gtrack.track_events("Buzz","[nc]playlist:load","melroses-place",null,false)}function c(g){var f=g.target.g.playlistIndex;if(f!=-1){var j=g.target.g.playlist[f];var h="http://youtube.com/v/"+j;switch(g.data){case -1:gtrack.track_events("Buzz","[nc]video:load",h,null,true);break;case 0:gtrack.track_events("Buzz","[nc]video:end",h,null,false);break;case 1:gtrack.track_events("Buzz","video-play",h);break}}}}var BF_Quiz=function(){this.quizes={};this.answerResponse=local.t("#{a} is the correct answer.");this.messages={generic:{tally:local.t("You got #{x} out of #{y} right!"),fb:local.t("I got #{score} out of #{total}! How do you measure up?"),tw:local.t("I got #{score} out of #{total} on #{title}!"),email_subject:"#{title}",email_body:local.t("I got #{score} out of #{total}! %0d%0d #{link}")},personality:{fb:local.t("I got #{result}! #{title}"),tw:local.t("I got #{result}! #{title}"),email_body:local.t("I got #{result}! %0d%0d #{link}")},checklist:{tally:"You#{result_verb} #{checked} out of #{total}#{result_subject}",fb:local.t("I#{result_verb} #{checked} out of #{total}#{result_subject} #{title}"),tw:local.t("I#{result_verb} #{checked} out of #{total}#{result_subject} #{title}"),email_body:local.t("I#{result_verb} #{checked} out of #{total}#{result_subject} %0d%0d #{link})")}};this.init=function(){var b=$(document.body)[bfjs.selector]("#buzz_sub_buzz .quiz");bfjs.universal_each(b,function(d,l){var j=$(d)[bfjs.read_attr]("rel:quiz_type");var c=$(d)[bfjs.read_attr]("rel:id");var f=$(d)[bfjs.read_attr]("rel:swap")=="1"?true:false;var g=$(d)[bfjs.selector](".quiz_question");var h=$(d)[bfjs.selector](".quiz_result");var e=$(d)[bfjs.read_attr]("rel:question_count");var k=$(d)[bfjs.selector](".quiz_result_area").first();bf_quiz.quizes[l]={};bf_quiz.quizes[l]["id"]=c;bf_quiz.quizes[l]["type"]=j;bf_quiz.quizes[l]["swap"]=f;bf_quiz.quizes[l]["el"]=$(d);bf_quiz.quizes[l]["questions"]={};bf_quiz.quizes[l]["results"]={};bf_quiz.quizes[l]["question_count"]=e;bf_quiz.quizes[l]["quiz_result_area_el"]=k;bf_quiz.quizes[l]["completed"]=false;bf_quiz.quizes[l]["result_verb"]=$(d)[bfjs.read_attr]("rel:result_verb");bf_quiz.quizes[l]["result_subject"]=$(d)[bfjs.read_attr]("rel:result_subject");bf_quiz.quizes[l]["answer_positions"]=[];bf_quiz.quizes[l]["el"][bfjs.add_class](bf_quiz.quizes[l]["type"].replace(" ","_")+"_quiz");if(bf_quiz.isChecklist(bf_quiz.quizes[l]["type"])){bf_quiz.quizes[l].el[bfjs.selector](".show_results").first()[bfjs.observer]("click",function(m){$(m.target)[bfjs.up](".show_results_container").hide();bf_quiz.quiz_shares(bf_quiz.quizes[l]);bf_quiz.show_results(bf_quiz.quizes[l]);bf_quiz.quiz_complete(bf_quiz.quizes[l]);bfjs.universal_each(bf_quiz.quizes[l].questions[0].answers,function(o,n){if($(o)[bfjs.has_class]("selected")){return}bfjs.toggleClass(o,"deactivated",true)})})}bfjs.universal_each(g,function(p,t){var m=$(p)[bfjs.read_attr]("rel:id");var w=$(p)[bfjs.selector](".quiz_answer");var u=$(p)[bfjs.selector](".quiz_reveal");var o=$(p)[bfjs.read_attr]("rel:question_type");var s=bf_quiz.quizes[l]["questions"];s[t]={};s[t]["id"]=m;s[t]["el"]=$(p);s[t]["answers"]=w;s[t]["image"]=$(p)[bfjs.selector](".quiz_img").first();s[t]["reveal"]=u;s[t]["type"]=o;s[t]["response"]=null;s[t]["correct"]=null;s[t]["personality_index"]=null;var n=$(p)[bfjs.selector](".quiz_un_reveal");if(n.length>0){n.first()[bfjs.observer]("click",function(F){var z=$(s[t]["image"])[bfjs.read_attr]("rel:question_src");var D=$(s[t]["image"])[bfjs.read_attr]("rel:reveal_src");var y=$(s[t]["image"])[bfjs.read_attr]("src");var A=$(s[t]["image"])[bfjs.read_attr]("rel:attr");var C=$(s[t]["image"])[bfjs.read_attr]("rel:reveal_attr");var E=$(s[t]["image"])[bfjs.up]()[bfjs.selector](".buzz_attribution").first();var B="";if(D&&y==D){$(s[t]["image"])[bfjs.write_attr]("src",z);if(A){B=A}$(F.target)[bfjs.update_html]("Show new image")}else{if(D){if(C){B=C}$(s[t]["image"])[bfjs.write_attr]("src",D);$(F.target)[bfjs.update_html]("Show original image")}}if(E){E[bfjs.update_html](B)}})}bfjs.universal_each(w,function(z,y){var A=$(z);A[bfjs.observer]("mouseover",function(C){var B=C||window.event;if(!C.relatedTarget&&C.fromElement){C.relatedTarget=C.fromElement===C.target?C.toElement:C.fromElement}if((C.relatedTarget&&$(C.relatedTarget)[bfjs.up](".quiz_answer")==z)||z===s[t].response){return}if(z===s[t].response||(bf_quiz.isChecklist(bf_quiz.quizes[l].type)&&A[bfjs.has_class]("selected"))){return}bf_quiz.style(0,s[t],z)});A[bfjs.observer]("mouseout",function(C){var B=C||window.event;if(!C.target){C.target=C.srcElement||document}if(!C.relatedTarget&&C.fromElement){C.relatedTarget=C.fromElement===C.target?C.toElement:C.fromElement}if(bf_quiz.isChecklist(bf_quiz.quizes[l].type)&&A[bfjs.has_class]("selected")){return}if((C.relatedTarget&&$(C.relatedTarget)[bfjs.up](".quiz_answer")!=z)&&(C.target==z||$(C.target)[bfjs.up](".quiz_answer")==z)){bf_quiz.style(1,s[t],z)}});A[bfjs.observer]("click",function(B){if(B.target.nodeName.toLowerCase()=="a"&&$(B.target)[bfjs.up]()[bfjs.has_class]("sub_buzz_source_via")){return true}if(bf_quiz.isChecklist(bf_quiz.quizes[l].type)){return bf_quiz.toggleSelection(l,t,y)}bf_quiz.answered(l,t,y);bf_quiz.submit_quiz(bf_quiz.quizes[l])})})});bfjs.universal_each(h,function(m,n){var p=$(m)[bfjs.read_attr]("rel:range_start");var s=$(m)[bfjs.read_attr]("rel:range_end");var o=bf_quiz.quizes[l]["results"];o[n]={};o[n]["el"]=$(m);o[n]["range_start"]=p;o[n]["range_end"]=s})})};this.style=function(b,c,f){var e=(typeof window.jQuery!="undefined")?"parents":"up";var d=$(c.el)[e](".quiz")[bfjs.read_attr]("rel:quiz_type");if(bf_quiz.isChecklist(d)){if(b==2){bfjs.toggleClass(f,"selected",true)}else{if(b==1){bfjs.toggleClass(f,"selected")}}}if((b==2||b>=4)&&c.response&&f==bfjs.getFirstEl(c.response)){bfjs.toggleClass(f,"selected",true)}if(b==0){bfjs.toggleClass(f,"deactivated")}else{if(b==1){if(!bfjs.universal_compare_els($(c.response),$(f))){bfjs.toggleClass(f,"selected");bfjs.toggleClass(f,"def_answer");if((c.type=="text"||c.type=="image")&&c.correct!=null){bfjs.toggleClass(f,"deactivated",true)}else{bfjs.toggleClass(f,"deactivated")}}}else{if(b==2){$(f)[bfjs.add_class]("selected");bfjs.toggleClass(f,"deactivated")}else{if(b==4){$(f)[bfjs.add_class]("correct_answer");bfjs.toggleClass(f,"deactivated")}else{if(b==5){$(f)[bfjs.add_class]("wrong_answer");bfjs.toggleClass(f,"deactivated",true)}}}}}};this.toggleSelection=function(l,e,j){var d=bf_quiz.quizes[l];var g=d.questions[e];var h=g.answers;var k=g.answers[j];var c=$(h[j])[bfjs.read_attr]("rel:id");var f=g.id;var b=$(k)[bfjs.has_class]("selected")?1:2;bf_quiz.style(b,g,k);if(b==2){bf_quiz.gaTrack("[ttp]:content","quiz-answer",[f,c].join("="))}};this.answered=function(k,e,j){var d=bf_quiz.quizes[k];var g=d.questions[e];var h=g.answers;var c=$(h[j])[bfjs.read_attr]("rel:id");var f=g.id;var b=1;d.answer_positions[e]=j;g.response=$(h[j]);g.correct=$(g.response)[bfjs.read_attr]("rel:correct")=="1"?true:false;g.personality_index=$(g.response)[bfjs.read_attr]("rel:personality_index");bfjs.universal_each(h,function(l){b=l===bfjs.getFirstEl(g.response)?2:1;bf_quiz.style(b,g,l)});if(d.type=="single question"){bf_quiz.show_answers(g,d);bf_quiz.show_results(d)}else{if(d.type=="standard"){bf_quiz.show_answers(g,d)}}bf_quiz.gaTrack("[ttp]:content","quiz-answer",[f,c].join("="))};this.submit_quiz=function(d){if(bf_quiz.quiz_complete(d)&&!d.completed){if(d.type!="single question"){bf_quiz.quiz_shares(d)}bf_quiz.show_results(d);d.completed=true;var b=bf_quiz.get_completed_quiz_result(d);if(d.answer_positions.length==d.question_count){var e=d.answer_positions}if(bfjs.isMobile()){var c=$.Event("quiz_complete");c.answer_data=d.answer_positions;c.el=b.el;$(document).trigger(c)}else{EventManager.fire("quiz_complete",e,b.el)}if((Math.floor(Math.random()*10)+1>=6)||(document.location.search.match(/quizpixel/))){bf_quiz.save(d)}}};this.show_answers=function(b,d){var e=b.answers;var c=d?d.type:null;bf_quiz.disable_question(b);bfjs.universal_each(e,function(f){if(d.type=="single question"&&e.length<=1){return}if(c!="personality"){if($(f)[bfjs.read_attr]("rel:correct")=="1"){bf_quiz.style(4,b,f)}else{if(f===bfjs.getFirstEl(b.response)){bf_quiz.style(5,b,f)}}}});if(c=="single question"||c=="standard"){bf_quiz.reveal(b,d)}};this.save=function(c){if(typeof BF_Pixel=="undefined"){return false}var d={};d.quiz=c.id;if(bf_quiz.isChecklist(c.type)){c.el[bfjs.selector](".quiz_answer.selected").each(function(e){d[$(e)[bfjs.read_attr]("rel:id")]=1})}else{for(x in c.questions){var b=c.questions[x];d[b.id]=$(b.response)[bfjs.read_attr]("rel:id")}}BF_Pixel.save({dir:"quiz",params:d})};this.show_results=function(d){var e=d.swap;var g=d.questions;var h=d.results;var n=bf_quiz.get_completed_quiz_result(d);var c=n?$(n.el)[bfjs.selector](".answer_response").first():null;for(q in g){bf_quiz.disable_question(g[q])}if($(d.quiz_result_area_el)){$(d.quiz_result_area_el).show()}if(d.type=="personality"){if(n){$(d.el)[bfjs.selector](".quiz_tally_results").first().show();$(d.el)[bfjs.selector](".quiz_tally").first().hide();$(n.el).show();if(typeof window.BF_Effect!="undefined"){BF_Effect.ScrollIntoView($(n.el))}if(n){c.hide()}}}else{if(d.type=="single question"){if(d.questions[0].answers.length>1){var f=d.questions[0];var l=$(f.el)[bfjs.selector](".answer_response");var m=bf_quiz.correct_answer(f);var b=f.correct?"Correct! ":"Wrong! ";if(l.size()>0){$(l[0])[bfjs.add_class](f.correct?"correct":"wrong")[bfjs.selector](".message_text").first()[bfjs.update_html](b)}else{if(n){c.hide()}}}}else{if(bf_quiz.isChecklist(d.type)){var k=bf_quiz.get_message("checklist","tally",{"#{result_verb}":d.result_verb,"#{result_subject}":d.result_subject});k=local.t(k,{variables:{total:d.questions[0].answers.length,checked:bf_quiz.number_selected(d)}});var j=$(d.el)[bfjs.selector](".quiz_tally").first();$(j)[bfjs.update_html](k);$(d.el)[bfjs.selector](".quiz_tally_results").first().show();if(n){$(n.el).show();if(typeof window.BF_Effect!="undefined"){BF_Effect.ScrollIntoView($(n.el))}c.hide()}bf_quiz.save(d)}else{var k=bf_quiz.get_message("generic","tally",{"#{x}":bf_quiz.number_correct(d),"#{y}":d.question_count});var j=$(d.el)[bfjs.selector](".quiz_tally").first();$(j)[bfjs.update_html](k);$(d.el)[bfjs.selector](".quiz_tally_results").first().show();if(d.type=="percentage"){for(q in d.questions){bf_quiz.show_answers(d.questions[q],d)}}if(n){c.hide();$(n.el).show()}}}}};this.disable_question=function(b){var c=b.answers;for(a in c){if(typeof c[a]!="object"||!$(c[a])){continue}$(c[a])[bfjs.stop_observing]("mouseover");$(c[a])[bfjs.stop_observing]("mouseout");$(c[a])[bfjs.stop_observing]("click");bfjs.setStyle($(c[a]),{cursor:"default"})}};this.get_message=function(e,b,f){var d=bf_quiz.messages.generic[b];if(bf_quiz.messages.hasOwnProperty(e)&&bf_quiz.messages[e].hasOwnProperty(b)){d=bf_quiz.messages[e][b]}for(var c in f){if(!f.hasOwnProperty(c)){continue}d=d.replace(c,f[c])}return d};this.get_completed_quiz_result=function(g){var f=g.results;if(g.type=="personality"){var c=bf_quiz.personality(g);return f[c]}else{if(g.type=="single question"){return f[0]}else{if(bf_quiz.isChecklist(g.type)){var e=bf_quiz.percent_checked(g);for(var d in f){var b=f[d];if(e>=b.range_start&&e<=b.range_end){return b}}}else{var e=bf_quiz.percent_correct(g);for(d in f){var b=f[d];if(e>=b.range_start&&e<=b.range_end){return b}}}}}return false};this.reveal=function(b,g){var h,e,d;if(b.reveal){if(b.image&&b.image[bfjs.read_attr]("rel:reveal_src")){b.image[bfjs.write_attr]("rel:question_src",b.image[bfjs.read_attr]("src"));b.image[bfjs.write_attr]("src",b.image[bfjs.read_attr]("rel:reveal_src"));d=b.image[bfjs.read_attr]("rel:reveal_attr");if(d){h=b.image[bfjs.up]()[bfjs.selector](".buzz_attribution").first();if(h){e=bfjs.getFirstEl(h).innerText||bfjs.getFirstEl(h).textContent;if(e){b.image[bfjs.write_attr]("rel:attr",e.replace('"',"&quot;"))}h[bfjs.update_html](d)}}}if($(b.el)[bfjs.selector](".reveal_embed").length>0){$(b.el)[bfjs.selector](".reveal_embed").first().show();$(b.el)[bfjs.selector](".question_embed").first().hide()}bfjs.universal_each(b.reveal,function(k){$(k).show()})}if(g.type!="single question"||(g.type=="single question"&&b.answers.length>1)){var j=$(b.el)[bfjs.selector](".answer_response");var c=bf_quiz.correct_answer(b);var f=b.correct?local.t("Correct!"):local.t("Wrong!");if(j.size()>0){$(j[0])[bfjs.add_class](b.correct?"correct":"wrong")[bfjs.selector](".message_text").first()[bfjs.update_html](f)}}};this.correct_answer=function(b){bfjs.universal_each(b.answers,function(c){if($(c)[bfjs.read_attr]("rel:correct")=="1"){return $(c)}});return null};this.personality=function(g){var c=0;var e=[];for(f in g.results){e[f]=0}for(f in g.questions){var d=g.questions[f];e[d.personality_index]++;c++}var b=0;var h=0;for(var f=e.length-1;f>=0;f--){if(e[f]>b){b=e[f];h=f}}return h};this.percent_checked=function(d){var c=bf_quiz.number_selected(d);var b=d.questions[0].answers.length;return Math.round((c/b)*100)};this.percent_correct=function(d){var b=0;var e=0;for(i in d.questions){var c=d.questions[i];b++;if(c.correct==true){e++}}return Math.round((e/b)*100)};this.number_selected=function(b){return b.el[bfjs.selector](".quiz_answer.selected").length};this.number_correct=function(c){var d=0;for(i in c.questions){var b=c.questions[i];if(b.correct==true){d++}}return d};this.quiz_complete=function(d){var c;if(!bf_quiz.isChecklist(d.type)){for(i in d.questions){var b=d.questions[i];if(b.correct==null){return false}}}c=bf_quiz.get_end_label(d);bf_quiz.gaTrack("[ttp]:content","quiz-complete",c);if(bfjs.isMobile()){$(".answer_shares_buttons a").each(function(){$(this).attr("data-label",c)})}return true};this.get_end_label=function(d){var c="";if(d.type=="personality"){var b=bf_quiz.get_completed_quiz_result(d);c=d.id+"="+($(b.el)[bfjs.read_attr]("rel:id")||$(b.el)[bfjs.read_attr]("data-id"))}else{if(bf_quiz.isChecklist(d.type)){c=bf_quiz.number_selected(d)+" out "+d.questions[0].answers.length}else{c=bf_quiz.number_correct(d)+" out "+d.question_count}}return c};this.isChecklist=function(b){var c=["checklist","image checklist"];return c.indexOf(b)>-1};this.quiz_shares=function(f){try{var b=bf_quiz.get_completed_quiz_result(f),d;if(typeof ad_tw_hashtags!="undefined"){d=ad_tw_hashtags}else{d=""}var c={el:$(f.el)[bfjs.selector](".answer_shares .answer_shares_buttons").first(),buzz_uri:window.location,buzz_name:(bfjs.isMobile()?$("<div/>").html(BF_STATIC.buzz_name).text():BF_UI.renderEntities(BF_STATIC.buzz_name)),buzz_blurb:(bfjs.isMobile()?$("<div/>").html(BF_STATIC.buzz_blurb).text():BF_UI.renderEntities(BF_STATIC.buzz_blurb)),picture:b&&$(b.el)[bfjs.selector](".result_img").size()>0?$(b.el)[bfjs.selector](".result_img")[0].src:"",result_description:b&&b.el?$(b.el)[bfjs.read_attr]("rel:description"):"",fb_title:"",fb_blurb:"",tw_blurb:"",tw_hashtags:d,tw_via:$(f.el)[bfjs.selector](".quiz_tally_results").first()[bfjs.read_attr]("rel:tweet_via")||"BuzzFeed",email_subject:"",email_body:""};var g={"#{title}":c.buzz_name,"#{link}":c.buzz_uri,"#{result_verb}":f.result_verb,"#{result_subject}":f.result_subject};if(f.type=="personality"&&!bf_quiz.post_rec){g["#{result}"]=$(b.el)[bfjs.read_attr]("rel:name");c.fb_title=bf_quiz.get_message("personality","fb",g);c.fb_blurb=c.result_description?c.result_description:c.buzz_blurb;c.tw_blurb=bf_quiz.get_message("personality","tw",g);c.email_subject=bf_quiz.get_message("personality","email_subject",g);if(!unescape(c.email_subject).match("Quiz:")){c.email_subject="Quiz: "+c.email_subject}c.email_body=bf_quiz.get_message("personality","email_body",g)}else{if(f.type=="personality"&&bf_quiz.post_rec){console.log(c);g["#{result}"]=$(b.el)[bfjs.read_attr]("rel:name");c.fb_title=c.buzz_name;c.fb_blurb=c.buzz_name;c.tw_blurb=c.buzz_name;c.email_subject=c.buzz_name;if(!unescape(c.email_subject).match("Quiz:")){c.email_subject="Quiz: "+c.email_subject}c.email_body=c.buzz_name+"  "+c.buzz_uri.href}else{if(bf_quiz.isChecklist(f.type)){g["#{checked}"]=bf_quiz.number_selected(f);g["#{total}"]=f.questions[0].answers.length;c.fb_title=bf_quiz.get_message("checklist","fb",g);c.fb_blurb=c.result_description||c.buzz_blurb;c.tw_blurb=bf_quiz.get_message("checklist","tw",g);c.email_subject=bf_quiz.get_message("checklist","email_subject",g);if(!unescape(c.email_subject).match("Quiz:")){c.email_subject="Quiz: "+c.email_subject}c.email_body=bf_quiz.get_message("checklist","email_body",g)}else{g["#{score}"]=bf_quiz.number_correct(f);g["#{total}"]=f.question_count;c.fb_title=c.buzz_name;c.fb_blurb=bf_quiz.get_message("generic","fb",g);c.tw_blurb=bf_quiz.get_message("generic","tw",g);c.email_subject=bf_quiz.get_message("generic","email_subject",g);if(!unescape(c.email_subject).match("Quiz:")){c.email_subject="Quiz: "+c.email_subject}c.email_body=bf_quiz.get_message("generic","email_body",g)}}}if(BF_STATIC.campaignid=="1931201"){var h="Remember to eat your cereal, not your serial killers.";c.fb_blurb=h;c.tw_blurb=c.buzz_name+" "+h;c.tw_hashtags="ripperstreet";c.email_subject=bf_quiz.get_message("generic","email_subject",{"#{title}":c.buzz_name});c.email_body=h+" "+escape(c.buzz_uri)}$(c.el).show();if(bfjs.isMobile()){$(document.body)[bfjs.selector](".share-buttons.position-lower")[bfjs.add_class]("hidden");$(document.body)[bfjs.selector](".share-buttons.position-quiz .email-btn a")[bfjs.write_attr]("href","mailto:?subject="+c.email_subject+"&body="+c.buzz_uri);if(BF_STATIC.mobile_app==false){$(document.body)[bfjs.selector](".share-buttons.position-quiz .tweet_btn a")[bfjs.write_attr]("href","https://twitter.com/intent/tweet?url="+c.buzz_uri+"&text="+c.tw_blurb+"&via="+c.tw_via);$(document.body)[bfjs.selector](".share-buttons.position-quiz .fb-share-dialog a")[bfjs.observer]("click",function(j){if(typeof FB!="undefined"){if(hasLocalStorage()){sessionStorage.setItem("offset",window.scrollY)}window.scrollTo(0,0);FB.ui({method:"feed",link:c.buzz_uri.toString(),display:"touch",picture:c.picture,name:unescape(c.fb_title),description:unescape(c.fb_blurb)},function(k){if(hasLocalStorage()){window.scrollTo(0,sessionStorage.getItem("offset"))}})}j.preventDefault()})}}else{if(true){bf_shares.fb_share({words:"Share",el:c.el,wrapper:true,uri:c.buzz_uri,picture:c.picture,title:c.fb_title,description:c.fb_blurb,color:"square",tracking_action:"share/facebook",tracking_label:bf_quiz.get_end_label(f)});bf_shares.tw_tweet({el:c.el,wrapper:true,uri:c.buzz_uri,description:c.tw_blurb,hashtags:c.tw_hashtags,color:"square",via:c.tw_via,tracking_action:"share/twitter/tweet",tracking_label:bf_quiz.get_end_label(f)});bf_shares.email_link({el:c.el,wrapper:true,subject:c.email_subject,body:c.email_body,color:"square",tracking_action:"share/email",tracking_label:bf_quiz.get_end_label(f)})}else{sharing.buttons.facebook_share({parentNode:c.el,url:c.buzz_uri,blurb:c.fb_blurb,picture:c.picture,title:c.fb_title,gt_label:bf_quiz.get_end_label(f)});sharing.buttons.twitter({parentNode:c.el,url:c.buzz_uri,blurb:c.tw_blurb,hashtags:c.tw_hashtags,via:c.tw_via,gt_label:bf_quiz.get_end_label(f)});sharing.buttons.email({method:"mailto",parentNode:c.el,subject:c.email_subject,body:c.email_body,gt_label:bf_quiz.get_end_label(f)})}}}catch(e){console.error(e)}};this.gaTrack=function(b,c,d){if(typeof gtrack!="undefined"){gtrack.track_events(b,c,d)}}};var bf_quiz=new BF_Quiz();bfjs.onPageLoad(bf_quiz.init);BF_Related=function(){this.related_links_controller="/buzzfeed/_related_links";this.init=function(){if(!acl.user_can("general_admin")){return}related.assign_handlers()};this.assign_handlers=function(){universal_dom.assign_handler({bucket:"update-related",handler:related.update_related,event:"click"});universal_dom.assign_handler({bucket:"related-cancel",handler:related.related_cancel,event:"click"});universal_dom.assign_handler({bucket:"related-save",handler:related.save_related,event:"click"})};this.update_related=function(args){if(args.buzz_id){var dialog=$$(".update_related")[0];var dialogWidth=dialog.getWidth();var dialogHeight=dialog.getHeight();var topPos=args.clientY;related.show_body_overlay();dialog.show();if((topPos+dialogHeight)>BF_UTIL.browser.dimensions.height()){topPos=BF_UTIL.browser.dimensions.height()-dialogHeight}dialog.setStyle({left:args.clientX+"px",top:topPos+"px",position:"fixed"})}else{console.log("update_related: Invalid buzz id")}};this.related_cancel=function(){if($("bodyOverlay")){document.body.removeChild($("bodyOverlay"))}$("save_spinner").hide();var dialog=$$(".update_related")[0];dialog.hide()};this.show_body_overlay=function(){var bodyHeight=document.body.getHeight();var bodyWidth=document.body.getWidth();if(!$("bodyOverlay")){var overlay=document.createElement("div");overlay.setAttribute("id","bodyOverlay");overlay.setStyle({width:bodyWidth+"px",height:bodyHeight+"px"});document.body.appendChild(overlay)}};this.save_related=function(args){if(args.buzz_id){$("save_spinner").show();var newRelated=new Array();var related_input=$$(".related_input");for(var i=related_input.length;i>=1;i--){var input_value=$("related"+i).value;if(input_value&&input_value!=""){newRelated.push(input_value)}}var params={action:"validate_and_save",campaignid:args.buzz_id,related_urls:JSON.stringify(newRelated)};(new BF_Request()).request("/buzzfeed/_related_links",{method:"get",parameters:params,onSuccess:function(r){var obj=eval("("+r.responseText+")");console.log(obj.number);if(obj.success==0){related.error(obj.message)}else{if(obj.number==0){related.error("No urls could be validated. Must be buzzfeed.com links.")}else{if(newRelated.length>obj.number){related.error("Only "+newRelated.length+" out of "+obj.number+" urls could be validated.")}}}related.related_cancel()},onFailure:function(r){var obj=eval("("+r.responseText+")");related.error(obj.message||"save_related: validate and save failure")}})}else{console.log("save_related: Invalid buzz id")}};this.error=function(message){console.log("related.error");(new BF_Request()).alert(message)}};var related=new BF_Related();BuzzLoader.register(function(){related.init()},2);var BF_user_page=function(){this.init=function(){user_page.resize_embeds()};this.resize_embeds=function(){if(BF_STATIC.tt_page=="User"){$$(".buzz_superlist_item_embed").each(function(d){var c=d.select("iframe")[0];if(c){var e=c.getAttribute("height");var f=c.getAttribute("width");if(f>625){c.setAttribute("width",625);var b=(625/f);e=Math.floor(e*b);c.setAttribute("height",e)}}})}}};var user_page=new BF_user_page();BuzzLoader.register(user_page.init,5);var BF_bpage=function(){this.lastScrollPos=0;this.more_loaded=false;this.init=function(){if(typeof buzz_profile!="undefined"&&buzz_profile.graphic_image){$$(".graphic_image_wrapper").each(function(k){bpage.set_box_blur(k)})}universal_dom.assign_handler({bucket:"bpage_tweet",event:"click",handler:bpage.tweet});universal_dom.assign_handler({bucket:"more_shares",event:"mouseover",handler:bpage.load_more_shares});universal_dom.assign_handler({bucket:"share_link",event:"click",handler:bpage.copy_link});universal_dom.assign_handler({bucket:"pinterest",event:"click",handler:bpage.pinterest});universal_dom.assign_handler({bucket:"sticky_popup_button",event:"click",handler:bpage.hide_other_popups});universal_dom.assign_handler({bucket:"print_btn",event:"click",handler:bpage.show_popup});universal_dom.assign_handler({bucket:"toggleBreakingSummary",event:"click",handler:bpage.toggleBreakingSummary});bpage.update_bottom_shares();bpage.dedupe_buzz();bpage.update_upper_shares();bpage.arrange_badges();bpage.loadSummary();var h=abtest.abVariations.split(",");if(h.indexOf("promo_var_1")!=-1){console.log(h.indexOf("promo_var_1"))}if(h.indexOf("promo_var_1")!=-1){if($("bpage-bottom-dfp")){$("bpage-bottom-dfp").removeClassName("bpage-lower-dfp");var d=$("bpage-bottom-dfp").select(".bf-image-big")[0];d.width=125;d.height=83}}var c=abtest.abVariations.split(","),f=["sharing_vertical","sharing_ref"],j,g;bpage.show_dfp(c);if(c.intersect(f)[0]!=undefined){var b=c.intersect(f)[0];if(b=="sharing_ref"){$(b).select(".share_div").each(function(k){if(!k.hasClassName("hidden")){j=k.select("#link_parent")[0];g=k.select(".link_bottom")[0]}})}else{if(b=="sharing_vertical"){j=$(b).select("#link_parent")[0];g=$(b).select(".link_bottom")[0]}}}if(c.indexOf("related_two")!=-1){bpage.related_img_reset()}if(c.indexOf("related_two")!=-1){var e=$("related_two").select(".subbuzzpromo li")[3];if(e){e.removeClassName("hidden")}}if(isIE8()){bpage.set_quote_style()}EventManager.observe("badge_vote:vote_init",function(k){bpage.custom_badge_vote(k)});Event.observe(window,"scroll",function(l){var k=$$(".PageFooter")[0].viewportOffset().top+100;if((k<document.viewport.getHeight())&&!bpage.more_loaded){bpage._more_stuff_init()}});bpage.hide_indepth_buzz();bpage.load_hot_on_pinterest()};this.show_popup=function(){window.print()};this.referrer=function(b){var b=document.referrer;if(b.match("pinterest")){return"pinterest"}else{if(b.match("t.co")){return"tweet"}else{return null}}};this.update_bottom_shares=function(){var f=$$(".bottom_shares").first();var d=$$(".bottom_shares .referrer_shares .shareBtn");var b=$$(".bottom_shares .vertical_shares .shareBtn");var l=$$(".bottom_shares .other_shares .shareBtn");var e=$$(".bottom_shares #more_shares_box .shareBtn");var g=bpage.referrer();var j=(g)?g+"_share":null;var c=objExists(BF_STATIC.vertical)?BF_STATIC.vertical:"";var k=$("buzz_sub_buzz")&&$("buzz_sub_buzz").hasClassName("suplist_long")?true:false;var h=[];if(!d||!b||!f){return false}if(f.hasClassName("hidden")){f.removeClassName("hidden")}d.each(function(n){var o=$(n).findParent("div"),m=null;if(o){if(g){m=j}else{m="fb_share"}$(o).hasClassName(m)?h.push(m):$(o).remove()}});b.each(function(n){var o=$(n).findParent("div"),m=null;if(o){if(j=="pinterest_share"||j=="tweet_share"){m="fb_share"}else{m="tweet_share"}$(o).hasClassName(m)?h.push(m):$(o).remove()}});l.each(function(m){var n=$(m).findParent("div");if(n&&j){if($(n).hasClassName(j)){$(n).remove()}}});bpage.remove_dupe_shares(e,h)};this.remove_dupe_shares=function(b,c){c.each(function(d){b.each(function(g){var f=$(g).findParent("div");if($(f).hasClassName(d)){$(f).remove()}})})};this.copy_link=function(j){var d=j.element;if(!d){return false}if($("shares-copy-link").visible()){$("shares-copy-link").hide();if(typeof bf_rdio!="undefined"){bf_rdio.enable()}return false}var h=$(d).getAttribute("rel:link");var c={left:Number($(d).positionedOffset()[0]),top:Number($(d).positionedOffset()[1]),height:Number($(d).getHeight()),width:Number($(d).getWidth())};var f={width:300};var g={height:10,width:10};var b=$$("#shares-copy-link .arrow");$(d).insert({after:$("shares-copy-link")});$("shares-copy-link").setStyle({left:(c.left-(f.width/2))+"px",top:(c.top+c.height+(g.height/2))+"px"});b.each(function(e,k){$(e).setStyle({left:(175-g.width+k)+"px",top:(k-g.height)+"px"})});$$("#shares-copy-link input")[0].setAttribute("value",h);$("shares-copy-link").show();Selector.findChildElements($("shares-copy-link"),["input"])[0].select();if(typeof bf_rdio!="undefined"){bf_rdio.disable()}};this.dedupe_buzz=function(){var d=$$('meta[property="bf:buzzid"]'),b=d.length?d[0].readAttribute("content"):null;if(b){$$(".sidebar_featured_unit .small-posts").each(function(e){if($(e).hasAttribute("rel:buzz_id")){if($(e).getAttribute("rel:buzz_id")==b){$(e).remove()}}});if($("next_on_1")){if($("next_on_1").hasAttribute("rel:buzz_id")){var c=$("next_on_1").readAttribute("rel:buzz_id");if(b==c){if($("next_on_1")){$("next_on_1").hide()}if($("next_on_2")){$("next_on_2").show()}}}}}};this.update_upper_shares=function(){var c=bpage.referrer(),b=$("pin_ref"),d=$("share_control");if(!b||!d){return}if(c=="pinterest"){b.removeClassName("hidden");d.addClassName("hidden")}else{if(!b.hasClassName("hidden")){b.addClassName("hidden")}if(d.hasClassName("hidden")){d.removeClassName("hidden")}}};this.tweet=function(f){data=f.target;var c=f.target.getAttribute("rel:tw_url");var g=escape(f.target.getAttribute("rel:tw_text"));var b=f.target.getAttribute("rel:tw_via");var d="http://twitter.com/intent/tweet?url="+c+"&text="+g+"&via="+b;window.open(d,"_blank","width=600, height=300")};this.pinterest=function(){var u=function(z,A){var y=200;var B=200;var e="";if(z>A){y=z/(A/200);e="margin-left: "+(0-(y-200)/2)+"px"}else{if(z<A){B=A/(z/200);e="margin-top: "+(0-(B-200)/2)+"px"}}return{img_width:y,img_height:B,img_style:e}};var p=function(){var e=document.createElement("SPAN");e.addClassName("pin_image");e.innerHTML='<span class="loading_pin_image"></span>';return e};var g=function(y){var e=0,z=0;if(isIE7()||isIE8()){e=y.width;z=y.height}else{e=y.naturalWidth;z=y.naturalHeight}return{w:e,h:z}};var d=function(F,B,H,w,E,z,G,C,e,y,A){var D=new Template($("pin_img_template").innerHTML);return D.evaluate({img_style:F,img_src:B,img_width:H,img_height:w,img_n_width:E,img_n_height:z,ieheight:G,scroll_pos:C,url:e,media:y,desc:A})};bpage.lastScrollPos=$(document.viewport).getScrollOffsets().top;window.scrollTo(0,0);var n=BF_UTIL.browser.dimensions.height();$("pin_bg").setStyle({height:n+"px"});$("pin_bd").setStyle({height:n+"px"});document.body.appendChild($("pin_bg").show());document.body.appendChild($("pin_bd").show());var f=BF_STATIC.page="Video"&&typeof video_buzz!="undefined"?video_buzz:$("post-"+BF_STATIC.campaignid).readAttribute("rel:data").evalJSON();var h="http://www.buzzfeed.com/"+BF_STATIC.username+"/"+f.uri;if($("pin_img_container").innerHTML){$("pin_img_container").innerHTML=""}var t=Prototype.Browser.IE?636:336;var j=$("post-title")?$("post-title").innerHTML.replaceAll("&nbsp;"," ").unescapeHTML().stripTags().trim():"";var m=function(e,y,w){e.remove()};var c=function(){if($("pin_bg")){$("pin_bg").hide()}if($("pin_bd")){$("pin_bd").hide()}};var o=function(e,C,y,B){var D=g(this);var z=u(D.w,D.h);var F=z.img_width,w=z.img_height,E=z.img_style;var A=d(E,C,F,w,D.w,D.h,t,bpage.lastScrollPos,y,C,B);e.innerHTML=A.replaceAll("&lt;","<").replaceAll("&gt;",">");e.select("a")[0].observe("click",c)};var k=$$(".buzz_superlist_item_image, .buzz_superlist_item_grid_row, .buzz_superlist_item_video.video_instagram");if(k.length&&BF_STATIC.page!="Video"){k.each(function(y){var e;var z=y.id;if(z){e=z.split("superlist_")[1];y=y.select("img")}var w=encodeURIComponent(h+(e?"?sub="+e:""));y.each(function(C){var D="";var B=p();$("pin_img_container").appendChild(B);var A=new Image();A.onload=function(){var F=z?C.readAttribute("rel:bf_image_src"):$$('link[rel="image_src"]')[0].href;if(C.up(".buzz_superlist_item").select("h2").length){var E=Element.clone(C.up(".buzz_superlist_item").select("h2")[0],true);if(E.select("span.buzz_superlist_number_inline").length){E.select("span.buzz_superlist_number_inline")[0].remove()}D=E.innerHTML.stripTags().unescapeHTML().trim()}if(j){D=D?D+" | "+j:j}D=encodeURIComponent(D);o.apply(this,[B,F,w,D])};A.onabort=m.bind(null,B,l,1);A.onerror=m.bind(null,B,l,2);if(C.readAttribute("rel:bf_image_src")){A.src=C.readAttribute("rel:bf_image_src")}else{A.src=C.src}})})}else{var l=BF_STATIC.big_image_root+"/static/images/global/buzzfeed-logo.png";if($$('meta[property="og:image"]').length>0){l=$$('meta[property="og:image"]')[0].attributes.content.value}var b=p();$("pin_img_container").appendChild(b);var s=new Image();s.onload=function(){o.apply(this,[b,l,encodeURIComponent(h),encodeURIComponent(j)])};s.onabort=m.bind(null,b,l,1);s.onerror=m.bind(null,b,l,2);s.src=l}};this.related_img_reset=function(){var e=$$(".related_var_2 .subbuzzpromo li.wide")[0];var c=e.select("img")[0];var d=c.getAttribute("src");var b=d.replace("_wide.jpg",".jpg");c.setAttribute("src",b)};this.show_dfp=function(c){var d=["related_control","related_one","related_two"];var b=c.intersect(d)[0];if(b=="related_two"){if($("related_one")){$("related_one").select(".related_dfp")[0].remove()}}else{if(b=="related_one"){if($("related_two")){$("related_two").select(".related_dfp")[0].remove()}}}};this.load_more_shares=function(m){var k,j,f,l,c=m.element,d=function(s){try{if(s){return s.className.match("arrow")}}catch(t){console.warn(t);return false}},h=function(s){try{if(s){return s===o||s.ancestors().indexOf(o)>=0}}catch(t){console.warn(t);return false}},n=function(s){try{if(s){return s===k||s.firstChild===k||s.ancestors().indexOf(k)>=0}}catch(t){console.warn(t);return false}};if(!c){return false}bpage.hide_all_popups();var o=$("more_shares_box");c.insert({after:o});var o=$("more_shares_box");var g={width:Number(o.getWidth())};var b={left:Number($(c).positionedOffset()[0]),top:Number($(c).positionedOffset()[1]),height:Number($(c).getHeight()),width:Number($(c).getWidth())};var p=o.select(".arrow");o.setStyle({left:(b.left-(g.width/2)+(b.width/2))+"px",top:(b.top+b.height)+"px"});p.each(function(e,s){$(e).setStyle({left:((g.width/2)-10+s)+"px",top:(s-10)+"px"})});o.show();if(typeof bf_rdio!="undefined"){bf_rdio.disable()}j=$(c).on("mouseout",function(t){var s=t.toElement?t.toElement:t.relatedTarget;if(d(s)||h(s)){return}j.stop();o.hide();if(typeof bf_rdio!="undefined"){bf_rdio.enable()}});f=$(o).on("mouseout",function(t){var s=t.toElement?t.toElement:t.relatedTarget;k=$$(".gc-bubbleDefault").first();if(d(s)||h(s)){return}if(k){if(!l){l=$(k).on("mouseout",function(w){var u=w.toElement?w.toElement:w.relatedTarget;if(h(u)||n(u)){return}l.stop();o.hide();if(typeof bf_rdio!="undefined"){bf_rdio.enable()}})}if(n(s)){return}}f.stop();o.hide();if(typeof bf_rdio!="undefined"){bf_rdio.enable()}})};this.arrange_badges=function(){var c=$$(".wrap_badge");if(!c.length){return}c.each(function(g){if(g.hasClassName("disapprove")){var h=c.indexOf(g);c.splice(h,1);c.unshift(g);if(c.length>10){var f=c.length-10}}});var e=55;for(var d=0;d<=c.length;d++){if(c[d]){var b=getWidth(c[d].select("img")[0]);if(b>50){e=b+5}if(d!=0){c[d].setStyle({left:e+"px"});e+=55}}}};this.hide_other_popups=function(d){var c=d.element,b=$$(".sticky-popup"),f=c.nextSiblings(".sticky-popup")[0];if(c.getAttribute("rel:gt_act")!=="share/email"){shareEmail.current_button=null}b.each(function(e){if(e!==f){e.setStyle({display:"none"})}})};this.hide_all_popups=function(){shareEmail.current_button=null;$$(".sticky-popup").each(function(b){if(b.getStyle("display")==="block"){b.hide()}});if(typeof bf_rdio!="undefined"){bf_rdio.enable()}};this.set_quote_style=function(){$$(".buzz_superlist_item_quote").each(function(b){var c=new Element("span",{"class":"ie-quote-before"});var d=new Element("span",{"class":"ie-quote-after"});b.select("blockquote p")[0].insert({before:c});b.select("blockquote p")[(b.select("blockquote p").length-1)].insert(d);if(b.select("blockquote p").length>=2){b.addClassName("long-quote")}if(b.select("blockquote p").length<=1){b.addClassName("short-quote")}})};this.set_box_blur=function(c){var h=c.getOffsetParent(),g=h.select(".graphic_image_warning")[0],e=c.select("img.graphic_image")[0],k=h.select(".click_to_blur")[0],b=((Prototype.Browser.WebKit&&!isSafari5())||isIE8()||isIE9()),d=(Prototype.Browser.Gecko&&!isIE11()),j=isIE11(),f="";if(j){g.style.top=(e.getAttribute("height")/2*-1)+"px";e.remove();e=c.select("svg")[0];e.style.display=""}if(h.hasClassName("rubbable-container")){h.select(".animatedgifs")[0].addClassName("hidden")}if(BF_STATIC.bf_env=="dev"||BF_STATIC.bf_env=="live"){f=BF_STATIC.image_root+"/static/images/public/quickpost/blur.svg#blur30"}else{if(BF_STATIC.bf_env=="stage"){f="http://stage.buzzfeed.com/static/images/public/quickpost/blur.svg#blur30"}}if(b){e.addClassName("graphic_image")}else{if(d){e.setAttribute("style","filter:url("+f+");")}else{h.select(".image_block")[0].removeClassName("hidden")}}if(!isIE11()){e.addClassName("box_blur")}c.observe("click",function(){if(b){e.removeClassName("graphic_image")}else{if(d){e.setAttribute("style","")}else{if(j){$$("#"+e.id+" image")[0].style.filter=""}else{h.select(".image_block")[0].addClassName("hidden")}}}g.addClassName("hidden");k.removeClassName("hidden");if(h.hasClassName("rubbable-container")){var l=h.select("iframe");if(l.length){e.addClassName("hidden");l[0].removeClassName("hidden")}h.select(".animatedgifs")[0].removeClassName("hidden")}h.addClassName("no_blur")});k.observe("click",function(){if(b){e.addClassName("graphic_image")}else{if(d){e.setAttribute("style","filter:url("+f+");")}else{if(j){$$("#"+e.id+" image")[0].style.filter="url(#blur-effect-"+e.id.replace("svg-image-blur-","")+")"}else{h.select(".image_block")[0].removeClassName("hidden")}}}g.removeClassName("hidden");k.addClassName("hidden");if(h.hasClassName("rubbable-container")){var l=h.select("iframe");if(l.length){e.removeClassName("hidden");l[0].addClassName("hidden")}h.select(".animatedgifs")[0].addClassName("hidden")}h.removeClassName("no_blur")})};this.custom_badge_vote=function(b){if(b){b=b.toLowerCase();if(b=="kaching"){BFAudio.player("/sounds/kaching.mp3")}}};this._more_stuff_init=function(){var c=$$(".Content")[0].getHeight()+200,b=$$(".Column2")[0].getHeight();if(c>=b&&$("lower-more-content")){bpage._more_stuff_request()}};this._more_stuff_request=function(){bpage.more_loaded=true;var c=$("lower-more-content"),f=c.getAttribute("rel:plugin_version"),b,e=new BF_Request(),d=parseInt((Math.random()*10)+1);var g="";if(typeof BFW_Util=="object"&&(BFW_Util.getCookie("country")=="uk"||BFW_Util.getCookie("country")=="au")){g="/country:"+BFW_Util.getCookie("country")}b=BF_STATIC.web_root+"/plugin/infinitesidebar/v:"+f+g+"/p:"+d;if(BF_STATIC.bf_env=="dev"&&BF_STATIC.bf_test_mode==true){b=BF_STATIC.web_root+"/plugin/infinitesidebar/v:"+f+"/p:3"}e.request(b,{onSuccess:function(h){if(h.responseText){bpage.load_more_stuff(h.responseText)}},onFailure:function(h){console.error(h)}})};this.load_more_stuff=function(b){if($("lower-more-content")){$("lower-more-content").insert(b);$$("#lower-more-content .post img.thumb").each(function(d,c){d.src=d.getAttribute("rel:bf_image_src")})}};this.toggleBreakingSummary=function(d){var c=$("breaking_news_summary_content"),b=$("toggleBreakingSummary"),d=typeof d!="boolean"?(c.hasClassName("hidden")?true:false):d;if(c&&b){if(d){if(c.hasClassName("hidden")){c.removeClassName("hidden")}b.innerHTML="Hide summary"}else{if(!c.hasClassName("hidden")){c.addClassName("hidden")}b.innerHTML="Show summary";BF_Effect.ScrollIntoView(b,0)}}if(BF_STATIC.campaignid){$.jStorage.set(BF_STATIC.campaignid+"_summary",d)}};this.loadSummary=function(){if(BF_STATIC.campaignid){if($.jStorage.get(BF_STATIC.campaignid+"_summary")==false){bpage.toggleBreakingSummary(false)}}};this.hide_indepth_buzz=function(){var c=BF_STATIC&&BF_STATIC.campaignid?BF_STATIC.campaignid:null,b=universal_dom&&universal_dom._bucket&&universal_dom._bucket.indepth_buzz?universal_dom._bucket.indepth_buzz.elements:[];if(!c||!b.length){return}b.each(function(d){if(d.data&&d.data.indepth_buzz_id&&d.data.indepth_buzz_id==c){d.element.addClassName("hidden")}})};this.load_hot_on_pinterest=function(){var b=$("hotOnPinterestWrap");widget_loaded=false;if(b&&("bf_pinterest_referer" in window)&&!isMSIE()){e()}function e(){var f=["diy","food"],g=(bf_pinterest_referer&&bf_pinterest_referer.COOKIE)?readCookie(bf_pinterest_referer.COOKIE):null;if((BF_STATIC.tt_page=="Buzz"&&BF_STATIC.vertical&&f.indexOf(BF_STATIC.vertical.toLowerCase())!="-1")||(document.referrer||"").match(/pinterest.com/)||(location.search||"").match(/\?referer=pinterest.com/)||(document.referrer||"").match(/blog.pinterest.com/)||(location.search||"").match(/\?referer=blog.pinterest.com/)||g){d();Event.observe(window,"scroll",function(){d()})}}function d(){if(!widget_loaded&&((b.viewportOffset().top+100)<document.viewport.getHeight())){widget_loaded=true;c();EventManager.fire("load_hot_on_pinterest")}}function c(){var g=BF_STATIC.vertical?BF_STATIC.vertical.toLowerCase():null,f=BF_STATIC.web_root+"/plugin/pinterestunit/v:1.2"+(g?"/vt:"+g:"")+"/p:1",h=new BF_Request();b.update('<div class="hot-on-pinterest-loader"></div>');h.request(f,{onSuccess:function(k){if(!k||!k.responseText){return}b.update(k.responseText);universal_dom.update(b);if(typeof(bf_prog_load)!="undefined"){var j=b.select("ul li img");if(j.length){j.each(function(l){if(l.readAttribute("rel:bf_image_src")){bf_prog_load.load_image(l,l.readAttribute("rel:bf_image_src"))}})}}},onFailure:function(j){console.error(j)}})}}};document.observe("dom:loaded",function(){if($("buzz_sub_buzz")&&($("buzz_sub_buzz").hasClassName("suplist_long")||$("buzz_sub_buzz").hasClassName("suplist_article"))){var b=new BF_InlineSharing();b.init();var c=new BF_ReadLater();c.init()}});$(document).observe("click",function(c){if(typeof(c.target)=="undefined"||!isHTMLElement(c.target)){return}var b=false,d=c.toElement?c.toElement:(c.relatedTarget||c.target),f=function(h){var k=$(h).getAttribute("rel:bf_bucket");var l=$(h).getAttribute("rel:bf_bucket_data");var g=$(h).hasClassName("sticky-popup");var e=(k&&k.match("sticky_popup_button")!==null);var j=(l&&l.match("email-share")!==null);return g||e||j};if(!d||f(d)){return}d.ancestors().each(function(e){if(!b){b=f(e)}});if(b){return}bpage.hide_all_popups()});$(document).observe("keyup",function(b){if(b.keyCode==Event.KEY_ESC){bpage.hide_all_popups()}});var bpage=new BF_bpage();BuzzLoader.register(bpage.init,1);BF_Queue=function(){var active_buzz;var active_promotion;var active_splash_page;var active_area_id;var active_area_name;var active_queue_id;var listObj={};this.draggableLists=["queue_list"];this.controller="/buzzfeed/queue";this.splash_controller="/buzzfeed/splash_queue";this.bigstory_controller="/buzzfeed/bigstory_queue";this.init=function(){queue.make_drag_lists(queue.draggableLists);if(queue.init_params()){queue.assign_handlers();queue.override_post_tools();queue.init_tabs();ukBackground()}};this.assign_handlers=function(){this.global_queue_handlers();this.splash_queue_handlers();universal_dom.assign_handler({bucket:"inline-edit",handler:queue.inline_edit,event:"click"});universal_dom.assign_handler({bucket:"update-queue-time",handler:queue.update_queue_time,event:"click"});universal_dom.assign_handler({bucket:"delete-from-queue",handler:queue.delete_from_queue,event:"click"});universal_dom.assign_handler({bucket:"delete-cancel",handler:queue.delete_cancel,event:"click"});universal_dom.assign_handler({bucket:"show-queue-types",handler:queue.show_queue_types,event:"click"});universal_dom.assign_handler({bucket:"tab",handler:queue.show_tab,event:"click"});$$(".schedule_form select").each(function(el){if(el.parentElement){var radioBtn=el.parentElement.select(".queue_for input")[0];el.on("change",function(){if(!radioBtn.checked){radioBtn.checked="checked"}})}})};this.splash_queue_handlers=function(){universal_dom.assign_handler({bucket:"delete-splash-from-queue",handler:queue.delete_splash_from_queue,event:"click"})};this.global_queue_handlers=function(){universal_dom.assign_handler({bucket:"confirm-delete",handler:queue.show_alert,event:"click"});universal_dom.assign_handler({bucket:"schedule-submit",handler:queue.schedule_submit,event:"click"});universal_dom.assign_handler({bucket:"schedule-cancel",handler:queue.schedule_cancel,event:"click"});universal_dom.assign_handler({bucket:"hide_alerts",handler:queue.hide_alerts,event:"click"})};this.init_params=function(){params=document.location.search.replace(/^\?/,"").toQueryParams();if(typeof params!="undefined"){if(params.tab){if(params.tab=="splash_queue"&&acl.user_can("homepage_edit")){queue.current_fieldset="splash_queue"}else{if(params.tab=="flow_suggestions"){queue.current_fieldset="flow_suggestions"}}}if(params.types){var queue_types=params.types.split("+");if(queue_types.length>0){var queue_type_form=$("queue_type_form").select("input");queue_type_form.each(function(el){$(el).checked=false;queue_types.each(function(tp){if(tp==$(el).name){$(el).checked=true}})})}}}return queue.show_queue_types()};this.show_queue_types=function(){var queueTypes=new Array();var queue_type_form=$("queue_type_form"),queue_type_form_inputs=queue_type_form?queue_type_form.select("input"):[];queue_type_form_inputs.each(function(el){if($(el).checked){queueTypes.push($(el).name)}});if(!queue_type_form_inputs.length){return false}queue.filter(queueTypes);return true};this.queue_types_string=function(){var types_string=new Array();if($("queue_type_form")){var queue_type_form=$("queue_type_form").select("input");queue_type_form.each(function(el){if($(el).checked){if(types_string==""){types_string=$(el).name}else{types_string+="+"+$(el).name}}});return types_string}else{return false}};this.override_post_tools=function(){bf_post_tools.load_flexpro=function(e){var buzz_info=e.target.getAttribute("rel:data").evalJSON();var owner=e.target.getAttribute("rel:owner");if(buzz_info.status=="draft"&&buzz_info.buzz_id){window.open("/buzzfeed/_draft/"+buzz_info.buzz_id)}else{if(buzz_info.uri&&owner){window.open(BF_STATIC.web_root+"/"+owner+"/"+buzz_info.uri,"_new")}else{alert("Invalid ID ("+buzz_info.buzz_id+")")}}};bf_post_tools.delete_quickpost=function(e,type){if(e.event){e=e.event}e.stop();var username=(new BF_User()).getUserInfo().username;var el=e.target;var owner=el.getAttribute("rel:owner");var buzz_data=el.getAttribute("rel:data");var buzz_data=eval("("+buzz_data+")");if(buzz_data.area_id){var args={area_id:buzz_data.area_id,buzz_id:buzz_data.buzz_id}}else{var args={buzz_id:buzz_data.buzz_id};if(typeof buzz_data.queue_id!=="undefined"){args.queue_id=buzz_data.queue_id}}queue.show_alert(args)}};this.make_drag_lists=function(lists){for(var i=0;i<lists.length;i++){var queueList="queueList"+i;var lastDragOrder="lastDragOrder"+i;listObj[lists[i]]={qlist:queueList,lastOrder:lastDragOrder};queue[queueList+i]=new Array();queue[lastDragOrder]=new Array()}};this.list_make_sortable=function(listName){if(!$(listName)){return false}queue.list_destroy_sortable(listName);if($$("#"+listName+" .queue_item:not(.hidden)").length>1){Sortable.create(listName,{only:"queue_item",scroll:window,onChange:function(e){queue.drag_change(listName)}});Draggables.addObserver({onStart:function(eventName,draggable,e){draggable.element.addClassName("dragging")},onEnd:function(eventName,draggable,e){draggable.element.removeClassName("dragging");queue.drag_end(listName)}});$(listName).addClassName("is_draggable")}};this.list_destroy_sortable=function(listName){if(!$(listName)){return false}$(listName).removeClassName("is_draggable");Sortable.destroy(listName)};this.drag_change=function(listName){var newDragOrder=queue.get_new_queue_order(listName);var lastDragOrder=queue.get_last_drag_order(listName);var myQueueList=queue.get_queue_list(listName);for(var i=0;i<newDragOrder.length;i++){if(newDragOrder[i]!=lastDragOrder[i]){var firstElement=$$("#"+newDragOrder[i]+" .queue_time .text")[0];var secondElement=$$("#"+myQueueList[i]+" .queue_time .text")[0];firstElement.innerHTML=secondElement.id}}queue.set_last_drag_order(listName,newDragOrder)};this.drag_end=function(listName){var newOrder=queue.get_new_queue_order(listName);var myQueueList=queue.get_queue_list(listName);var newTimesHash={};var usedTimesHash={};for(var i=0;i<newOrder.length;i++){var postId=JSON.parse($$("#"+newOrder[i])[0].getAttribute("rel:data")).queue_id;var newTime=JSON.parse($$("#"+myQueueList[i])[0].getAttribute("rel:data")).unix_time;var timeUpdated=false;var secondsTime=newTime;while(usedTimesHash[secondsTime]==1){secondsTime=parseInt(secondsTime)+1;timeUpdated=true}usedTimesHash[secondsTime]=1;if((newOrder[i]!=myQueueList[i])||timeUpdated){newTimesHash[postId]=secondsTime}}queue.set_queue_list(listName,newOrder);if(Object.keys(newTimesHash).length>0){queue.show_body_overlay();var controller=queue.get_controller(listName);var params={action:"update_times",new_times:JSON.stringify(newTimesHash)};try{var ajax=new BF_Request();ajax.request(controller,{method:"get",parameters:params,onSuccess:function(o){queue.reload_page()}})}catch(err){dumpError(err)}}};this.get_controller=function(listName){if(listName=="splash_queue_list"||listName=="bigstory_homepage_queue_list"){return queue.splash_controller}else{return queue.controller}};this.update_list_order=function(listName){var myQueueList=queue.get_new_queue_order(listName);queue.set_queue_list(listName,myQueueList);queue.set_last_drag_order(listName,myQueueList)};this.get_new_queue_order=function(listName){var newQueueList=new Array();$$("#"+listName+" .queue_item:not(.hidden)").each(function(el){newQueueList.push($(el).id)});return newQueueList};this.get_last_drag_order=function(listName){if(listObj[listName]){return queue[listObj[listName].lastOrder]}else{return 0}};this.set_last_drag_order=function(listName,newDragOrder){if(listObj[listName]){queue[listObj[listName].lastOrder]=newDragOrder}};this.get_queue_list=function(listName){if(listObj[listName]){return queue[listObj[listName].qlist]}else{return 0}};this.set_queue_list=function(listName,newQueueList){if(listObj[listName]){queue[listObj[listName].qlist]=newQueueList}};this.filter=function(queueTypes){universal_dom.get_bucket_elements("queue_item").each(function(el){el.addClassName("hidden")});universal_dom.get_bucket_elements("queue_item").each(function(el){queueTypes.each(function(qt){if(el.hasClassName(qt)){el.removeClassName("hidden")}})});for(var i=0;i<queue.draggableLists.length;i++){queue.update_list_order(queue.draggableLists[i])}};this.update_queue_time=function(args){if(args.buzz_id||args.buzz_promotion_id){var date_radio=$$(".schedule_form")[0].run_at_type[1];var post_id;var uList="";if(args.bigstory_homepage_suggestion&&args.bigstory_homepage_suggestion==1){if(args.buzz_promotion_id){post_id=args.buzz_promotion_id;uList="#bigstory_homepage_suggestions_list ";active_promotion=args.buzz_promotion_id}else{if(args.buzz_id){post_id=args.buzz_id;active_buzz=args.buzz_id}}$("current_status").innerHTML="";$$(".vertical_options")[0].hide();$$(".queue_alert_title")[0].innerHTML="Add To Big Story Queue";date_radio.show()}else{if(args.splash_page){post_id=args.buzz_promotion_id;uList="#splash_queue_list ";active_promotion=args.buzz_promotion_id;active_area_id=args.area_id;if(args.buzz_id){active_buzz=args.buzz_id}$("current_status").innerHTML="";$$(".vertical_options")[0].hide();if(queue.current_fieldset=="bigstory_homepage_queue"){$$(".queue_alert_title")[0].innerHTML="Edit Big Story Queue Status"}else{var title=(args.splash_page)?"Edit "+args.splash_page+" Splash Queue Status":"Edit Splash Queue Status";active_splash_page=(args.splash_page)?args.splash_page:"Frontpage";$$(".queue_alert_title")[0].innerHTML=title}date_radio.show()}else{if(args.buzz_id){post_id=args.buzz_id;active_buzz=args.buzz_id;active_area_id=args.area_id;if(args.vertical&&args.date){$("current_status").innerHTML="(Currently queued into the "+args.vertical+".)"}else{$("current_status").innerHTML="(Not Currently Queued)"}date_radio.checked=true;$$(".vertical_options")[0].show();var area_name=(args.area)?args.area:(args.vertical)?args.vertical:(args.vertical_name)?args.vertical_name:"Publish";active_area_name=area_name;var queue_name=(area_name=="Publish")?"Publish":(area_name.indexOf("Homepage")!=-1)?"Homepage":"Vertical";$$(".queue_alert_title")[0].innerHTML="Edit "+queue_name+" Queue Status";date_radio.show();if(queue.current_fieldset=="flow_suggestions"){$$(".queue_alert_title")[0].innerHTML="Move to Homepage Flow Queue"}}}}if(!args.date){var next=new Date();if(next.getMinutes()>=0&&next.getMinutes()<10){next.setMinutes(15)}else{if(next.getMinutes()>=10&&next.getMinutes()<25){next.setMinutes(30)}else{if(next.getMinutes()>=25&&next.getMinutes()<40){next.setMinutes(45)}else{if(next.getMinutes()>=40&&next.getMinutes()<55){next.setMinutes(60)}else{next.setMinutes(75)}}}}args.date=dateFormat(next,"yyyy-mm-dd HH:MM:ss")}if(args.date){var t=args.date.toString().split(/[- :]/);var datetime=new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]);var month=datetime.getMonth()+1;var date=datetime.getFullYear()+"/"+month+"/"+datetime.getDate();var min=(datetime.getMinutes()<=9)?"0"+datetime.getMinutes():datetime.getMinutes();var hours=datetime.getHours();var time=hours+":"+min+":0";if(date&&time){for(var i=0;i<$$("#day")[0].options.length;i++){if($$("#day")[0].options[i].value==date){$$("#day")[0].selectedIndex=i}}for(var i=0;i<$$("#time")[0].options.length;i++){if($$("#time")[0].options[i].value==time){$$("#time")[0].selectedIndex=i}}$("pin_it").checked=(args.pin&&args.pin=="true")?true:false;$("add_to_homepage").checked=(args.hp&&args.hp=="true")?true:false}date_radio.checked=true}var dialog=$$(".update_queue_time")[0];var dialogWidth=dialog.getWidth();var dialogHeight=dialog.getWidth();var editBtn=$(args.target);var editBtnHeight=editBtn.getHeight();var editBtnLeft=Math.max(editBtn.offsetLeft,dialogWidth);var editBtnTop=editBtn.offsetTop;var post=$$(""+uList+"#post-"+post_id)[0];var postTop=(post)?post.offsetTop:0;var top=(postTop+editBtnTop+editBtnHeight+5);var left=(editBtnLeft-dialogWidth);var viewport=document.viewport.getDimensions();var scroll=document.viewport.getScrollOffsets();if(!post||top>800){top=(scroll.top+(viewport.height-dialogHeight))/2;left=scroll.left+(viewport.width-dialogWidth)/2}left=scroll.left+(viewport.width-dialogWidth)/2;if(typeof args.add_to_homepage!="undefined"&&args.add_to_homepage==1){$("add_to_homepage").checked=true}queue.show_body_overlay();dialog.show();dialog.setStyle({left:left+"px",top:top+"px"})}else{}};this.show_body_overlay=function(){var bodyHeight=document.body.getHeight();var bodyWidth=document.body.getWidth();if(!$("bodyOverlay")){var overlay=document.createElement("div");overlay.setAttribute("id","bodyOverlay");overlay.setStyle({width:bodyWidth+"px",height:bodyHeight+"px",zIndex:99});document.body.appendChild(overlay)}};this.hide_alerts=function(){if($("bodyOverlay")){document.body.removeChild($("bodyOverlay"))}$$(".update_queue_time")[0].hide();$$(".alert_box").each(function(el){el.hide()})};this.schedule_cancel=function(){if($("quickpost-queue")){$("quickpost-queue").checked=false}queue.hide_alerts()};this.schedule_submit=function(){var bad_date=false;var run_at_type=$$(".schedule_form")[0].run_at_type;var run_at=getCheckedValue(run_at_type);if(run_at=="date"){run_at=$$("#day")[0].options[$$("#day")[0].selectedIndex].value+" "+$$("#time")[0].options[$$("#time")[0].selectedIndex].value;var right_now=new Date();var selected_date=new Date(run_at);if(right_now>selected_date){$$(".bad_date")[0].show();bad_date=true}run_at=""+Math.round(selected_date.getTime()/1000)}else{if(run_at="next"){run_at=""+(Math.round(Date.now()/1000)+900)}}if(!bad_date){if(queue.current_fieldset=="splash_queue"){queue.schedule_splash(run_at)}else{if(queue.current_fieldset=="bigstory_homepage_queue"){queue.schedule_bigstory(run_at)}else{queue.schedule_flow(run_at)}}queue.hide_alerts()}};this.schedule_flow=function(run_at){var current_buzz=active_buzz;bf_post_tools.current_buzz=current_buzz;if($$("#post-"+active_buzz+" .ptool_spinner")[0]){$$("#post-"+active_buzz+" .ptool_spinner")[0].show()}else{if(superlist){superlist.toggle_disable_actions()}}queue.show_body_overlay();$$(".update_queue_time")[0].hide();var params={action:"schedule",buzz_id:current_buzz,area_id:active_area_id,page:active_area_name,run_at:run_at};try{var ajax=new BF_Request();ajax.request(queue.controller,{method:"post",parameters:params,onSuccess:function(o){if(queue.current_fieldset!="flow_suggestions"){queue.reload_page()}else{var message="addedtoqueue";(typeof BF_STATIC!=="undefined"&&BF_STATIC.country!=="undefined"&&BF_STATIC.country=="uk")?queue.reload_page(message):queue.delete_from_flow_suggestions(message)}}})}catch(err){dumpError(err)}};this.schedule_splash=function(run_at){bf_post_tools.current_buzz=active_promotion;if($$("#splash_queue_list #post-"+active_buzz+" .ptool_spinner")[0]){$$("#splash_queue_list #post-"+active_buzz+" .ptool_spinner")[0].show()}queue.show_body_overlay();$$(".update_queue_time")[0].hide();var params={action:"schedule",buzz_id:active_buzz,area_id:active_area_id,run_at:run_at};params.splash_page=active_splash_page;try{var ajax=new BF_Request();ajax.request(queue.splash_controller,{method:"post",parameters:params,onSuccess:function(o){queue.reload_page()}})}catch(err){dumpError(err)}};this.schedule_bigstory=function(run_at){return;var params={action:"schedule",run_at:run_at};var controller=queue.bigstory_controller;if(queue.current_fieldset=="bigstory_homepage_suggestions"){bf_post_tools.current_buzz=active_buzz;if($$("#bigstory_homepage_suggestions_list #post-"+active_buzz+" .ptool_spinner")[0]){$$("#bigstory_homepage_suggestions_list #post-"+active_buzz+" .ptool_spinner")[0].show()}params.buzz_id=active_buzz}else{if(queue.current_fieldset=="bigstory_homepage_queue"){bf_post_tools.current_buzz=active_promotion;if($$("#bigstory_homepage_queue_list #post-"+active_promotion+" .ptool_spinner")[0]){$$("#bigstory_homepage_queue_list #post-"+active_promotion+" .ptool_spinner")[0].show()}params.promotion_id=active_promotion;controller=queue.splash_controller}}queue.show_body_overlay();$$(".update_queue_time")[0].hide();try{var ajax=new BF_Request();ajax.request(controller,{method:"post",parameters:params,onSuccess:function(o){queue.reload_page()}})}catch(err){dumpError(err)}};this.show_alert=function(args){if(args.buzz_id){var item;if(args.buzz_id){active_buzz=args.buzz_id;item=$$("#post-"+args.buzz_id)[0];active_area_id=args.area_id?args.area_id:0;active_queue_id=args.queue_id?args.queue_id:0}var itemTop=item.offsetTop;var dialog=$$(".alert_box")[0];var dialogWidth=dialog.getWidth();queue.show_body_overlay();dialog.show();dialog.setStyle({left:(dialogWidth)+"px",top:(itemTop)+"px"})}else{alert("Invalid ID ("+args.buzz_id+")")}};this.delete_cancel=function(){queue.hide_alerts()};this.delete_from_splash_queue=function(){queue.show_body_overlay();var params={action:"delete_from_queue",buzz_id:active_buzz,area_id:active_area_id,splash_page:active_splash_page};try{var ajax=new BF_Request();ajax.request(queue.splash_controller,{method:"get",parameters:params,onSuccess:function(o){queue.reload_page("splashdeleted")}})}catch(err){dumpError(err)}};this.delete_from_flow_queue=function(){$$("#post-"+active_buzz+" .ptool_spinner")[0].show();queue.show_body_overlay();var params={action:"delete_from_queue",buzz_id:active_buzz};if(typeof active_area_id!=="undefined"&&active_area_id!=0){params.area_id=active_area_id}else{if(typeof active_queue_id!=="undefined"&&active_queue_id!=0){params.queue_id=active_queue_id}}try{var ajax=new BF_Request();ajax.request(queue.controller,{method:"get",parameters:params,onSuccess:function(o){queue.reload_page("deleted")}})}catch(err){dumpError(err)}};this.delete_from_flow_suggestions=function(message){var reload_message=message||"removedsuggestion";var email_editor=reload_message=="removedsuggestion"?1:0;var current_buzz=active_buzz;bf_post_tools.current_buzz=current_buzz;$$("#post-"+active_buzz+" .ptool_spinner")[0].show();queue.show_body_overlay();var params={action:"delete_flow_suggestion",buzz_id:current_buzz,email_editor:email_editor};try{var ajax=new BF_Request();ajax.request(queue.controller,{method:"post",parameters:params,onSuccess:function(o){queue.reload_page(reload_message)}})}catch(err){dumpError(err)}};this.delete_from_bigstory_homepage_suggestions=function(){$$("#post-"+active_buzz+" .ptool_spinner")[0].show();queue.show_body_overlay();var params={action:"delete_bigstory_suggestion",buzz_id:active_buzz};try{var ajax=new BF_Request();ajax.request(queue.controller,{method:"get",parameters:params,onSuccess:function(o){var post=$("post-"+active_buzz);if(post){post.parentNode.removeChild(post)}queue.hide_alerts()}})}catch(err){dumpError(err)}};this.delete_from_queue=function(args){if(queue.current_fieldset=="splash_queue"){$$("#splash_queue_list #post-"+active_buzz+" .ptool_spinner")[0].show();queue.delete_from_splash_queue()}else{if(queue.current_fieldset=="bigstory_homepage_queue"){$$("#bigstory_homepage_queue_list #post-"+active_promotion+" .ptool_spinner")[0].show();queue.delete_from_splash_queue()}else{if(queue.current_fieldset=="flow_suggestions"){queue.delete_from_flow_suggestions("removedsuggestion")}else{if(queue.current_fieldset=="bigstory_homepage_suggestions"){queue.delete_from_bigstory_homepage_suggestions()}else{queue.delete_from_flow_queue()}}}}};this.publish_to_hp=function(args){if(args.buzz_id){$$("#post-"+args.buzz_id+" .ptool_spinner")[0].show();queue.show_body_overlay();var params={action:"publish_to_hp",buzz_id:args.buzz_id,country:BF_STATIC.country};if(queue.current_fieldset=="flow_suggestions"){params.is_suggestion=1}try{var ajax=new BF_Request();ajax.request(queue.controller,{method:"get",parameters:params,onSuccess:function(o){queue.reload_page("published")}})}catch(err){dumpError(err)}}else{alert("Invalid ID ("+args.buzz_id+")")}};this.reload_page=function(success_message){var params_array=new Array();var pathname=window.location.pathname;if(typeof BF_STATIC!=="undefined"&&BF_STATIC.country!=="undefined"&&BF_STATIC.country!="us"){params_array.push("country="+BF_STATIC.country)}if(queue.queue_types_string()){params_array.push("types="+queue.queue_types_string())}if(!(typeof success_message==="undefined")&&success_message.length>0){params_array.push("message="+success_message)}if(queue.current_fieldset=="flow_suggestions"||queue.current_fieldset=="bigstory_homepage_queue"||queue.current_fieldset=="splash_queue"){params_array.push("tab="+queue.current_fieldset)}if(params_array.length>0){if(pathname.indexOf("?")){pathname=pathname.substring(0,pathname.indexOf("?"))}pathname+="?"+params_array.join("&");var curr=queue.current_fieldset;BF_Request.location({location:pathname});queue.current_fieldset=curr}else{window.setTimeout(function(){var curr=queue.current_fieldset;BF_Request.location({reload_track:true});queue.current_fieldset=curr},200)}};this.init_tabs=function(){if(typeof queue.current_fieldset=="undefined"){queue.current_fieldset=(window.history.state&&window.history.state.tab)?window.history.state.tab:"flow_queue"}queue.show_tab({id:queue.current_fieldset})};this.show_tab=function(obj){$$("#queue-data>li").each(function(el){el.addClassName("hidden");if($(el.id+"_tab")){$(el.id+"_tab").removeClassName("active_tab")}});if($(obj.id)&&$(obj.id+"_tab")){$(obj.id).removeClassName("hidden");$(obj.id+"_tab").addClassName("active_tab");queue.current_fieldset=obj.id;if(!(window.history.state&&window.history.state.tab==obj.id)){history.pushState({tab:obj.id},"","")}}}.bind(this)};function getCheckedValue(c){if(!c){return""}var d=c.length;if(d==undefined){if(c.checked){return c.value}else{return""}}for(var b=0;b<d;b++){if(c[b].checked){return c[b].value}}return""}window.onload=function(){for(var b=0;b<queue.draggableLists.length;b++){queue.list_make_sortable(""+queue.draggableLists[b])}};window.onpopstate=function(b){if(b.state&&b.state.tab){queue.show_tab({id:b.state.tab})}};var queue=new BF_Queue();var bf_post_tools=new BF_Post_Tools();BuzzLoader.register(function(){queue.init()},2);var BF_DFA=function(){this.custom_vars={"click:react/":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=react674;ord=[timestamp]?","click:share/pinterest":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=share783;ord=[timestamp]?","click:share/email":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=share080;ord=[timestamp]?","click:share/twitter/tweet":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=share802;ord=[timestamp]?","click:share/facebook/like":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=share810;ord=[timestamp]?","click:share/facebook/share":"http://ad.doubleclick.net/activity;src=3919961;type=sitea636;cat=share814;ord=[timestamp]?","video:end":"http://ad.doubleclick.net/activity;src=3919961;type=video012;cat=video469;ord=[timestamp]?","video:reached:25%":"http://ad.doubleclick.net/activity;src=3919961;type=video012;cat=video827;ord=[timestamp]?","video:reached:50%":"http://ad.doubleclick.net/activity;src=3919961;type=video012;cat=video064;ord=[timestamp]?","video:reached:75%":"http://ad.doubleclick.net/activity;src=3919961;type=video012;cat=video878;ord=[timestamp]?","click:video-play":"http://ad.doubleclick.net/activity;src=3919961;type=video012;cat=video618;ord=[timestamp]?"};this.fire_event=function(b){if(!dfa.status()){return false}var c=dfa.fetch_uri(b);if(typeof c=="undefined"){return false}if(BF_STATIC.bf_env!="live"){console.log("DFA: "+c)}else{trackPixel(c)}};this.status=function(){var b=objExists(BF_STATIC.f_ad)?BF_STATIC.f_ad=="1"?true:false:false;return b};this.fetch_uri=function(b){var c;for(v in dfa.custom_vars){if(b.match(v)){c=dfa.custom_vars[v]}}return c}};var dfa=new BF_DFA();BF_comment_links=function(){this.box_id;this.init=function(){universal_dom.assign_handler({bucket:"share-social",handler:comment_links.show_share_box,event:"click"});universal_dom.assign_handler({bucket:"share-comment",handler:comment_links.show_share_box,event:"click"});universal_dom.assign_handler({bucket:"fb-share-comment",handler:comment_links.comment_share,event:"click"});universal_dom.assign_handler({bucket:"tw-share-comment",handler:comment_links.comment_share,event:"click"});universal_dom.assign_handler({bucket:"link-share-comment",handler:comment_links.comment_share,event:"click"});universal_dom.assign_handler({bucket:"em-share-comment",handler:comment_links.comment_share,event:"click"});universal_dom.assign_handler({bucket:"pin-share-comment",handler:comment_links.comment_share,event:"click"});comment_links.fix_box_height();if(document.URL.include("?comment")){var url=document.URL.toQueryParams();comment_links.highlite(url.comment)}if(document.URL.include("?commentid")){var url=document.URL.toQueryParams();comment_links.highlite(url.commentid)}document.observe("scroll",comment_links.hide_share_box);document.observe("click",comment_links.click_hide_share_box);$$(".comment-share .share-icon").each(function(share_el){share_el.observe("click",comment_links.comment_share)})};this.fix_box_height=function(){$$(".comment-share").each(function(el){if(el.select(".share-icon#pinterest").length==0){$(el).setStyle({height:"120px"})}})};this.click_hide_share_box=function(e){try{if(typeof(e.target)=="undefined"||!isHTMLElement(e.target)){console.log("Not html element. SVG fix.");return}if(!$(e.target).up(".share")&&!$(e.target).hasClassName("share")&&!$(e.target).up(".comment-share")&&!$(e.target).hasClassName("comment-share")){comment_links.hide_share_box()}}catch(e){console.error(e)}};this.hide_share_box=function(){if(comment_links.box_id){var share=$(comment_links.box_id).select(".comment-share").first(),social=$(comment_links.box_id).select(".comment-social").first(),lovehate_buttons=$(comment_links.box_id).select(".comment-lovehate-buttons").first(),copy_link=$(comment_links.box_id).select(".copy-link").first();if(share){share.addClassName("hidden")}if(social){social.addClassName("hidden")}if(lovehate_buttons){lovehate_buttons.addClassName("hidden")}if(copy_link){copy_link.remove()}comment_links.box_id=null}};this.show_share_box=function(e){var main_element=e.target.up("a");if(main_element&&typeof main_element!=undefined){var data=eval("("+main_element.getAttribute("rel:bf_bucket_data")+")")}var comment_id=data["share-comment"].id;if(!($(e.target).up("#link")||$(e.target).up(".copy-link"))){comment_links.hide_share_box()}var container=$(main_element).up("li");if(typeof container=="undefined"||!("className" in container)){return false}className=container.className;className.split(" ").each(function(item){var box=$(comment_id).select(".comment-"+item).first();if(typeof box!=="undefined"){if(!comment_links.box_id){comment_links.box_id=comment_id;box.removeClassName("hidden");if(item==="share"||item==="social"){var btn={left:Number(container.positionedOffset()[0]),top:Number(container.positionedOffset()[1]),height:Number(container.getHeight()),width:Number(container.getWidth())};box.setStyle({left:(btn.left-4)+"px",top:(btn.top+btn.height)+"px",height:"auto"})}}}})};this.highlite=function(id){var comment=$(id);if(comment){if(comment.nodeName=="DIV"){comment=comment.parentNode}comment.select("div.what")[0].style.border="2px solid yellow";comment.scrollTo();setTimeout(function(){comment.scrollTo()},2000)}else{}};this.comment_share=function(e){var main_element=e.target.up();var share_data=eval("("+main_element.getAttribute("rel:share_data")+")");var react_cam_comment=(objExists(e.react_cam)&&e.react_cam==true?true:false);var comment=$(share_data.id);var comment_id=comment.getAttribute("rel:comment_id");var url=comment_links.get_url(comment_id);var desc,title,img;var comment_data=comment.getAttribute("rel:data");comment_data=eval("("+comment_data+")");if(comment&&comment.select(".blurb")[0]){desc=comment.select(".blurb")[0].textContent}if(comment_data.type=="image"){img=comment.select(".image img")[0].src}if(comment_data.type=="react_image"){img=comment.select(".react_image img")[0].src}if(comment_data.type=="video"){if(comment.select(".video iframe").length){img=comment.select(".video iframe")[0].src}else{img=comment.select(".video embed")[0].src}}if(comment_data.type=="mixedpic"){img=comment.select(".mixedpic img")[0].src.replace(/(.+)(\.gif)/,"$1_preview$2")}if(!title&&$$('meta[property="og:title"]').length>0){title=$$('meta[property="og:title"]')[0].attributes.content.value}if(!desc&&$$('meta[property="og:description"]').length>0){desc=$$('meta[property="og:description"]')[0].attributes.content.value}if(!img&&$$('meta[property="og:image"]').length>0){img=$$('meta[property="og:image"]')[0].attributes.content.value}if(title.indexOf("Contribution To: ")<0){title="Contribution To: "+title}if(main_element.id=="facebook"){url=encodeURIComponent(url);title=encodeURIComponent(title);desc=encodeURIComponent(desc);img=encodeURIComponent(img);window.open("http://facebook.com/sharer/sharer.php?s=100&p[url]="+url+"&p[title]="+title+"&p[images][0]="+img+"&p[summary]="+desc,"_blank","width=600, height=260");comment_links.hide_share_box();if(react_cam_comment&&window.bf_react_cam){bf_react_cam.track("contrib_fb_share")}}else{if(main_element.id=="twitter"){desc=encodeURIComponent((desc.length>120)?desc.substr(0,115)+"...":desc);url=encodeURIComponent(url);if(react_cam_comment){if(objExists(BF_STATIC.username)&&BF_STATIC.username=="starbucksfrappuccino"){hashtags="sipface"}desc="I just left a reaction with the Frappuccino Reaction Cam."}window.open("https://twitter.com/intent/tweet?text="+desc+(typeof hashtags!="undefined"?"&hashtags="+hashtags:"")+"&url="+url,"_blank","width=600,height=400");comment_links.hide_share_box();if(react_cam_comment&&window.bf_react_cam){bf_react_cam.track("contrib_tw_share")}}else{if(main_element.id=="email"){url=encodeURIComponent(url);title=encodeURIComponent(title);desc=encodeURIComponent(desc);window.open("mailto:?subject="+title+"&body="+desc+" "+url,"_self");comment_links.hide_share_box();if(react_cam_comment&&window.bf_react_cam){bf_react_cam.track("contrib_email_share")}}else{if(main_element.id=="link"){$(comment).select(".copy-link").each(function(cp){$(cp).remove()});$(comment).select(".comment-share").each(function(el){$(el).insert('<div class="copy-link"><span>Share This Link</span><input type="text" value="'+url+'" /></div>')});if(react_cam_comment&&window.bf_react_cam){bf_react_cam.track("contrib_link_share")}}else{if(main_element.id=="pinterest"){url=encodeURIComponent(url);desc=encodeURIComponent(desc);img=encodeURIComponent(img);window.open("http://pinterest.com/pin/create/button/?media="+img+"&url="+url+"&description="+desc,"_blank","width=600,height=400");comment_links.hide_share_box()}}}}}};this.get_url=function(id){var url="";if(document.URL.include("?")){url=document.URL.split("?")[0]}else{url=document.URL}url=url+"?comment="+id;return url}};var comment_links=new BF_comment_links();BuzzLoader.register(comment_links.init,1);function onYouTubeIframeAPIReady(){if($("video_overlay_init")){yt_player.create_player()}$H(yt_player.all_overlays).each(function(b){if(!yt_player.players[b.key]){yt_player.create_player_from(b.key)}})}var YT_Player=function(){this.player;this.players={};this.videoid;this.player_timer=false;this.overlays=[];this.all_overlays={};this.init=function(b,c){var d=window.YT||{};if(typeof b!=="undefined"){this.destroy_video(b);yt_player.all_overlays[b]=c}else{this.destroy_video()}if(!d.Player){(function(){var f=document.createElement("script");f.src="https://www.youtube.com/iframe_api";f.async=true;var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(f,e)})()}else{onYouTubeIframeAPIReady()}};this.create_player=function(){var d=function(e){if(e.data==1){yt_player.player.pauseVideo();d=yt_player.player_state_change}yt_player.player_state_change(e)};YT.embed_template='\u003ciframe width="250" height="350" src="" frameborder="0" allowfullscreen\u003e\u003c/iframe\u003e';yt_player.player=new YT.Player("video_overlay_yt",{height:325,width:540,videoId:yt_player.videoid,events:{onReady:function(){yt_player.load_video(yt_player.videoid);yt_player.player.playVideo()},onStateChange:function(e){d(e)}}});var b=$("video_overlay_yt");var c=b.getAttribute("src");b.setAttribute("src",c+"&wmode=opaque")};this.create_player_from=function(b){yt_player.players[b]=new YT.Player("yt_"+b,{events:{onStateChange:function(c){yt_player.player_state_change(c,b)}}})};this.destroy_video=function(b){if(b){try{yt_player.players[b].stopVideo();yt_player.players[b].destroy()}catch(c){}delete yt_player.players[b]}else{try{yt_player.player.stopVideo();yt_player.player.destroy()}catch(c){}yt_player.player=null}};this.load_video=function(){try{yt_player.player.cueVideoById(yt_player.videoid)}catch(b){}};this.player_state_change=function(d,c){state=d.data;var b={"-1":function(){console.log("unstarted")},"0":function(){console.log("video end")},"1":function(e){yt_player.set_video_intervals();console.log("play video")},"2":function(){console.log("paused")},"3":function(){console.log("buffering")},"5":function(){console.log("video cued")}};b[state](c)};this.set_video_id=function(b){yt_player.videoid=b};this.set_video_intervals=function(c){if(yt_player.player_timer){return}yt_player.player_timer=setInterval(function(){for(var d in yt_player.players){if(!yt_player.players[d].getCurrentTime){continue}b(d,yt_player.players[d].getCurrentTime(),yt_player.all_overlays[d])}if(!yt_player.player||!yt_player.player.getCurrentTime){return}b(null,yt_player.player.getCurrentTime(),yt_player.overlays)},500);function b(d,j,h){var k=d?(d+"_"):"";for(var g=h.length;g--;){var f=h[g];var e="anno_"+k+g;if(f&&j>=f.start&&j<=f.end){if(!$(e)){yt_player.add_annotation(f,g,d)}}else{if($(e)){$(e).remove()}}}}};this.clear_video_interval=function(b){if(b===undefined){for(var c in yt_player.player_timer){clearInterval(yt_player.player_timer[c])}yt_player.player_timer={}}else{clearInterval(yt_player.player_timer[b]);yt_player.player_timer[b]=null}};this.edit_annotation=function(d,c,b){var e="anno_"+(b?b+"_":"")+c;if($(e)){$(e).setStyle({top:d.top+"%",left:d.left+"%",maxWidth:Math.max(5,100-d.left)+"%"});$$("#"+e+" .video_anno_txt").each(function(f){f.innerHTML=d.text});$$("#"+e+" a").each(function(f){f.href=d.link})}yt_player.overlays[c]=d};this.add_annotation=function(e,d,c){var f={position:"absolute",top:e.top+"%",left:e.left+"%",borderRadius:"3px",padding:"5px",backgroundColor:"rgba(238, 238, 238, 0.8)",cursor:"pointer",maxWidth:Math.max(5,100-e.left)+"%",wordWrap:"break-word",lineHeight:"16px"};var g=document.createElement("div");g.className="video_anno";g.id="anno_"+(c?c+"_":"")+d;g.setStyle(f);var h=document.createElement("div");h.className="video_anno_txt";h.innerHTML=e.text;var j=document.createElement("a");j.href=e.link;j.target="_blank";j.setStyle({color:"#111"});g.appendChild(j);j.appendChild(h);var b=$(c?"video_wrapper_"+c:"video_wrapper");this.scale_anno(g,b.getWidth()/625,b.getHeight()/379);b.insert({top:g})};this.scale_anno=function(e,b,g){if(b==1&&g==1){return}var d=["mozT","msT","oT","webkitT","t"];var f={};for(var c=d.length;c--;){f[d[c]+"ransform"]="scale("+b+","+g+")";f[d[c]+"ransformOrigin"]="top left 0"}e.setStyle(f)};this.get_overlay=function(b){return yt_player.overlays[b]};this.add_overlay=function(b,c){if(typeof c!="undefined"){yt_player.overlays[c]=b;return c}return yt_player.overlays.push(b)-1};this.remove_overlay=function(e,b){if(b!==undefined){var d=yt_player.all_overlays[b][e];var c="anno_"+b+"_"+e;delete yt_player.overlays[b][e]}else{var d=yt_player.overlays[e];var c="anno_"+e;delete yt_player.overlays[e]}if($(c)){$(c).remove()}}};yt_player=new YT_Player();(function(aO,aN,aM){function Z(b){ag(arguments,function(c,e){b[c]===aM&&(b[c]=e)});return b}function aa(b){ag(arguments,function(d,e){b[aC][ab(b,d)||d]=e});return b}function ab(e,c){var k=e[aC],j,h;if(k[c]!==aM){return c}c=c.charAt(0).toUpperCase()+c.slice(1);for(h=0;h<aj[aK];h++){j=aj[h]+c;if(k[j]!==aM){return j}}}function ac(h,e){var m=[aF,e,~~(h*100)].join("-"),l="{"+aF+":"+h+"}",k;if(!ai[m]){for(k=0;k<aj[aK];k++){try{ad.insertRule("@"+(aj[k]&&"-"+aj[k].toLowerCase()+"-"||"")+"keyframes "+m+"{0%{"+aF+":1}"+e+"%"+l+"to"+l+"}",ad.cssRules[aK])}catch(j){}}ai[m]=1}return m}function ae(e,d,f){f&&!f[av]&&ae(e,f),e.insertBefore(d,f||null);return e}function af(b){var d=aN.createElement(b||"div");ag(arguments,function(e,c){d[e]=c});return d}function ag(f,e){var h=~~((f[aK]-1)/2);for(var g=1;g<=h;g++){e(f[g*2-1],f[g*2])}}var aL="width",aK="length",aJ="radius",aI="lines",aH="trail",aG="color",aF="opacity",aE="speed",aD="shadow",aC="style",aB="height",aA="left",az="top",ay="px",ax="childNodes",aw="firstChild",av="parentNode",au="position",at="relative",ar="absolute",aq="animation",ap="transform",ao="Origin",an="Timeout",am="coord",al="#000",ak=aC+"Sheets",aj="webkit0Moz0ms0O".split(0),ai={},ah;ae(aN.getElementsByTagName("head")[0],af(aC));var ad=aN[ak][aN[ak][aK]-1],Y=function(b){this.opts=Z(b||{},aI,12,aH,100,aK,7,aL,5,aJ,10,aG,al,aF,0.25,aE,1)},X=Y.prototype={spin:function(u){var t=this,s=t.el=t[aI](t.opts);u&&ae(u,aa(s,aA,~~(u.offsetWidth/2)+ay,az,~~(u.offsetHeight/2)+ay),u[aw]);if(!ah){var p=t.opts,o=0,k=20/p[aE],j=(1-p[aF])/(k*p[aH]/100),h=k/p[aI];(function g(){o++;for(var c=p[aI];c;c--){var d=Math.max(1-(o+c*h)%k*j,p[aF]);t[aF](s,p[aI]-c,d,p)}t[an]=t.el&&aO["set"+an](g,50)})()}return t},stop:function(){var c=this,e=c.el;aO["clear"+an](c[an]),e[av]&&e[av].removeChild(e),c.el=aM;return c}};X[aI]=function(f){function g(k,l){return aa(af(),au,ar,aL,f[aK]+f[aL]+ay,aB,f[aL]+ay,"background",k,"boxShadow",l,ap+ao,aA,ap,"rotate("+~~(360/f[aI]*d)+"deg) translate("+f[aJ]+ay+",0)","borderRadius","100em")}var e=aa(af(),au,at),j=ac(f[aF],f[aH]),d=0,h;for(;d<f[aI];d++){h=aa(af(),au,ar,az,1+~(f[aL]/2)+ay,ap,"translate3d(0,0,0)",aq,j+" "+1/f[aE]+"s linear infinite "+(1/f[aI]/f[aE]*d-1/f[aE])+"s"),f[aD]&&ae(h,aa(g(al,"0 0 4px "+al),az,2+ay)),ae(e,ae(h,g(f[aG],"0 0 1px rgba(0,0,0,.1)")))}return e},X[aF]=function(e,d,f){e[ax][d][aC][aF]=f};var W="behavior",V="url(#default#VML)",U="group0roundrect0fill0stroke".split(0);(function(){var d=aa(af(U[0]),W,V),c;if(!ab(d,ap)&&d.adj){for(c=0;c<U[aK];c++){ad.addRule(U[c],W+":"+V)}X[aI]=function(){function n(k,h,b){ae(j,ae(aa(l(),"rotation",360/g[aI]*k+"deg",aA,~~h),ae(aa(af(U[1],"arcsize",1),aL,f,aB,g[aL],aA,g[aJ],az,-g[aL]/2,"filter",b),af(U[2],aG,g[aG],aF,g[aF]),af(U[3],aF,0))))}function l(){return aa(af(U[0],am+"size",p+" "+p,am+ao,-f+" "+-f),aL,p,aB,p)}var g=this.opts,f=g[aK]+g[aL],p=2*f,j=l(),e=~(g[aK]+g[aJ]+g[aL])+ay,o;if(g[aD]){for(o=1;o<=g[aI];o++){n(o,-2,"progid:DXImage"+ap+".Microsoft.Blur(pixel"+aJ+"=2,make"+aD+"=1,"+aD+aF+"=.3)")}}for(o=1;o<=g[aI];o++){n(o)}return ae(aa(af(),"margin",e+" 0 0 "+e,au,at),j)},X[aF]=function(f,e,h,g){g=g[aD]&&g[aI]||0,f[aw][ax][e+g][aw][aw][aF]=h}}else{ah=ab(d,aq)}})(),aO.Spinner=Y})(window,document);var bf_spinner=function(f,k){var j=false;var g=null;var e;var c=function(){var l=Math.floor((document.viewport.getHeight()/3)/3.5);var m={lines:8,length:l,width:Math.floor(0.66*l),radius:Math.floor(0.9*l),color:"#333",speed:1,trail:100,shadow:true};return m};var b=k||c();if(f&&$(f)){e=$(f)}else{try{e=new Element("div",{"class":"spinner_container",id:"spinner_"+Math.floor(Math.random()*100)});document.body.insert({top:e});var h="display:none;width:100%;position:fixed;left:0;height:"+document.viewport.getHeight()+"px;z-index:9999;top:0;";e.setAttribute("style",h)}catch(d){console.error(d)}}return{active:function(){return g},start:function(){if(g){return true}else{g=true}e.show();if(j){window.document.body.addClassName("spinner-activated");j=j.spin(e);return true}e.on("click",function(l){if(g){l.stop()}});j=new Spinner(b).spin(e)},stop:function(){try{window.document.body.removeClassName("spinner-activated");e.hide();g=false;j.stop()}catch(l){}},started:function(){return g}}};var BF_InlineSharing=function(){var k=this,h=window,y=document,b=y.viewport,n=BF_UTIL.browser.dimensions,s=function(d){return +d.match(/\d+/)},e=$$(".buzz").first(),u=$$(".PageContainer").first(),c=document.body.textContent?"textContent":"innerText",o=1200,m=function(d){return d.className.match("arrow")},t=function(d){return d===k.shareMenu||d.ancestors().indexOf(k.shareMenu)>=0},g=function(){if(!k.visible){return}var w=Math.round(n.height()/2)-Math.round(k.iconSize/2),d=e.cumulativeOffset().left+15;k.shareIconWrp.setStyle({top:w+"px",left:d+"px"})},l=function(){if(k.shareMenu.hasClassName("hidden")){return}var C=0,A=0,w=10,d=k.shareIconWrp.cumulativeOffset(),B=BF_cumulativeScrollOffset(k.shareIconWrp);C=k.shareMenu.getHeight()+w;A=Math.round((k.shareMenu.getWidth()-k.iconSize)/2);k.shareMenu.setStyle({top:(B.top+d.top-C)+"px",left:(B.left+d.left-A)+"px"})},j=function(){k.shareIconWrp.addClassName("hover");k.shareMenu.removeClassName("hidden");l()},z=function(w){k.shareIconWrp.removeClassName("hover");var d;if(w&&w.type!="click"){d=w.toElement?w.toElement:w.relatedTarget;if(d&&(m(d)||t(d))){return}}k.shareMenu.addClassName("hidden");bpage.hide_all_popups()},f=function(){k.visible=true;g();k.shareIconWrp.removeClassName("hidden")},p=function(){k.visible=false;k.shareIconWrp.addClassName("hidden");z()};k.visible=false;k.iconSize=0;k.type="article";k.init=function(){try{var K,B,E=0,w=$$(".suplist_article").length>0,H=$$(".buzz_superlist_item"),F=H.length?H[0].hasClassName("buzz_superlist_item_wide"):false,J=F?$$(".buzz_superlist_item_wide img"):null,C=$$(".upper-share-buttons"),I=$$(".bottom_shares").first().cumulativeOffset().top,G=function(){if($$(".bottom_shares").length&&!I){I=$$(".bottom_shares").first().cumulativeOffset().top}if(C.length&&!E){E=C.first().getHeight()+C.first().cumulativeOffset().top}var M=n.height(),L=b.getScrollOffsets().top+M;if(!k.visible&&b.getScrollOffsets().top>=E&&L<I){f()}else{if(k.visible&&(L<(E+M)||L>=I)){p()}}if(!k.visible){return}l()},d=function(){window.clearTimeout(B);window.clearTimeout(K)},A=function(){var L=0;$("buzz_sub_buzz").select("p").each(function(M){L+=M[c].split(/\s+/).length});return L>=o};k.shareIconWrp=$("inline_share_icon_wrp");if(!k.shareIconWrp){return}k.shareIcons=$$(".inline_share_icon");k.shareMenu=$("inline_shares_box");k.iconSize=s(k.shareIcons.first().getStyle("width"));if(!w){k.type="longform"}else{if(!A()){return}}if(F&&J&&J.length){J=J.first();E=J.getHeight()+J.cumulativeOffset().top}else{C.each(function(L){if(L.getHeight()){E=L.getHeight()+L.cumulativeOffset().top}})}if(!u.hasClassName("ie7")&&!u.hasClassName("ie8")){k.shareIconWrp.addClassName("hoverable")}k.shareIcons.each(function(L){L.on("mouseover",function(){d();j()})});k.shareIcons.each(function(L){L.on("mouseout",function(){K=window.setTimeout(z,1000)})});k.shareMenu.on("mouseover",d);k.shareMenu.on("mouseout",function(){B=window.setTimeout(z,1000)});k.shareMenu.select("a").each(function(L){if(!L.hasClassName("email_icon")&&!L.hasClassName("readlater_icon")){L.on("click",z)}});Event.observe(h,"resize",function(){g();l()});Event.observe(h,"scroll",G);G()}catch(D){console.error(D)}}};var BF_ReadLater=function(){var k=this,h=document,j='<iframe width="85" scrolling="no" height="22" frameborder="0" src="http://getpocket.com/button?url=SHARE_URL&amp;title=SHARE_TITLE&amp;via=www.buzzfeed.com" style="z-index: 2000; overflow: hidden;position:relative;top:3px" allowtransparency="true" id="readitlater_button1" class="readitlater_button"></iframe>',l='<iframe border="0" scrolling="no" width="78" height="20" allowtransparency="true" frameborder="0" style="margin-bottom: -3px; z-index: 1338; border: 0px; background-color: transparent; overflow: hidden;" src="http://www.instapaper.com/e2?url=SHARE_URL&title=SHARE_TITLE&description=SHARE_TITLE"></iframe>',g=function(d,m,n){var d=d.replace(new RegExp("(SHARE_URL)","g"),m);return d.replace(new RegExp("(SHARE_TITLE)","g"),n)},c=function(d){var m=h.createElement("SCRIPT");m.type="text/javascript";if(d.async){m.async=true}m.src=d.src;h.getElementsByTagName("head")[0].appendChild(m)},f=function(){c({async:true,src:h.location.protocol+"//www.readability.com/embed.js"})},e=function(){window.evernote=(function(){EN_CLIP_HOST="http://www.evernote.com";try{c({src:EN_CLIP_HOST+"/public/bookmarkClipper.js?"+(new Date().getTime()/100000)})}catch(d){location.href=EN_CLIP_HOST+"/clip.action?url="+encodeURIComponent(location.href)+"&title="+encodeURIComponent(h.title)}})},b=function(d){var n=d.getAttribute("data-url"),m=d.getAttribute("data-title");j=g(j,n,m);l=g(l,n,m);k.readItLaterPopup.select(".pocket-btn")[0].insert(j);k.readItLaterPopup.select(".instapaper-btn")[0].insert(l);f();e();k.initialized=true};k.init=function(){$$(".readitlater-btn").each(function(d){d.show()});k.readItLaterPopup=$("readitlater-popup"),k.initialized=false;universal_dom.get_bucket_elements("readlater").each(function(d){d.observe("click",function(t){var w,u,s,o,m,n,y=t.toElement?t.toElement:(t.relatedTarget||t.target),p=false;if($(y).hasClassName("shareBtn")||$(y).hasClassName("inlineShareBtn")){m=y;if($(y).parentElement.hasClassName("inline_share_wrp")){p=true}}else{if($(y).hasClassName("readitlater-btn")){m=y.firstChild}else{m=y.parentElement}}if(!k.initialized){b(m)}m.insert({after:k.readItLaterPopup});w=k.readItLaterPopup.select(".arrow");u={height:p?20:10,width:10};btn={top:Number($(m).positionedOffset()[1]),left:Number($(m).positionedOffset()[0]),width:Number($(m).getWidth()),height:Number(m.getHeight())};n={width:Number(k.readItLaterPopup.getWidth()),height:Number(k.readItLaterPopup.getHeight())};if(k.readItLaterPopup.getStyle("display")==="block"){k.readItLaterPopup.setStyle({display:"none"})}else{if(p){s=btn.top-parseInt(n.height/2)+parseInt(btn.height/2);o=btn.left+btn.width+u.width}else{s=btn.top+btn.height+parseInt(u.height/2);o=btn.left-parseInt(n.width/2)+parseInt(btn.width/2)}$(k.readItLaterPopup).select(".arrow").each(function(z,A){var B={top:0,left:0};if(p){B.left=(A-u.width);B.top=parseInt(n.height/2)-parseInt(u.height/2);if(A==1){B.left+=1;B.top+=1}}else{B.left=parseInt(n.width/2)-u.width+A;B.top=A-u.height}$(z).setStyle({left:B.left+"px",top:B.top+"px"})});k.readItLaterPopup.setStyle({display:"block",top:s+"px",left:o+"px"});BF_Effect.ScrollIntoView(k.readItLaterPopup)}})})}};Array.isArray||(Array.isArray=function(b){return"object"===typeof b&&"[object Array]"===Object.prototype.toString.call(b)});var CountView=function(){this._elems_arr=[];this._time_interval=250;this._callback=null;this._interval_id=null};CountView.prototype=(function(){function d(f){f=f||window;if(f.pageXOffset!=null){return{x:f.pageXOffset,y:f.pageYOffset}}var g=f.document;if(document.compatMode=="CSS1Compat"){return{x:g.documentElement.scrollLeft,y:g.documentElement.scrollTop}}return{x:g.body.scrollLeft,y:g.body.scrollTop}}function e(f){f=f||window;if(f.innerWidth!=null){return{w:f.innerWidth,h:f.innerHeight}}var g=f.document;if(document.compatMode=="CSS1Compat"){return{w:g.documentElement.clientWidth,h:g.documentElement.clientHeight}}return{w:g.body.clientWidth,h:g.body.clientWidth}}var b=function(k){var m=k.offsetTop;var l=k.offsetLeft;var j=k.offsetWidth;var h=k.offsetHeight;while(k.offsetParent){k=k.offsetParent;m+=k.offsetTop;l+=k.offsetLeft}var g=d();var f=e();return(m<(g.y+f.h)&&l<(g.x+f.w)&&(m+h)>g.y&&(l+j)>g.x)};var c=function(){for(var g=0,f=this._elems_arr.length;g<f;g++){var h=this._elems_arr[g];if(b.call(this,h.elem)){h.time+=this._time_interval;h.active=true}else{h.active=false}}if(this._callback){this._callback(this._elems_arr)}};return{set_elems_arr:function(g,j){if(!Array.isArray(g)){g=[g]}for(var h=0,f=g.length;h<f;h++){this._elems_arr.push({elem:$(g[h]),time:0,active:false})}},get_elems_stat:function(){return this._elems_arr},start_count:function(f,h){if(f){this._time_interval=f}if(h){this._callback=h}var g=c.bind(this);g();this._interval_id=setInterval(g,this._time_interval)},stop_count:function(){if(this._interval_id){clearInterval(this._interval_id);this._interval_id=null}}}}());var HeatMap=function(){var h,c,y,u,b={},n=250,f=1800000,p=500,g=new CountView(),l=BF_STATIC.bf_env=="dev"?"/":"/buzzfeed/",d=BF_STATIC.web_root+l+"item_stats",e=document.location.search.toQueryParams(),k=e.hasOwnProperty("heatmap_debug"),A=e.hasOwnProperty("heatmap_track"),m=e.hasOwnProperty("heatmap_display"),C=e.hasOwnProperty("selenium");var t=function(){h=BF_STATIC.campaignid;c=$$(".buzz_superlist_item");if(!acl.user_can("general_admin")){A=m=false}u=A?1:p;y=A?true:((Math.floor(Math.random()*u)+1)==u);if(y){if(BF_STATIC.bf_env!="live"){console.log("HEATMAP: Tracking stats for this visit.")}if(!C){Event.observe(window,"beforeunload",w)}g.set_elems_arr(c);g.start_count(n,j)}if(m){s()}};var j=function(H){if(k){for(var F=0,E=H.length;F<E;F++){var G=H[F]["elem"];var J=H[F]["time"];var I=H[F]["active"];if(I){var D=B(G);console.log("unit_number: "+D);var K="green"}else{var K="#C70000"}$(G).setStyle({backgroundColor:K})}}};var B=function(F){var D=null,E=$(F.id);if(E){D=E.readAttribute("rel:buzz_num")}return D};var o=function(E){var D=E.id;if(matches=D.match(/(\w+)_(\d+)_(\d+)/)){return matches[3]}return null};var z=function(M){var G=(!M||!M.hasOwnProperty("type"))?"current":M.type;if(G!=="historical"){var J=g.get_elems_stat();var L={};for(var H=0,I=J.length;H<I;H++){var F=J[H]["elem"];var E=J[H]["time"];var D=B(F);if(D!=null){E=(E>f)?f:E;var K=o(F);L[D]={sub_buzz_id:K,time:E}}}return L}else{new BF_Request().request(d,{method:"get",parameters:{action:"get_stat",buzz_id:h},onSuccess:M.onSuccess})}};var w=function(){if(y&&h){var E=z();var G=Object.toJSON(E);var D={action:"save_stat",buzz_id:h,item_stat:G};var F=new BF_Request();F.request(d,{method:"post",asynchronous:false,parameters:D,onSuccess:function(H){if(BF_STATIC.bf_env!="live"){console.log("HEATMAP: Successfully saved stats.",G)}},onFailure:function(H){if(BF_STATIC.bf_env!="live"){console.log("HEATMAP: Error saving stats.",H)}}})}};var s=function(){var D=$("buzz_sub_buzz"),E=D.className,H=E.match("suplist"),G=E.match("suplist_none"),F=function(K){var M=[],N=0,L=(e.heatmap_display==="time")?"heatmap-time":"heatmap-views",I=function(Q){if(Q<1000){return Q}else{if(Q<10000){return Q.toString().charAt(0)+","+Q.toString().substring(1)}else{if(Q>=1000000){return(Q/1000000).toFixed(Q%1000000!=0)+"M"}}}return(Q/1000).toFixed(Q%1000!=0)+"K"},P=function(U){var R=Math.floor(U/(60*60)),V=U%(60*60),T=Math.floor(V/60),Q=V%60,W=Math.ceil(Q),S=function(X){return(X<10)?"0"+X:X};return S(R)+":"+S(T)+":"+S(W)},O=function(T,U,Q){var V=(L==="heatmap-time")?U:Q,S=Math.round(parseInt(U)/10)/100,R='<ul class="sb-stats">                <li class="sb-views"><span>Views:</span> <span class="sb-val">'+I(Q)+'</span></li>                <li class="sb-time"><span>Time:</span> <span class="sb-val">'+P(S)+"</span></li></ul>";T.insert(R);N++;T.writeAttribute("rel:"+L,V);M.push(T)},J=function(){return $(this).readAttribute("rel:"+L)};c.each(function(T,S){var R,V=o(T),Q=[],U=K.findAll(function(X,W){if(X.sub_buzz_id!==V){return false}Q.push(W);return true});if(Q.length){Q.each(function(W){K.splice(W,1)});U.each(function(W){if(+W.position===(N+1)){O(T,W.total_time,W.total_views)}})}else{R=!G&&(T.select(".buzz_superlist_number_inline").length||T.select(".buzz_superlist_number").length);if(G||R){O(T,0,0)}}});D.addClassName(L);HeatColor(M,J,{lightness:0.5,colorStyle:"greentored"})};if(!h||!H){return}z({type:"historical",onSuccess:function(K){var I=K.responseText.evalJSON(),J=I.stats;if(!I.success){if(BF_STATIC.bf_env!="live"){console.log("HEATMAP: Error retrieving stats.")}return}if(Object.prototype.toString.apply(J)!=="[object Array]"||!J.length){if(BF_STATIC.bf_env!="live"){console.log("HEATMAP: No stats returned for this post.")}return}F(J)}})};return{init:function(){try{t()}catch(D){if(BF_STATIC.bf_env!="live"){console.error(D)}}},get_stat:function(){return z()},save_stat:function(){return w()}}}();if(typeof BF_STATIC!="undefined"&&typeof BF_STATIC.language!="undefined"&&typeof countryLangLookup!="undefined"){window.___gcfg={lang:countryLangLookup[BF_STATIC.language],}}if(!isIE8()){BF_UTIL.createScript({url:"https://apis.google.com/js/client:plusone.js?onload=GCallback"})}if(BF_STATIC.bf_test_mode&&BF_STATIC.bf_env=="dev"){(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.src="https://apis.google.com/js/client:plusone.js";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c)})()}function GCallback(){EventManager.fire("gplus:api-loaded")}var HeatColor=function(f,g,c){var d={elementFunction:function(){return $(this)},minval:0,maxval:0,lightness:0.75,colorStyle:"roygbiv",reverseOrder:false};if(c){Object.extend(d,c)}var e={findcolor:function(p,l,u){var m=(l===u)?1:(p-l)/(u-l);var j=d.colorStyle=="roygbiv"?0.5*m+1.7*(1-m):m+0.2+5.5*(1-m);var k=128;var o=2*Math.PI;var t=j+m*o;t=d.colorStyle!="roygbiv"?-t:t;var h=this.process(Math.floor((Math.cos(t)+1)*k));var n=this.process(Math.floor((Math.cos(t+Math.PI/2)+1)*k));var s=this.process(Math.floor((Math.cos(t+Math.PI)+1)*k));return"#"+h+n+s},process:function(h){var k=Math.floor(h+d.lightness*(256-h));var j=k.toString(16);j=j.length==1?"0"+j:j;return j},setMaxAndMin:function(h){var j=[];h.each(function(k){j.push(g.apply(k))});j=j.sort(function(l,k){return l-k});d.maxval=!d.reverseOrder?j[j.length-1]:j[0];d.minval=!d.reverseOrder?j[0]:j[j.length-1]}};if(!d.minval&&!d.maxval){e.setMaxAndMin(f)}else{if(d.reverseOrder){var b=d.minval;d.minval=d.maxval;d.maxval=b}}f.each(function(j){var l=g.apply(j);var k=e.findcolor(l,d.minval,d.maxval);var h=d.elementFunction.apply(j);if(h.nodeType==1){h.setStyle({backgroundColor:k})}else{if(h.nodeType==3){h.setStyle({color:k})}}});return(this)};BFContribute=function(){this.ERR='Sorry, there was a problem processing your request. If it persists please <a href="http://www.buzzfeed.com/about/contact">contact support</a>.';this.ERR_DUPE="Woops. It looks like you've already contributed this response.";this.TEXT_ERR="Please add your message.";this.IMAGE_ERR="Please add your image and a description.";this.IMAGE_TOO_LARGE="Max image upload size is 2 megabytes.";this.VIDEO_ERR="Please add a valid video link and a description.";this.QUOTE_ERR="Please add a quote and an author.";this.LINK_ERR="Please add a link and a description.";this.ERR_BLIST="An error has occurred. If it keeps happening contact error@buzzfeed.com.";this.type_list=new Array("text","video","image","link");this.buzz_data={};this.subContributeParent=0;this.main_buzz_id;this.init=function(){bf_login.init();var user_info=(new BF_User()).getUserInfo();if(user_info&&typeof user_info.p_disable_comment!="undefined"&&user_info.p_disable_comment=="true"){$$("#contribute-box").each(function(el){el.style.display="none"});return true}if(!$("contribute-form")){return}var submit_handler=function(event){event.stop();bf_contribute.submit()}.bind(this);if($("contribute-id")){bf_contribute.main_buzz_id=$("contribute-id").value}$("add-something-interesting").observe("click",function(event){event.stop();bf_contribute.reset_contribute_box()});$$(".respond").invoke("observe","click",bf_contribute.observeRespond);$("contribute-form").observe("submit",submit_handler);$("contribute-submit").show();$("contribute-post").observe("click",function(e){$("submit-mode").value="save"});$("contribute-submit").observe("click",function(e){$("submit-mode").value="preview"});var fwipeit=function(type){return function(event){event.stop();bf_contribute_toggleTabs("on");if($("respond")){$("respond").removeClassName("previewing")}$("contribute-message").update("");$("contribute-message").hide();$("contribute-preview").hide();$("contribute-form").reset();$("contribute-cancel").hide();$("image-button").value="Select Image...";$("contribute-post").hide();$("contribute-submit").value="Preview";$("contribute-preview-content").update()}};$("contribute-cancel").observe("click",fwipeit(true));$("contribute-close-success-box").observe("click",function(e){$("contribute-success").hide()});bf_contribute.goforit_default();var switch_function=function(e){e.stop();type=e.element().id.match(/(^\w+)/)[0];bf_contribute.disableCurrent();var button_id=type+"-contribute-activate";bf_contribute.buttonToggle(button_id);var form_id="contribute-"+type+"-form";bf_contribute.enableForm(form_id);if($("big-pink-arrow")){$("big-pink-arrow").style.display="none"}return false}.bind(this);for(i=0;i<bf_contribute.type_list.length;i++){var id=bf_contribute.type_list[i]+"-contribute-activate";var element=$(id);if(element){element.observe("click",function(e){e.stop();switch_function(e);return false})}}$("create_full_post_toggle").observe("click",function(e){e.stop();$$(".full-post-field").invoke("show");$("create_full_post_toggle").hide();$("create_simple_post_toggle").show()});$("create_simple_post_toggle").observe("click",function(e){e.stop();$$(".full-post-field").invoke("hide");$("create_full_post_toggle").show();$("create_simple_post_toggle").hide()});var vid_embed=$("video-embed");if(vid_embed){$("video-embed").observe("mouseup",function(){bf_contribute.setVideo()}.bindAsEventListener(this));$("video-embed").observe("keyup",function(){bf_contribute.setVideo()}.bindAsEventListener(this))}var image_button=$("image-button");var photo_editor_button=$("photo-editor-button");if(image_button&&Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==6){var image_handler=function(e){e.stop();$("image-preview-div").show();$("image-preview").hide();if($("user-loading")){$("user-loading").show()}$("user-image-edit-iframe").src="/static/images/public/spinners/big_on_eee.gif";$("user-image-edit").addClassName("bf_dialog_confirm");BF_UI.showDialog("user-image-edit");$("user-image-edit-iframe").src="/buzzfeed/_edit_user_contribution_image?action=imageform"}.bindAsEventListener(this);image_button.observe("click",image_handler);image_button.show();if(photo_editor_button){photo_editor_button.hide()}}if(photo_editor_button){var editor_handler=function(e){e.stop();if($("user-loading")){$("user-loading").show()}$("user-image-edit-iframe").src="/static/images/public/spinners/big_on_eee.gif";$("user-image-edit").removeClassName("bf_dialog_confirm");BF_UI.showDialog("user-image-edit","Edit a Photo");var over_query="";if($("photo_editor_image")){over_query="&overlay="+escape($F("photo_editor_image"))}$("user-image-edit-iframe").src="/buzzfeed/_edit_photo_editor_image?action=imageform"+over_query}.bindAsEventListener(this);photo_editor_button.observe("click",editor_handler)}if($("video-supported-text")){$("video-supported-text").update(BF_VIDEO_TYPES_STRING)}bf_contribute.update_contribs()};this.reset_contribute_box=function(){$("contribute-form").reset();bf_contribute_toggleTabs("on");$("contribute-cancel").hide();$("contribute-post").hide();$("contribute-submit").value="Preview";$("contribute-preview-content").update();$("contribute-parent-id").setValue(0);var add_interesting=$("add-something-interesting");add_interesting.parentNode.insertBefore($("contribute-box"),add_interesting.nextSibling);add_interesting.parentNode.insertBefore($("contribute-preview-content"),add_interesting.nextSibling);bf_contribute.subContributeParent=0};this.update_contribs=function(){var messages=$$(".contribution-list .what .blurb");messages.each(function(el){bf_contribute.create_list_link($(el))})};this.create_list_link=function(el){if(!el||!bf_contribute.buzz_data){return}if(!bf_contribute.fetched_buzz){bf_contribute.fetch_buzz_data()}var msg=$(el).innerHTML;var reg_p=new RegExp("(?!>)(#[0-9]+)(?!</a>)","g");var reg_m=new RegExp("[^0-9]+","g");var data=bf_contribute.buzz_data;var media_keys=[];while(msg.match(reg_p)){r=msg.match(reg_p);msg=msg.replaceAll(r[0],"");key=r[0].replace(reg_m,"");if(data.hasOwnProperty(key)){var link="";link='<a class="scroll" href="javascript:void(0);" onclick="BF_Effect.ScrollIntoView('+data[key].eid+')">';$(el).innerHTML=$(el).innerHTML.replaceAll(r[0],link+"#"+key+"</a>");if(data[key].btype.match("image|video")&&data[key].img&&media_keys.indexOf(key)<0&&!data[key].is_graphic){$(el).innerHTML=$(el).innerHTML+link+"<img src='"+data[key].img+"' class='list_img_thumb'></a>";media_keys.push(key)}else{if(data[key].btype.match("grid_row")&&data[key].img&&media_keys.indexOf(key)<0){var contrib_grid_html=link.replace('class="scroll"','class="scroll contrib_grid_row"');for(i=0;i<data[key].img.length;i++){contrib_grid_html=contrib_grid_html+"<img src='"+data[key].img[i]+"' class='list_grid_row_thumb'>";media_keys.push(key)}contrib_grid_html="<div>"+contrib_grid_html+"</div>";$(el).innerHTML=$(el).innerHTML+contrib_grid_html+"</div></a>"}}}}};this.fetch_buzz_data=function(){$$(".buzz_superlist_item").each(function(el){var down=$(el).down(".buzz_superlist_number, .buzz_superlist_number_inline");if(!down){return false}var key=down?down.innerHTML.replace(".",""):"";var content=$(el).down(".sub_buzz_content")?$(el).down(".sub_buzz_content"):"";var classname=$(el).className;var is_graphic=false;try{is_graphic=content.down(".graphic_image_wrapper")}catch(e){}bf_contribute.buzz_data[key]={eid:$(el).id,btype:classname.match("image")?"image":classname.match("video")?"video":classname.match("grid_row")?"grid_row":"na",is_graphic:is_graphic};if(bf_contribute.buzz_data[key].btype.match("image")){var img=$(content).down("img");bf_contribute.buzz_data[key].img=img.hasAttribute("rel:bf_image_src")&&!img.src.match(/_preview.gif/)?img.getAttribute("rel:bf_image_src"):img.src}else{if(bf_contribute.buzz_data[key].btype.match("video")){var embed_area=$(content).down(".video-embed-area");if(embed_area){bf_contribute.buzz_data[key].img=embed_area.getAttribute("rel:thumb")}}else{if(bf_contribute.buzz_data[key].btype.match("grid_row")){bf_contribute.buzz_data[key].img=[];$(el).select(".grid_cell img").each(function(img){bf_contribute.buzz_data[key].img.push(img.hasAttribute("rel:bf_image_src")&&!img.src.match(/_preview.gif/)?img.getAttribute("rel:bf_image_src"):img.src)})}}}});bf_contribute.fetched_buzz=1};this.getFormParams=function(type){var params={form:type,buzz_id:$F("contribute-id"),parent_id:$F("contribute-parent-id")};switch(type){case"text":var text=$F("text-text");if(!text){this.setErrMessage(this.TEXT_ERR);bf_contribute_toggleTabs("on");if($("contribute-post")){$("contribute-post").hide()}return false}Object.extend(params,{blurb:text});break;case"image":var text=$F("image-text").strip();var image=TT_Filters.html_noentities($F("image-image").strip());var isMixedPic=(bf_contribute.form=="mixedpic"||bf_contribute.form=="mixedpic_wide")?true:false;var credit=TT_Filters.html_noentities(TT_Filters.link($F("image-credit").strip()));if(credit&&!credit.match(/^https?:\/\//)){credit="http://"+credit}if(credit){credit=this.url_entities(credit)}if(!image||(!text&&!isMixedPic)){this.setErrMessage(this.IMAGE_ERR);if($("contribute-post")){$("contribute-post").hide()}if(image){$("image-preview-div").show()}bf_contribute_toggleTabs("on");return false}if($F("submit-mode")=="save"){$("image-preview").hide()}Object.extend(params,{blurb:text,url:image,credit_url:credit,height:this.image_height,width:this.image_width});break;case"video":var text=TT_Filters.html_noentities($F("video-text").strip());var link=TT_Filters.link($F("video-embed-url").strip());if(typeof link=="undefined"){link=""}if(typeof text=="undefined"){text=""}if(link&&!link.match(/^https?:\/\//)){link="http://"+link}if(!text||!link){this.setErrMessage(this.VIDEO_ERR);bf_contribute_toggleTabs("on");if($("contribute-post")){$("contribute-post").hide()}return false}Object.extend(params,{blurb:text,url:link});break;case"quote":var text=TT_Filters.html_noentities($F("quote-text").strip());var author=TT_Filters.html_noentities($F("quote-attribution").strip());if(!text||!author){this.setErrMessage(this.QUOTE_ERR);if($("contribute-add-your-response-heading")){$("contribute-add-your-response-heading").show()}bf_contribute_toggleTabs("on");if($("contribute-post")){$("contribute-post").hide()}return false}Object.extend(params,{blurb:text,author:author});break;case"link":var text=TT_Filters.html_noentities($F("link-text").strip());var link=TT_Filters.link($F("link-url").strip());if(!link.match(/^https?:\/\//)){link="http://"+link}link=this.url_entities(link);if(!text||!link){this.setErrMessage(this.LINK_ERR);bf_contribute_toggleTabs("on");if($("contribute-post")){$("contribute-post").hide()}return false}Object.extend(params,{blurb:text,url:link});break}return params};this.submit=function(registered,params){var user=new BF_User();if(!$("contribute-post")){return false}if(user.isLoggedIn()&&(this.type!="image"||$F("image-image"))){$("contribute-post").show()}$("contribute-message").hide();$("contribute-box").show();if(this.login_enable_form){this.login_enable_form=false;this.enableForm("contribute-"+this.type+"-form")}else{if($F("submit-mode")=="preview"){$("contribute-cancel").show();$("contribute-submit").value="Preview Again";if($("video-preview")){$("video_preview").hide()}}if(params){$("submit-mode").value="preview"}else{params=this.getFormParams(this.type)}if(params!==false){if($F("submit-mode")=="save"){this.postit(params,registered)}else{this.previewFromServer(params,registered)}}}};this.previewFromServer=function(params,registered){$("saving-status").show();var user=new BF_User();if(user.isLoggedIn()){var userInfo=user.getUserInfo();params.username=userInfo.username;params.display_name=userInfo.display_name?userInfo.display_name:userInfo.username;if(userInfo.image&&userInfo.image!=null&&userInfo.image!="null"){params.user_image=userInfo.image}else{params.user_image="/static/images/public/defaults/user_large.jpg"}}else{params.username="You";params.user_image="/static/images/public/defaults/user_large.jpg"}params.action="process";params.template="contribution";params.preview="true";params.since_minutes="1";params.static_root=BF_STATIC.static_root;params.image_root=BF_STATIC.image_root;if(bf_contribute.subContributeParent>0){params.child_comment="1"}var ajax=new BF_Request();ajax.request("/buzzfeed/_template",{method:"post",parameters:params,onSuccess:function(resp){$("contribute-post").disabled=false;var user=new BF_User();var json=resp.responseText;var obj=json.evalJSON();if(obj.success){var html=obj.snippet;if(!(user.isLoggedIn()||registered)){$("contribute-post").show()}this.preview_contribution(html,obj)}else{var errors="";for(var key in obj.errors){if(errors!=""){errors+=", "}errors+=obj.errors[key]}this.setErrMessage(errors);$("contribute-post").hide()}$("saving-status").hide();document.fire("contribute:previewFromServerOk")}.bind(this),onFailure:function(resp){ajax.alert("Error contacting server");$("saving-status").hide();document.fire("contribute:previewFromServerError")},bf_auth:true})};this.preview_contribution=function(preview,obj){var user=new BF_User();if($("big-pink-arrow")){$("big-pink-arrow").style.display="none"}if($("respond")){$("respond").addClassName("previewing")}if($("image-preview")){$("image-preview").hide()}$("contribute-preview-content").update(preview.toString());bf_contribute_toggleTabs("off");if($("who-preview")){console.warn("who-form is obsolete?")}if(user.isLoggedIn()){if(((new BF_User()).getUserInfo()).f_ad=="true"){$$("#contribute-preview-content .contrib")[0].addClassName("ad")}}if(this.type=="video"){var embedVal=$F("video-embed-url");if(embedVal){if(bf_contribute.subContributeParent>0){var so=BF_initSwfObject(embedVal,{width:575,height:375});so.write("video_buzz_element_"+obj.video_preview_uri)}else{var so=BF_initSwfObject(embedVal,{width:605,height:505});so.write("video_buzz_element_"+obj.video_preview_uri)}}}bf_contribute.create_list_link($$("#contribute-preview-content .what .blurb")[0])};this.postit=function(params,registered){var user=new BF_User();if(!user.isLoggedIn()&&!registered){$("submit-mode").value="save";bf_login.delayedLoggedInCallbacks=[];bf_login.delayedLoggedInCallbacks.push({obj:"bf_contribute",fn:"previewAndPostIt",params:[params]});signin.callbacks.onRegister.push(function(obj,json){this[this.type+"Contribution"](json)}.bind(this));signin.open({signin_type:"initial",mode:"contribution",location:"contribution"});if(Prototype.Browser.IE8){$$(".signin_overlay")[0].scrollIntoView()}return false}$("saving-status").show();this.params=params;var success_handler=function(resp){this._response(resp);document.fire("contribute:postitOk")}.bindAsEventListener(this);var error_handler=function(resp){this.server_error(resp);document.fire("contribute:postitError")}.bindAsEventListener(this);if(params.form=="mixedpic"&&(params.id==1860073||params.id==1927310||params.id==1984234)){this.use_minisuper(params)}else{(new BF_Targetting_Pixel()).add("comment");if(registered){params.session_key=registered.session_key}else{params.session_key=BFW_Util.getCookie(BFW_COOKIE)}params.delete_images="no";var args={method:"post",parameters:params,onSuccess:success_handler,onFailure:error_handler};var user_info=(new BF_User()).getUserInfo();if(user_info.username){args.needsToken=true}var ajax=new BF_Request();$("contribute-post").disabled=true;ajax.request("/buzzfeed/_commentribute",args);$("contribute-submit").value="Preview"}};this._response=function(resp){if($("contribwhat_")){$("contribwhat_").show()}$("saving-status").hide();this.goforit_default();var obj=eval("("+resp.responseText+")");if(obj.updated||(obj.success&&obj.success==1)){if(objExists(obj.last_active)){BFW_Util.updateInfoCookie({last_active:obj.last_active})}var react_cam_comment=(window.bf_react_cam&&objExists(bf_react_cam)&&objExists(obj.uri)&&obj.uri.match(/^reactcam-auto-title/)?true:false);if(this.params.form=="text"){this.params.form_string="responded "}if(this.params.form=="link"){this.params.form_string=" added a link "}if(this.params.form=="image"){this.params.form_string=" added an image "}if(this.params.form=="video"){this.params.form_string=" added a video "}this.params.parent_title=$F("parent_name");this.params.title_is_excerpt=$F("title_is_excerpt");this.params.parent_blurb=$F("parent_blurb");this.params.username=$F("current-username");this.params.buzz_uri=objExists(buzzDetails.uri)?buzzDetails.uri:null;this.params.buzz_username=objExists(BF_STATIC.username)?BF_STATIC.username:null;this.params.id=objExists(obj.id)?obj.id:null;contrib_uri="http://"+BFWebPath()+"/"+this.params.buzz_username+"/"+this.params.buzz_uri+"?comment="+obj.id;if(react_cam_comment&&obj.id){this.goforit_reactcam();contrib_uri="http://"+BFWebPath()+"/"+this.params.username+"/"+this.params.uri+"?comment="+obj.id}if(obj.thumb){this.params.image_src=obj.thumb}else{this.params.image_src=$("image-thumb").value}var share_pic=BFWebPath()+this.params.image_src;if(react_cam_comment){share_pic=BF_STATIC.image_root+obj.image.replace(/\.gif$/m,"_preview.gif")}social.contribute(this.params);if($("permalink-href")){$("permalink-href").setAttribute("href",contrib_uri);$("permalink-href").id+=Math.random()*100000}if($("tools-bar")){$("tools-bar").show();$("tools-bar").id+=Math.random()*100000}var html=$("contribute-preview-content").cloneNode(true);html.id+=Math.random()*100000;var element_id="highlight-"+Math.floor(Math.random()*100);var li=new Element("li",{id:element_id});li.appendChild(html);li.setOpacity(0);if(bf_contribute.subContributeParent!=0){var respond=li.getElementsByClassName("respond");if(respond[0]){respond[0].setAttribute("rel:parent_magic_id",this.params.parent_username+":"+this.params.parent_uri)+":"+html.id}$("contrib-form-container-"+bf_contribute.subContributeParent).insert({before:li})}else{var anchors=li.getElementsByTagName("A");for(var i=0;i<anchors.length;i++){if(!anchors[i].className.match("scroll")){anchors[i].setAttribute("href",contrib_uri)}}$("contribution-list").insert({top:li})}setTimeout(function(){fadeIn(element_id,0)},100);var user=new BF_User();if(user.isLoggedIn()&&!$("moderation_contribute")){removeAllCssClasses("contribute-success");$("contribute-success").addClassName(this.params.type);$("contribute-success-shares").childElements().each(function(el){$(el).remove()});var tw_desc="",fb_desc="",alt_desc=(objExists(obj.cleaned_text)?obj.cleaned_text:"");if(react_cam_comment){if(objExists(BF_STATIC.username)&&BF_STATIC.username=="starbucksfrappuccino"){hashtags="sipface"}tw_desc="I just left a reaction with the Frappuccino Reaction Cam."}else{if(objExists(obj.cleaned_text)){tw_desc=obj.cleaned_text}}fb_desc=tw_desc;if(objExists(fb_desc)&&fb_desc.indexOf("")){fb_desc=fb_desc.replace("","&#174;")}var label="";if(typeof this.params.react_wtih_gif!="undefined"){share_pic="http://"+BFWebPath()+this.params.thumb;label="rwg:"+rwg.cleanGifName(this.params.thumb)}bf_shares.fb_share({el:$("contribute-success-shares"),title:(objExists(BF_STATIC.buzz_name)?BF_STATIC.buzz_name:document.title),uri:contrib_uri,size:"big",picture:share_pic,description:(objExists(fb_desc)?fb_desc:alt_desc),onclick:("gtrack.track_events('[ttp]:contribution','share/facebook/comment','"+label+"');")});bf_shares.tw_tweet({el:$("contribute-success-shares"),title:(objExists(BF_STATIC.buzz_name)?BF_STATIC.buzz_name:document.title),uri:contrib_uri,size:"big",picture:share_pic,description:tw_desc,hashtags:(typeof hashtags!="undefined"?hashtags:""),onclick:("gtrack.track_events('[ttp]:contribution','share/twitter/comment','"+label+"');")});bf_shares.email_link({el:$("contribute-success-shares"),size:"big",subject:(objExists(BF_STATIC.buzz_name)?BF_STATIC.buzz_name:document.title),body:(objExists(fb_desc)?fb_desc:alt_desc)+"%0D%0A"+contrib_uri,onclick:("gtrack.track_events('[ttp]:contribution','share/email/comment','"+label+"');")});$(element_id).insert($("contribute-success"));$("contribute-success").show()}else{if(!$("moderation_contribute")){$("contribute-box").hide();if($("reg-success-message")){$("reg-success-message").update(bf_register.SUCCESS1)}$("registered-success").show()}}BF_Effect.ScrollIntoView(element_id);if($("number_of_contribs_header")){$("number_of_contribs_header").show()}$("contribute-post").hide();$("contribute-preview").hide();$("contribute-form").reset();bf_contribute.reset_contribute_box();$("contribute-preview-content").update();bf_contribute_toggleTabs("on");gtrack.trackShares(25,"numComments");gtrack.track_events(gtrack.tt_page+":contribute","contribute/submit","")}else{if(obj.error=="duplicate name"){this.setErrMessage(this.ERR_DUPE)}else{if(obj.error=="blacklist"){this.setErrMessage(this.ERR_BLIST)}else{this.setErrMessage(this.ERR)}}}};this.previewAndPostIt=function(params){var number_of_comment_pages=parseInt($F("comments-pages"));var waitfor=number_of_comment_pages?"ajax_comments:loaded":"ajax_comments:load";if(window[waitfor]){var fired=false;document.observe("contribute:previewFromServerOk",function(params){if(!fired){fired=true;this.postit.call(this,params)}}.bind(this,params));this.submit(null,params)}else{EventManager.observe(waitfor,this.previewAndPostIt.bind(this,params));$("responses").scrollIntoView()}};this.use_minisuper=function(params){var description="auto-title_"+(new Date()).getTime();var name="auto-title_"+(new Date()).getTime();if(params.caption){description=params.caption;name=truncateStr(params.caption,100)}var parameters={action:"save",name:name,description:description,image:params.url,width:params.width,height:params.height};parameters["submit-to"]=364333;parameters["auto-tag"]=params.id==1927310?"floridaoj2":params.id==1984234?"floridaoj3":"floridaoj";var success_handler=function(resp){this._response(resp)}.bindAsEventListener(this);var error_handler=function(resp){console.log(resp);this.server_error(resp)}.bindAsEventListener(this);new Ajax.Request("/buzzfeed/minisuper",{parameters:parameters,evalJSON:"force",onFailure:error_handler,onSuccess:success_handler})};this.setVideo=function(){var vd=new bf2_terminal_Video();vd.detect_type($F("video-embed"));$$("#contribute-video-form .video_privacy_warning").each(function(el){el.hide()});if(vd.type){var url=vd.src_link,so=BF_initSwfObject(url);so.write("video_preview");if($("video_preview")){$("video_preview").show()}$("video-embed-url").value=url;if(!!vd.possible_privacy_restrictions){$$("#contribute-video-form .video_privacy_warning").each(function(el){el.show()})}}else{if($("video_preview")){$("video_preview").update("")}if($("video_preview")){$("video_preview").hide()}$("video-embed-url").value=""}};this.save_image=function(image,width,height,form){$("user-image-edit").removeClassName("bf_wide_canvas");BF_UI.closeDialog("user-image-edit",{loadDefaultDiv:"quickpost-spinner"});$("image-image").value=image;bf_contribute.image_width=width;bf_contribute.image_height=height;if(form){bf_contribute.form=form}$("image-preview").show();$("image-preview").src=BF_STATIC.image_root+image;if(width>425){$("image-preview").setStyle({width:"425px",height:"auto"})}else{if(height){$("image-preview").setStyle({height:height+"px"})}}$("image-preview-div").show();$("photo-editor-button").value="Change Image..."};this.enableForm=function(id){if(!$(id)){return}$(id).show();this.currentForm=id;this.type=id.match(/\-(\w+)/)[1];this.login_enable_form=false};this.cleanup_image_registration=function(){if($("contribute-submit-fieldset")){$("contribute-submit-fieldset").show()}$("contribute-submit-fieldset").show();bf_contribute_toggleTabs("on");if($("image-preview-div")){$("image-preview-div").show()}if($("video_preview")&&$F("video-embed")){$("video_preview").show()}};this.buttonToggle=function(id){if(!$(id)){return}$(id).addClassName("current");this.currentToggle=id;if(id!="image-contribute-activate"){this.cleanup_image_registration()}};this.disableCurrent=function(){$(this.currentForm).hide();if(this.currentToggle!=undefined){$(this.currentToggle).removeClassName("current")}};this.setErrMessage=function(err){$("contribute-message").update(err);$("contribute-message").addClassName("error");$("contribute-message").show();$("contribute-submit").disabled=false};this.server_error=function(resp){$("saving-status").hide();this.setErrMessage(this.ERR)};this.addLineBreaks=function(string){string=string.replace(/(\r|\r\n|\n){2,}/gm,'<span class="line-break">&nbsp;</span>');string=string.replace(/(\r|\r\n|\n)/gm,"<br />");return string};this.url_entities=function(s){if(s){var newtext="";var chars=s.split("");for(i=0;i<chars.length;i++){var chr=chars[i].charCodeAt(0);if(chr>127){newtext+=encodeURIComponent(chars[i])}else{newtext+=chars[i]}}return newtext}};this.observeRespond=function(event){event.stop();bf_contribute.reset_contribute_box();var parent_comment_id=this.getAttribute("rel:parent_comment_id");if(!parent_comment_id){return}var buzz_id=this.getAttribute("rel:buzz_id");$("contribute-parent-id").setValue(parent_comment_id);$("contribute-id").setValue(buzz_id);$("contrib-form-container-"+parent_comment_id).appendChild($("contribute-preview-content"));$("contrib-form-container-"+parent_comment_id).appendChild($("contribute-box"));bf_contribute.subContributeParent=parent_comment_id;BF_Effect.ScrollIntoView("contribute-box")};this.goforit_default=function(){$("contribute-again-link").stopObserving("click");$("contribute-again-link").observe("click",function(e){e.stop();if($("contribution-types-tab")){$("contribution-types-tab").show()}if($("add-something-interesting")){$("add-something-interesting").show()}if($("respond")){$("respond").removeClassName("previewing")}$("contribute-preview").hide();$("contribute-submit-fieldset").show();bf_contribute_toggleTabs("on");$("contribute-form").reset();$("contribute-box").show();$("contribute-success").hide();$("contribute-cancel").hide();$("image-button").value="Select Image...";BF_Effect.ScrollIntoView("respond")})};this.goforit_reactcam=function(){$("contribute-again-link").stopObserving("click");$("contribute-again-link").observe("click",function(e){e.stop();$("contribute-success").hide();BF_Effect.ScrollIntoView("react_cam_button");document.fire("contribute:goforit_reactcam")})}};fadeIn=function(c,b){$(c).setOpacity(b/100);if(b<100){setTimeout("fadeIn('"+c+"',"+(b+2)+")",5)}};bf_contribute_toggleTabs=function(b){if(b=="on"){if($("contribution-types-tab")){$("contribution-types-tab").show()}if($("add-something-interesting")){$("add-something-interesting").show()}}else{if($("contribution-types-tab")){$("contribution-types-tab").hide()}}};var bf_contribute=new BFContribute();BuzzLoader.register(bf_contribute.init,1);var BF_LoadContributions=function(){this.number_of_comment_pages;this.paging_count=1;this.is_loaded=false;this.init=function(){EventManager.observe("ajax_comments:load",function(){bf_load_contributions.load_list()});universal_dom.assign_handler({bucket:"load_contributions",event:"click",handler:bf_load_contributions._load});if(BF_STATIC.tt_page=="Buzz"){Event.observe(window,"scroll",function(g){var c=document.body.clientHeight-document.documentElement.scrollTop;if(Math.abs(bf_load_contributions.pre_fb_position-c)>200){bf_load_contributions.pre_fb_position=null}var f=$("responses");if(f){var d=f.viewportOffset().top+100}if(d<document.viewport.getHeight()&&!bf_load_contributions.is_loaded){EventManager.fire("ajax_comments:load");bf_load_contributions.is_loaded=true}})}var b=document.location.href.match("comment=([^&]*)");if(b){bf_load_contributions.load_list();bf_load_contributions.is_loaded=true;$("contribution-list").scrollIntoView();EventManager.observe("ajax_comments:loaded",function(){comment_links.highlite(b[1]);$(b[1]).scrollIntoView();bf_load_contributions.pre_fb_position=document.body.clientHeight-document.documentElement.scrollTop;FB.Event.subscribe("xfbml.render",function(d){var c=document.body.clientHeight-document.documentElement.scrollTop;if(bf_load_contributions.pre_fb_position&&bf_load_contributions.pre_fb_position!=c){$(b[1]).scrollIntoView()}})})}};this._load=function(){if($("contribution-list").select("li")&&!bf_load_contributions.is_loaded){$("contribution-list").select("li").each(function(b){b.remove()})}$("load-contrib-button").addClassName("hidden");EventManager.fire("ajax_comments:load")};this.load_list=function(){var c=new BF_Request();var b;bf_load_contributions.number_of_comment_pages=$F("comments-pages");if(bf_load_contributions.paging_count==1){b=BF_STATIC.web_root+"/_comments/"+bf_contribute.main_buzz_id}else{if(bf_load_contributions.paging_count<=bf_load_contributions.number_of_comment_pages){b=BF_STATIC.web_root+"/_comments/"+bf_contribute.main_buzz_id+"/"+bf_load_contributions.paging_count}}if(bf_load_contributions.paging_count<=bf_load_contributions.number_of_comment_pages){bf_load_contributions.comments_request();c.request(b,{onSuccess:function(d){bf_load_contributions.set_comments(d.responseText);if(typeof bf_contribute!=undefined){bf_contribute.update_contribs(d.responseText)}bf_load_contributions.end_request();bf_load_contributions.paging_count++;$("load-contrib-button").removeClassName("hidden");EventManager.fire("ajax_comments:loaded")}})}};this.set_comments=function(d){$("contribution-list").insert(d);var b=(parseInt(bf_load_contributions.number_of_comment_pages)<=bf_load_contributions.paging_count);if(bf_load_contributions.number_of_comment_pages<=1||b){$("load-contributions").addClassName("hidden")}$$(".respond").invoke("observe","click",bf_contribute.observeRespond);var c=$$("a.report-button");c.each(function(e){var f=e.getAttribute("comment_id");if(f){e.observe("click",function(g){g.stop();report_manager.flag_comment(g);return false})}});$$(".vote-love_or_hate").each(function(e){e.observe("click",badge_vote_manager.vote)});$$(".share a").each(function(e){e.observe("click",comment_links.show_share_box)});$$(".comment-share .share-icon").each(function(e){e.observe("click",comment_links.comment_share)});bf_post_tools.init();bf_editor.init();$("contribution-list").select("img.bf_dom").each(function(e){if(typeof e!=undefined&&e.getAttribute("rel:bf_bucket")=="progload"){bf_prog_load.load_image(e,e.getAttribute("rel:bf_image_src"))}})};this.comments_request=function(){$("comments-spinner").removeClassName("hidden")};this.end_request=function(){$("comments-spinner").addClassName("hidden")}};var bf_load_contributions=new BF_LoadContributions();BuzzLoader.register(bf_load_contributions.init,1);var BF_Audio_Player=function(){this.generate_audio_player=function(c,d){if(!d&&!$("audio_buzz_element_"+c.id)){return}var b=document.createElement("audio");if(!!(b.canPlayType&&b.canPlayType("audio/mpeg;").replace(/no/,""))){b.update("Your browser does not support this audio player.");b.setAttribute("controls","controls");var f=document.createElement("source");f.setAttribute("src",c.url);b.appendChild(f);if(d){return b.outerHTML}$("audio_buzz_element_"+c.id).appendChild(b)}else{var e=new Template('<a href="javascript:;" onclick="BFAudioPlayer.show_iframe_audio(this, \'#{url}\');">Play audio</a>');if(Prototype.Browser.Gecko&&navigator.plugins){if($A(navigator.plugins).detect(function(g){return g.name.indexOf("QuickTime")!=-1})){e=new Template('<object type="audio/mpeg" width="300" height="35" data="#{url}"><param name="AutoStart" value="0"><object/>')}else{if($A(navigator.plugins).detect(function(g){return g.name.indexOf("Windows Media")!=-1})){e=new Template('<object type="application/x-mplayer2" width="300" height="35" data="#{url}"><param name=`"AutoStart" value="0"></object>')}else{if($A(navigator.plugins).detect(function(g){return g.name.indexOf("RealPlayer")!=-1||g.name.indexOf("VLC")!=-1})){e=new Template('<embed type="audio/x-pn-realaudio-plugin" src="#{url}" style="height:30px;width:300px" loop="false" autostart="false"/>')}}}}if(d){return e.evaluate(c)}$("audio_buzz_element_"+c.id).insert(e.evaluate(c))}};this.show_iframe_audio=function(c,b){$(c).insert({before:'<iframe height="30" width="300" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" src="'+b+'"></iframe>'});$(c).hide()}};var BFAudioPlayer=new BF_Audio_Player();var rwg=new (function(){this.num_shown_images=0;this.num_images=0;this.els={};this.post_params={};this.image_path=BF_STATIC.static_root+"/images/public/react_with_gif/";this.sponsored_gifs=[];this.gifs=["default/cute.gif","default/deal.gif","default/good.gif","default/nope.gif","default/omg.gif","default/yawn.gif","default/lol.gif","default/win.gif","default/fail.gif","default/cool.gif","default/trashy.gif","default/wow.gif","default/wtf.gif","default/wut.gif","default/yaaass.gif"];this.templates={slide:"      <a class='slide' rel:gt_act='ignore'>        {gif_loader}        {gif}        {sponsored_msg}      </a>",gif_loader:"<img class='gif-loader hidden' src='"+BF_STATIC.static_root+"/images/public/react_with_gif/gif-feed_loading.gif'>",gif:"<img class='react-gif bf_dom' onload='rwg.hide_gif_spinner(this)' src='{preview}' gif='{gif}' preview='{preview}' rel:bf_bucket_data=\"{'rwg-modal':{'action':'create','gif':'{gif}','sponsored':{sponsored}},'rwg-animate':{}}\">",modal_template:"    <div id='rwg-modal-wrapper'>      <i id='rwg_spinner' class='fa fa-spinner fa-spin fa-5x hidden'></i>      <img id='rwg-modal-gif' class='bf_dom' src='{gif}' onload=\"rwg.modal({'action':'open'})\">      <a id='rwg-modal-submit' class='button2 bf_dom' rel:gt_act='ignore' rel:bf_bucket_data=\"{'rwg-post':{'gif':'{gif}','sponsored':{sponsored}}}\">Post this GIF as a Reaction</a>      <a id='rwg-modal-close' class='bf_dom' rel:gt_act='ignore' rel:bf_bucket_data=\"{'rwg-modal':{'action':'close','gif':'{gif}'}}\">Cancel</a>    </div>"};this.init=function(h){rwg.els=h.els;universal_dom.assign_handler({bucket:"rwg-modal",event:"click",handler:rwg.modal});universal_dom.assign_handler({bucket:"rwg-animate",event:"mouseover",handler:rwg.animate_gif});universal_dom.assign_handler({bucket:"rwg-animate",event:"mouseout",handler:rwg.show_preview});universal_dom.assign_handler({bucket:"rwg-animate-all",event:"mouseover",handler:rwg.animate_all_gifs});universal_dom.assign_handler({bucket:"rwg-animate-all",event:"mouseout",handler:rwg.stop_all_animations});universal_dom.assign_handler({bucket:"rwg-post",event:"click",handler:rwg.post_gif_as_reaction});universal_dom.assign_handler({bucket:"gif-nav",event:"click",handler:rwgCarousel.start});universal_dom.assign_handler({bucket:"rwg-toggle",event:"click",handler:rwgCarousel.toggle});rwg.num_images=(rwg.gifs.length+rwg.sponsored_gifs.length);for(var e=0;e<rwg.num_images;e++){var g,d,c,f=false;if(rwg.sponsored_gifs.length>0&&((e+1)%5)==0){f=true;var b=rwg.randomNum(0,(rwg.sponsored_gifs.length-1));gif_src=rwg.image_path+rwg.sponsored_gifs[b];preview_src=gif_src.replace(".gif",".jpg");rwg.sponsored_gifs=rwg.sponsored_gifs.remove(rwg.sponsored_gifs[b])}else{if(rwg.gifs.length){gif_src=rwg.image_path+rwg.gifs.shift();preview_src=gif_src.replace(".gif",".jpg")}}if(gif_src&&preview_src){d=rwg.templates.gif.replaceAll("{preview}",preview_src).replaceAll("{gif}",gif_src).replaceAll("{id}",e).replaceAll("{sponsored}",f);c=rwg.templates.slide.replaceAll("{gif_loader}",rwg.templates.gif_loader).replaceAll("{gif}",d).replaceAll("{sponsored_msg}",(f?rwg.templates.sponsored_msg:""));rwg.els.image_wrapper.insert(c)}}universal_dom.update(rwg.els.image_wrapper);if($.jStorage.get("rwg-toggle")=="open"){rwgCarousel.toggle(1)}};this.modal=function(c){var b=typeof c.gif!="undefined"?c.gif:null;if(c.action=="create"){rwg.els.wrapper.style.overflow="visible";rwg.els.modal.innerHTML=rwg.templates.modal_template.replaceAll("{gif_loader}",rwg.templates.gif_loader).replaceAll("{gif}",b).replaceAll("{sponsored}",c.sponsored);universal_dom.update(rwg.els.modal)}else{if(c.action=="open"){rwg.els.modal.removeClassName("hidden");gtrack.track_events("[ttp]:react-with-gif","[nc]reaction-gif-modal-impression",rwg.cleanGifName(b))}else{if(c.action=="close"||c.action=="destroy"){rwg.els.wrapper.style.overflow="hidden";rwg.els.modal.addClassName("hidden");rwg.els.modal.innerHTML="";if(c.action=="close"){gtrack.track_events("[ttp]:react-with-gif","[nc]reaction-gif-modal-cancel",rwg.cleanGifName(b))}}}}};this.cleanGifName=function(c){try{return c.replaceAll(rwg.image_path,"")}catch(b){return c}};this.animate_gif=function(d){var b=$(d.element);var c=b.siblings(".gif-loader").first();rwg.stop_all_animations();b.src=b.readAttribute("gif");rwg.show_gif_spinner(b)};this.hide_gif_spinner=function(b){if($(b)){var c=$(b).siblings(".gif-loader").first();if(c){if((/\.(gif)$/i).test($(b).src)){$(b).setAttribute("loaded","true");window.setTimeout(function(){if(!c.hasClassName("hidden")){c.addClassName("hidden")}},350)}else{if(!c.hasClassName("hidden")){c.addClassName("hidden")}}}}};this.show_gif_spinner=function(b){if($(b)&&(/\.(gif)$/i).test($(b).src)&&$(b).getAttribute("loaded")!="true"){var c=$(b).siblings(".gif-loader").first();if(c){window.setTimeout(function(){if(c.hasClassName("hidden")){c.removeClassName("hidden")}window.setTimeout(function(){rwg.hide_gif_spinner(b)},1000)},100)}}};this.show_preview=function(c){var b=$(c.element);b.src=b.readAttribute("preview")};this.stop_all_animations=function(){$(rwg.els.image_wrapper).select(".slide img.react-gif").each(function(b){if(b.hasAttribute("preview")&&b.src!=b.readAttribute("preview")){b.src=b.readAttribute("preview")}})};this.animate_all_gifs=function(){$(rwg.els.image_wrapper).select(".slide img.react-gif").slice(rwg.num_shown_images,rwg.num_shown_images*2).each(function(b){if(b.hasAttribute("gif")&&b.src!=b.readAttribute("gif")){b.src=b.readAttribute("gif")}rwg.show_gif_spinner(b)});gtrack.track_events("[ttp]:react-with-gif","[nc]reaction-gif-button-hover","")};this.post_gif_as_reaction=function(g){var c=new BF_User();var e=g.gif;if(!c.isLoggedIn()){bf_login.loggedInCallbacks=[];bf_login.loggedInCallbacks.push(function(){signin.close();rwg.spinner(1);rwg.post_gif_as_reaction(g)});bf_login.args={no_reload:true,current_page:"signin_anywhere"};signin.open({signin_type:"initial",close_enabled:true});gtrack.track_events("[ttp]:react-with-gif","[nc]reaction-gif-login",rwg.cleanGifName(g.gif));return false}rwg.spinner(1);rwg.post_params={form:"react_image",buzz_id:BF_STATIC.campaignid,parent_id:0,blurb:g.sponsored?rwg.templates.sponsored_blurb:"",url:"/static"+g.gif.replace(BF_STATIC.static_root,""),thumb:"/static"+g.gif.replace(BF_STATIC.static_root,""),height:605,width:605,react_wtih_gif:true,delete_images:"no",};var d={method:"post",parameters:rwg.post_params,onSuccess:rwg.post_success,evalJSON:"force"};var b=c.getUserInfo();if(b.username){d.needsToken=true}bf_contribute.previewFromServer(Object.clone(rwg.post_params));if($("image-preview")){$("image-preview").src=rwg.post_params.thumb}var f=new BF_Request();f.request("/buzzfeed/_commentribute",d);gtrack.track_events("[ttp]:react-with-gif","[nc]reaction-gif-submit",rwg.cleanGifName(g.gif))};this.spinner=function(b){if($("rwg_spinner")){rwg.els.spinner=$("rwg_spinner")}else{return false}if(b){if(rwg.els.spinner.hasClassName("hidden")){rwg.els.spinner.removeClassName("hidden")}}else{if(!rwg.els.spinner.hasClassName("hidden")){rwg.els.spinner.addClassName("hidden")}}};this.post_success=function(b){rwg.spinner(0);rwg.modal({action:"destroy"});bf_contribute.params={};bf_contribute.params=rwg.post_params;bf_contribute._response(b);document.fire("contribute:postitOk")};this.randomNum=function(c,b){return Math.floor(Math.random()*(b-c+1)+c)}})();var rwgCarousel=new (function(){this.els={};this.num_shown_images=0;this.rotate_time=0;this.timer;this.direction;this.init=function(b){rwgCarousel.els={toggle:b.toggle,wrapper:b.wrapper,carousel:b.carousel,modal:b.modal,image_wrapper:b.image_wrapper};rwgCarousel.num_shown_images=b.num_shown_images;rwgCarousel.rotate_time=b.rotate_time;rwg.init({els:rwgCarousel.els,num_shown_images:rwgCarousel.num_shown_images,})};this.toggle=function(c){var b=rwgCarousel.els.wrapper.hasClassName("open")?"closed":"open";rwgCarousel.els.wrapper.className=b;rwgCarousel.els.toggle.className=b;$.jStorage.set("rwg-toggle",b)};this.start=function(b){rwgCarousel.direction=b.dir;rwgCarousel.els.carousel.className=("move-"+rwgCarousel.direction);rwgCarousel.timer=setTimeout(function(){window.clearTimeout(rwgCarousel.timer);rwgCarousel.stop()},rwgCarousel.rotate_time)};this.stop=function(){var b=$(rwgCarousel.els.image_wrapper).select(".slide");if(rwgCarousel.direction=="left"){b.slice(0,rwgCarousel.num_shown_images).each(function(c){rwgCarousel.els.image_wrapper.insert({bottom:$(c)})})}else{b.slice((b.length-rwgCarousel.num_shown_images),b.length).reverse().each(function(c){rwgCarousel.els.image_wrapper.insert({top:$(c)})})}rwgCarousel.els.carousel.className=""}})();BreakingTime=function(){this.updateBreakingTime=function(c){var g=c;c=c.replace(/-/g,"/");var h=new Date(c),j=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],b=["Jan.","Feb.","March","April","May","June","July","Aug.","Sept.","Oct.","Nov.","Dec."],f=h.getHours()>12?true:false,e=(h.getMinutes()<10?"0":"")+h.getMinutes();if(!isNaN(h.getTime())){g=(f?(h.getHours()-12):h.getHours())+":"+e+" "+(f?"p.m.":"a.m.")+" ET, "+b[h.getMonth()]+" "+h.getDate()}return g}};var breaking_time=new BreakingTime();var BF_LF_image_bleed=function(){var g=".buzz_superlist_item_image.image_lffw";var e=".sub_buzz_content";var d=400;var f=[];var b=function(h){f.each(function(k){if(k.original_width>h){k.subbuzz.removeClassName("image_lffw_bled");k.bleed_element.writeAttribute("style","")}else{var j=k.subbuzz.viewportOffset().left?k.subbuzz.viewportOffset().left:0;k.subbuzz.addClassName("image_lffw_bled");k.bleed_element.setStyle({marginLeft:-j+"px",width:h+"px"})}})};var c=BF_UTIL.debounce(b,d);this.init=function(){var h=$$(g);var j=document.viewport.getWidth();if(!h.length){return}else{h.each(function(k){f.push({subbuzz:k,bleed_element:k.select(e).first(),original_width:k.getWidth(),})});b(j);Event.observe(window,"resize",function(){var k=document.viewport.getWidth();c(k)})}}};var bf_lf_image_bleed=new BF_LF_image_bleed();bfjs.onPageLoad(bf_lf_image_bleed.init);